import{Ba as zn,Ca as Se,Da as xe,Ea as ts,Fa as me,Ga as _e,Ha as ge,Ia as x,Ja as P,Ka as ut,L as He,La as G,Ma as le,Na as jt,Oa as ze,P as Wt,Pa as Ht,Qa as ee,Ra as ns,Sa as A,Ta as D,U as Ve,Ua as is,V as $e,Ya as rs,Za as Vt,a as N,aa as Z,b as ae,c as _,ca as Zr,fb as $t,ka as ct,la as b,pa as es,va as Ut}from"./chunk-X6KOAFSY.js";var zt=class n{THEME_KEY="portfolio-theme";darkWallpaper="assets/img/Wallparpers/wallpaper-dark.jpg";lightWallpaper="assets/img/Wallparpers/wallpaper-light.jpg";currentTheme=Z(this.getInitialTheme());currentWallpaper=Z(this.getWallpaperForTheme(this.currentTheme()));constructor(){let e=this.currentTheme();this.applyTheme(e),Vt(()=>{let t=this.currentTheme();this.currentWallpaper.set(this.getWallpaperForTheme(t)),this.applyTheme(t)})}getInitialTheme(){let e=localStorage.getItem(this.THEME_KEY);return e==="light"||e==="dark"?e:"dark"}getWallpaperForTheme(e){return e==="dark"?this.darkWallpaper:this.lightWallpaper}toggleTheme(){let e=this.currentTheme()==="dark"?"light":"dark";this.currentTheme.set(e),localStorage.setItem(this.THEME_KEY,e)}applyTheme(e){let t=document.documentElement,i=document.body;e==="light"?(t.classList.add("lightTheme"),t.classList.remove("darkTheme")):(t.classList.remove("lightTheme"),t.classList.add("darkTheme"));let r=this.getWallpaperForTheme(e);i.style.backgroundImage=`url(${r})`,i.style.backgroundSize="cover",i.style.backgroundPosition="center",i.style.backgroundAttachment="fixed"}static \u0275fac=function(t){return new(t||n)};static \u0275prov=He({token:n,factory:n.\u0275fac,providedIn:"root"})};var qt=class n{LANGUAGE_KEY="portfolio-language";currentLanguage=Z(this.getInitialLanguage());translations={es:{changeTheme:"Cambiar tema",changeThemeToLight:"Cambiar a tema claro",changeThemeToDark:"Cambiar a tema oscuro",projects:"Proyectos",aboutMe:"M\xE1s sobre m\xED",hardAndSoftSkills:"Habilidades duras y blandas",active:"Activo",tooling:"Herramientas",softSkills:"Habilidades blandas",modalTitle:"M\xE1s sobre m\xED",training:"Formaci\xF3n",experience:"Experiencia",referred:"Referencias",activeState:"Activo",pending:"Pendiente",completed:"Finalizado"},en:{changeTheme:"Change theme",changeThemeToLight:"Change to light theme",changeThemeToDark:"Change to dark theme",projects:"Projects",aboutMe:"More about me",hardAndSoftSkills:"Hard and soft skills",active:"Active",tooling:"Tooling",softSkills:"Soft Skills",modalTitle:"More about me",training:"Training",experience:"Experience",referred:"Referred",activeState:"Active",pending:"Pending",completed:"Completed"}};constructor(){Vt(()=>{let e=this.currentLanguage();localStorage.setItem(this.LANGUAGE_KEY,e)})}getInitialLanguage(){let e=localStorage.getItem(this.LANGUAGE_KEY);return e==="es"||e==="en"?e:navigator.language.split("-")[0]==="es"?"es":"en"}toggleLanguage(){let e=this.currentLanguage()==="es"?"en":"es";this.currentLanguage.set(e)}getTranslations(){return this.translations[this.currentLanguage()]}getTranslation(e){return this.translations[this.currentLanguage()][e]}static \u0275fac=function(t){return new(t||n)};static \u0275prov=He({token:n,factory:n.\u0275fac,providedIn:"root"})};var ss=()=>{};var Gn={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var f=function(n,e){if(!n)throw Pe(e)},Pe=function(n){return new Error("Firebase Database ("+Gn.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};var ls=function(n){let e=[],t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},cl=function(n){let e=[],t=0,i=0;for(;t<n.length;){let r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){let s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){let s=n[t++],o=n[t++],a=n[t++],l=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{let s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Qt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){let s=n[r],o=r+1<n.length,a=o?n[r+1]:0,l=r+2<n.length,c=l?n[r+2]:0,h=s>>2,d=(s&3)<<4|a>>4,u=(a&15)<<2|c>>6,p=c&63;l||(p=64,o||(u=64)),i.push(t[h],t[d],t[u],t[p])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(ls(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):cl(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){let s=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;let c=r<n.length?t[n.charAt(r)]:64;++r;let d=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||a==null||c==null||d==null)throw new qn;let u=s<<2|a>>4;if(i.push(u),c!==64){let p=a<<4&240|c>>2;if(i.push(p),d!==64){let m=c<<6&192|d;i.push(m)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},qn=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},Yn=function(n){let e=ls(n);return Qt.encodeByteArray(e,!0)},ht=function(n){return Yn(n).replace(/\./g,"")},Yt=function(n){try{return Qt.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function cs(n){return us(void 0,n)}function us(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(let t in e)!e.hasOwnProperty(t)||!ul(t)||(n[t]=us(n[t],e[t]));return n}function ul(n){return n!=="__proto__"}function dl(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var hl=()=>dl().__FIREBASE_DEFAULTS__,fl=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},pl=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Yt(n[1]);return e&&JSON.parse(e)},ds=()=>{try{return ss()||hl()||fl()||pl()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},ml=n=>ds()?.emulatorHosts?.[n],hs=n=>{let e=ml(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Kn=()=>ds()?.config;var ke=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}};function Jt(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}function fs(n){return _(this,null,function*(){return(yield fetch(n,{credentials:"include"})).ok})}function ps(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=N({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[ht(JSON.stringify(t)),ht(JSON.stringify(o)),""].join(".")}var dt={};function _l(){let n={prod:[],emulator:[]};for(let e of Object.keys(dt))dt[e]?n.emulator.push(e):n.prod.push(e);return n}function gl(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var os=!1;function ms(n,e){if(typeof window>"u"||typeof document>"u"||!Jt(window.location.host)||dt[n]===e||dt[n]||os)return;dt[n]=e;function t(u){return`__firebase__banner__${u}`}let i="__firebase__banner",s=_l().prod.length>0;function o(){let u=document.getElementById(i);u&&u.remove()}function a(u){u.style.display="flex",u.style.background="#7faaf0",u.style.position="fixed",u.style.bottom="5px",u.style.left="5px",u.style.padding=".5em",u.style.borderRadius="5px",u.style.alignItems="center"}function l(u,p){u.setAttribute("width","24"),u.setAttribute("id",p),u.setAttribute("height","24"),u.setAttribute("viewBox","0 0 24 24"),u.setAttribute("fill","none"),u.style.marginLeft="-6px"}function c(){let u=document.createElement("span");return u.style.cursor="pointer",u.style.marginLeft="16px",u.style.fontSize="24px",u.innerHTML=" &times;",u.onclick=()=>{os=!0,o()},u}function h(u,p){u.setAttribute("id",p),u.innerText="Learn more",u.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",u.setAttribute("target","__blank"),u.style.paddingLeft="5px",u.style.textDecoration="underline"}function d(){let u=gl(i),p=t("text"),m=document.getElementById(p)||document.createElement("span"),I=t("learnmore"),O=document.getElementById(I)||document.createElement("a"),se=t("preprendIcon"),oe=document.getElementById(se)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(u.created){let Te=u.element;a(Te),h(O,I);let $n=c();l(oe,se),Te.append(oe,m,O,$n),document.body.appendChild(Te)}s?(m.innerText="Preview backend disconnected.",oe.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(oe.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,m.innerText="Preview backend running in this workspace."),m.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}function yl(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Qn(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(yl())}function _s(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function gs(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function te(){return Gn.NODE_CLIENT===!0||Gn.NODE_ADMIN===!0}function Xt(){try{return typeof indexedDB=="object"}catch{return!1}}function Zt(){return new Promise((n,e)=>{try{let t=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}function ys(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}var vl="FirebaseError",Y=class n extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=vl,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ce.prototype.create)}},ce=class{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){let i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?Cl(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Y(r,a,i)}};function Cl(n,e){return n.replace(bl,(t,i)=>{let r=e[i];return r!=null?String(r):`<${i}?>`})}var bl=/\{\$([^}]+)}/g;function Ge(n){return JSON.parse(n)}function R(n){return JSON.stringify(n)}var vs=function(n){let e={},t={},i={},r="";try{let s=n.split(".");e=Ge(Yt(s[0])||""),t=Ge(Yt(s[1])||""),r=s[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:r}};var Cs=function(n){let e=vs(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},bs=function(n){let e=vs(n).claims;return typeof e=="object"&&e.admin===!0};function ne(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Ae(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Jn(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ft(n,e,t){let i={};for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=e.call(t,n[r],r,n));return i}function ye(n,e){if(n===e)return!0;let t=Object.keys(n),i=Object.keys(e);for(let r of t){if(!i.includes(r))return!1;let s=n[r],o=e[r];if(as(s)&&as(o)){if(!ye(s,o))return!1}else if(s!==o)return!1}for(let r of i)if(!t.includes(r))return!1;return!0}function as(n){return n!==null&&typeof n=="object"}function ws(n){let e=[];for(let[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}var Kt=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);let i=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)i[d]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let d=0;d<16;d++)i[d]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let d=16;d<80;d++){let u=i[d-3]^i[d-8]^i[d-14]^i[d-16];i[d]=(u<<1|u>>>31)&4294967295}let r=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,h;for(let d=0;d<80;d++){d<40?d<20?(c=a^s&(o^a),h=1518500249):(c=s^o^a,h=1859775393):d<60?(c=s&o|a&(s|o),h=2400959708):(c=s^o^a,h=3395469782);let u=(r<<5|r>>>27)+c+l+h+i[d]&4294967295;l=a,a=o,o=(s<<30|s>>>2)&4294967295,s=r,r=u}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);let i=t-this.blockSize,r=0,s=this.buf_,o=this.inbuf_;for(;r<t;){if(o===0)for(;r<=i;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<t;)if(s[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}else for(;r<t;)if(s[o]=e[r],++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){let e=[],t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=t&255,t/=256;this.compress_(this.buf_);let i=0;for(let r=0;r<5;r++)for(let s=24;s>=0;s-=8)e[i]=this.chain_[r]>>s&255,++i;return e}};function Xn(n,e){return`${n} failed: ${e} argument `}var Es=function(n){let e=[],t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);if(r>=55296&&r<=56319){let s=r-55296;i++,f(i<n.length,"Surrogate pair missing trail surrogate.");let o=n.charCodeAt(i)-56320;r=65536+(s<<10)+o}r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):r<65536?(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},pt=function(n){let e=0;for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};var wl=1e3,El=2,Il=14400*1e3,Tl=.5;function Zn(n,e=wl,t=El){let i=e*Math.pow(t,n),r=Math.round(Tl*i*(Math.random()-.5)*2);return Math.min(Il,i+r)}function ue(n){return n&&n._delegate?n._delegate:n}var B=class{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Ne="[DEFAULT]";var en=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let i=new ke;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(xl(e))try{this.getOrInitializeService({instanceIdentifier:Ne})}catch{}for(let[t,i]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Ne){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return _(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Ne){return this.instances.has(e)}getOptions(e=Ne){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,t){let i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);let s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){let i=this.onInitCallbacks.get(t);if(i)for(let r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Sl(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ne){return this.component?this.component.multipleInstances?e:Ne:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Sl(n){return n===Ne?void 0:n}function xl(n){return n.instantiationMode==="EAGER"}var mt=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new en(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var kl=[],T=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(T||{}),Pl={debug:T.DEBUG,verbose:T.VERBOSE,info:T.INFO,warn:T.WARN,error:T.ERROR,silent:T.SILENT},Al=T.INFO,Nl={[T.DEBUG]:"log",[T.VERBOSE]:"log",[T.INFO]:"info",[T.WARN]:"warn",[T.ERROR]:"error"},Ol=(n,e,...t)=>{if(e<n.logLevel)return;let i=new Date().toISOString(),r=Nl[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},ve=class{constructor(e){this.name=e,this._logLevel=Al,this._logHandler=Ol,this._userLogHandler=null,kl.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in T))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Pl[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,T.DEBUG,...e),this._logHandler(this,T.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,T.VERBOSE,...e),this._logHandler(this,T.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,T.INFO,...e),this._logHandler(this,T.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,T.WARN,...e),this._logHandler(this,T.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,T.ERROR,...e),this._logHandler(this,T.ERROR,...e)}};var Rl=(n,e)=>e.some(t=>n instanceof t),Is,Ts;function Ml(){return Is||(Is=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Dl(){return Ts||(Ts=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Ss=new WeakMap,ti=new WeakMap,xs=new WeakMap,ei=new WeakMap,ii=new WeakMap;function Ll(n){let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(ie(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Ss.set(t,n)}).catch(()=>{}),ii.set(e,n),e}function Fl(n){if(ti.has(n))return;let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});ti.set(n,e)}var ni={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ti.get(n);if(e==="objectStoreNames")return n.objectStoreNames||xs.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ie(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function ks(n){ni=n(ni)}function Bl(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let i=n.call(tn(this),e,...t);return xs.set(i,e.sort?e.sort():[e]),ie(i)}:Dl().includes(n)?function(...e){return n.apply(tn(this),e),ie(Ss.get(this))}:function(...e){return ie(n.apply(tn(this),e))}}function Wl(n){return typeof n=="function"?Bl(n):(n instanceof IDBTransaction&&Fl(n),Rl(n,Ml())?new Proxy(n,ni):n)}function ie(n){if(n instanceof IDBRequest)return Ll(n);if(ei.has(n))return ei.get(n);let e=Wl(n);return e!==n&&(ei.set(n,e),ii.set(e,n)),e}var tn=n=>ii.get(n);function nn(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){let o=indexedDB.open(n,e),a=ie(o);return i&&o.addEventListener("upgradeneeded",l=>{i(ie(o.result),l.oldVersion,l.newVersion,ie(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}var Ul=["get","getKey","getAll","getAllKeys","count"],jl=["put","add","delete","clear"],ri=new Map;function Ps(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(ri.get(e))return ri.get(e);let t=e.replace(/FromIndex$/,""),i=e!==t,r=jl.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||Ul.includes(t)))return;let s=function(o,...a){return _(this,null,function*(){let l=this.transaction(o,r?"readwrite":"readonly"),c=l.store;return i&&(c=c.index(a.shift())),(yield Promise.all([c[t](...a),r&&l.done]))[0]})};return ri.set(e,s),s}ks(n=>ae(N({},n),{get:(e,t,i)=>Ps(e,t)||n.get(e,t,i),has:(e,t)=>!!Ps(e,t)||n.has(e,t)}));var oi=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Hl(t)){let i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}};function Hl(n){return n.getComponent()?.type==="VERSION"}var ai="@firebase/app",As="0.14.6";var de=new ve("@firebase/app"),Vl="@firebase/app-compat",$l="@firebase/analytics-compat",zl="@firebase/analytics",Gl="@firebase/app-check-compat",ql="@firebase/app-check",Yl="@firebase/auth",Kl="@firebase/auth-compat",Ql="@firebase/database",Jl="@firebase/data-connect",Xl="@firebase/database-compat",Zl="@firebase/functions",ec="@firebase/functions-compat",tc="@firebase/installations",nc="@firebase/installations-compat",ic="@firebase/messaging",rc="@firebase/messaging-compat",sc="@firebase/performance",oc="@firebase/performance-compat",ac="@firebase/remote-config",lc="@firebase/remote-config-compat",cc="@firebase/storage",uc="@firebase/storage-compat",dc="@firebase/firestore",hc="@firebase/ai",fc="@firebase/firestore-compat",pc="firebase",mc="12.6.0";var li="[DEFAULT]",_c={[ai]:"fire-core",[Vl]:"fire-core-compat",[zl]:"fire-analytics",[$l]:"fire-analytics-compat",[ql]:"fire-app-check",[Gl]:"fire-app-check-compat",[Yl]:"fire-auth",[Kl]:"fire-auth-compat",[Ql]:"fire-rtdb",[Jl]:"fire-data-connect",[Xl]:"fire-rtdb-compat",[Zl]:"fire-fn",[ec]:"fire-fn-compat",[tc]:"fire-iid",[nc]:"fire-iid-compat",[ic]:"fire-fcm",[rc]:"fire-fcm-compat",[sc]:"fire-perf",[oc]:"fire-perf-compat",[ac]:"fire-rc",[lc]:"fire-rc-compat",[cc]:"fire-gcs",[uc]:"fire-gcs-compat",[dc]:"fire-fst",[fc]:"fire-fst-compat",[hc]:"fire-vertex","fire-js":"fire-js",[pc]:"fire-js-all"};var rn=new Map,gc=new Map,ci=new Map;function Ns(n,e){try{n.container.addComponent(e)}catch(t){de.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function K(n){let e=n.name;if(ci.has(e))return de.debug(`There were multiple attempts to register component ${e}.`),!1;ci.set(e,n);for(let t of rn.values())Ns(t,n);for(let t of gc.values())Ns(t,n);return!0}function be(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ds(n){return n==null?!1:n.settings!==void 0}var yc={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ce=new ce("app","Firebase",yc);var ui=class{constructor(e,t,i){this._isDeleted=!1,this._options=N({},e),this._config=N({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new B("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ce.create("app-deleted",{appName:this._name})}};var Ls=mc;function fi(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let i=N({name:li,automaticDataCollectionEnabled:!0},e),r=i.name;if(typeof r!="string"||!r)throw Ce.create("bad-app-name",{appName:String(r)});if(t||(t=Kn()),!t)throw Ce.create("no-options");let s=rn.get(r);if(s){if(ye(t,s.options)&&ye(i,s.config))return s;throw Ce.create("duplicate-app",{appName:r})}let o=new mt(r);for(let l of ci.values())o.addComponent(l);let a=new ui(t,i,o);return rn.set(r,a),a}function gt(n=li){let e=rn.get(n);if(!e&&n===li&&Kn())return fi();if(!e)throw Ce.create("no-app",{appName:n});return e}function U(n,e,t){let i=_c[n]??n;t&&(i+=`-${t}`);let r=i.match(/\s|\//),s=e.match(/\s|\//);if(r||s){let o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),de.warn(o.join(" "));return}K(new B(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var vc="firebase-heartbeat-database",Cc=1,_t="firebase-heartbeat-store",si=null;function Fs(){return si||(si=nn(vc,Cc,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(_t)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ce.create("idb-open",{originalErrorMessage:n.message})})),si}function bc(n){return _(this,null,function*(){try{let t=(yield Fs()).transaction(_t),i=yield t.objectStore(_t).get(Bs(n));return yield t.done,i}catch(e){if(e instanceof Y)de.warn(e.message);else{let t=Ce.create("idb-get",{originalErrorMessage:e?.message});de.warn(t.message)}}})}function Os(n,e){return _(this,null,function*(){try{let i=(yield Fs()).transaction(_t,"readwrite");yield i.objectStore(_t).put(e,Bs(n)),yield i.done}catch(t){if(t instanceof Y)de.warn(t.message);else{let i=Ce.create("idb-set",{originalErrorMessage:t?.message});de.warn(i.message)}}})}function Bs(n){return`${n.name}!${n.options.appId}`}var wc=1024,Ec=30,di=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new hi(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}triggerHeartbeat(){return _(this,null,function*(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Rs();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>Ec){let r=Tc(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){de.warn(e)}})}getHeartbeatsHeader(){return _(this,null,function*(){try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=Rs(),{heartbeatsToSend:t,unsentEntries:i}=Ic(this._heartbeatsCache.heartbeats),r=ht(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return de.warn(e),""}})}};function Rs(){return new Date().toISOString().substring(0,10)}function Ic(n,e=wc){let t=[],i=n.slice();for(let r of n){let s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),Ms(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),Ms(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}var hi=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return _(this,null,function*(){return Xt()?Zt().then(()=>!0).catch(()=>!1):!1})}read(){return _(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield bc(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return _(this,null,function*(){if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Os(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return _(this,null,function*(){if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Os(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function Ms(n){return ht(JSON.stringify({version:2,heartbeats:n})).length}function Tc(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function Sc(n){K(new B("platform-logger",e=>new oi(e),"PRIVATE")),K(new B("heartbeat",e=>new di(e),"PRIVATE")),U(ai,As,n),U(ai,As,"esm2020"),U("fire-js","")}Sc("");var Ws="@firebase/database",Us="1.1.0";var yr="";function xc(n){yr=n}var bi=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),R(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Ge(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var wi=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return ne(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var Co=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new bi(e)}}catch{}return new wi},Re=Co("localStorage"),Ei=Co("sessionStorage");var Qe=new ve("@firebase/database"),kc=(function(){let n=1;return function(){return n++}})(),bo=function(n){let e=Es(n),t=new Kt;t.update(e);let i=t.digest();return Qt.encodeByteArray(i)},Rt=function(...n){let e="";for(let t=0;t<n.length;t++){let i=n[t];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=Rt.apply(null,i):typeof i=="object"?e+=R(i):e+=i,e+=" "}return e},Me=null,js=!0,Pc=function(n,e){f(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Qe.logLevel=T.VERBOSE,Me=Qe.log.bind(Qe),e&&Ei.set("logging_enabled",!0)):typeof n=="function"?Me=n:(Me=null,Ei.remove("logging_enabled"))},L=function(...n){if(js===!0&&(js=!1,Me===null&&Ei.get("logging_enabled")===!0&&Pc(!0)),Me){let e=Rt.apply(null,n);Me(e)}},Mt=function(n){return function(...e){L(n,...e)}},Ii=function(...n){let e="FIREBASE INTERNAL ERROR: "+Rt(...n);Qe.error(e)},he=function(...n){let e=`FIREBASE FATAL ERROR: ${Rt(...n)}`;throw Qe.error(e),new Error(e)},$=function(...n){let e="FIREBASE WARNING: "+Rt(...n);Qe.warn(e)},Ac=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&$("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},wo=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},Nc=function(n){if(te()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Ze="[MIN_NAME]",De="[MAX_NAME]",ot=function(n,e){if(n===e)return 0;if(n===Ze||e===De)return-1;if(e===Ze||n===De)return 1;{let t=Hs(n),i=Hs(e);return t!==null?i!==null?t-i===0?n.length-e.length:t-i:-1:i!==null?1:n<e?-1:1}},Oc=function(n,e){return n===e?0:n<e?-1:1},yt=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+R(e))},vr=function(n){if(typeof n!="object"||n===null)return R(n);let e=[];for(let i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)i!==0&&(t+=","),t+=R(e[i]),t+=":",t+=vr(n[e[i]]);return t+="}",t},Eo=function(n,e){let t=n.length;if(t<=e)return[n];let i=[];for(let r=0;r<t;r+=e)r+e>t?i.push(n.substring(r,t)):i.push(n.substring(r,r+e));return i};function H(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var Io=function(n){f(!wo(n),"Invalid JSON number");let e=11,t=52,i=(1<<e-1)-1,r,s,o,a,l;n===0?(s=0,o=0,r=1/n===-1/0?1:0):(r=n<0,n=Math.abs(n),n>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),i),s=a+i,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-i-t))));let c=[];for(l=t;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(r?1:0),c.reverse();let h=c.join(""),d="";for(l=0;l<64;l+=8){let u=parseInt(h.substr(l,8),2).toString(16);u.length===1&&(u="0"+u),d=d+u}return d.toLowerCase()},Rc=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Mc=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function Dc(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");let i=new Error(n+" at "+e._path.toString()+": "+t);return i.code=n.toUpperCase(),i}var Lc=new RegExp("^-?(0*)\\d{1,10}$"),Fc=-2147483648,Bc=2147483647,Hs=function(n){if(Lc.test(n)){let e=Number(n);if(e>=Fc&&e<=Bc)return e}return null},Dt=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw $("Exception was thrown by user callback.",t),e},Math.floor(0))}},Wc=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Et=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var Ti=class{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,Ds(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(i=>this.appCheck=i)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.appCheckProvider?.get().then(t=>t.addTokenListener(e))}notifyForInvalidToken(){$(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}};var Si=class{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(L("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',$(e)}},It=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),on="5",To="v",So="s",xo="r",ko="f",Po=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Ao="ls",No="p",xi="ac",Oo="websocket",Ro="long_polling";var an=class{constructor(e,t,i,r,s=!1,o="",a=!1,l=!1,c=null){this.secure=t,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this.emulatorOptions=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Re.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Re.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function Uc(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function Mo(n,e,t){f(typeof e=="string","typeof type must == string"),f(typeof t=="object","typeof params must == object");let i;if(e===Oo)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===Ro)i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Uc(n)&&(t.ns=n.namespace);let r=[];return H(t,(s,o)=>{r.push(s+"="+o)}),i+r.join("&")}var ki=class{constructor(){this.counters_={}}incrementCounter(e,t=1){ne(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return cs(this.counters_)}};var pi={},mi={};function Cr(n){let e=n.toString();return pi[e]||(pi[e]=new ki),pi[e]}function jc(n,e){let t=n.toString();return mi[t]||(mi[t]=e()),mi[t]}var Pi=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&Dt(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var Vs="start",Hc="close",Vc="pLPCommand",$c="pRTLPCB",Do="id",Lo="pw",Fo="ser",zc="cb",Gc="seg",qc="ts",Yc="d",Kc="dframe",Bo=1870,Wo=30,Qc=Bo-Wo,Jc=25e3,Xc=3e4,Ai=class n{constructor(e,t,i,r,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Mt(e),this.stats_=Cr(t),this.urlFn=l=>(this.appCheckToken&&(l[xi]=this.appCheckToken),Mo(t,Ro,l))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Pi(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Xc)),Nc(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Ni((...s)=>{let[o,a,l,c,h]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===Vs)this.id=a,this.password=l;else if(o===Hc)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let i={};i[Vs]="t",i[Fo]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[zc]=this.scriptTagHolder.uniqueCallbackIdentifier),i[To]=on,this.transportSessionId&&(i[So]=this.transportSessionId),this.lastSessionId&&(i[Ao]=this.lastSessionId),this.applicationId&&(i[No]=this.applicationId),this.appCheckToken&&(i[xi]=this.appCheckToken),typeof location<"u"&&location.hostname&&Po.test(location.hostname)&&(i[xo]=ko);let r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return te()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Rc()&&!Mc()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=R(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let i=Yn(t),r=Eo(i,Qc);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(te())return;this.myDisconnFrame=document.createElement("iframe");let i={};i[Kc]="t",i[Do]=e,i[Lo]=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=R(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},Ni=class n{constructor(e,t,i,r){if(this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,te())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=kc(),window[Vc+this.uniqueCallbackIdentifier]=e,window[$c+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){L("frame writing exception"),a.stack&&L(a.stack),L(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||L("No IE domain setting required")}catch{let i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[Do]=this.myID,e[Lo]=this.myPW,e[Fo]=this.currentSerial;let t=this.urlFn(e),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Wo+i.length<=Bo;){let o=this.pendingSegs.shift();i=i+"&"+Gc+r+"="+o.seg+"&"+qc+r+"="+o.ts+"&"+Yc+r+"="+o.d,r++}return t=t+i,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(i,Math.floor(Jc)),s=()=>{clearTimeout(r),i()};this.addTag(e,s)}addTag(e,t){te()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){let r=i.readyState;(!r||r==="loaded"||r==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{L("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}};var Zc=16384,eu=45e3,ln=null;typeof MozWebSocket<"u"?ln=MozWebSocket:typeof WebSocket<"u"&&(ln=WebSocket);var vt=(()=>{class n{constructor(t,i,r,s,o,a,l){this.connId=t,this.applicationId=r,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Mt(this.connId),this.stats_=Cr(i),this.connURL=n.connectionURL_(i,a,l,s,r),this.nodeAdmin=i.nodeAdmin}static connectionURL_(t,i,r,s,o){let a={};return a[To]=on,!te()&&typeof location<"u"&&location.hostname&&Po.test(location.hostname)&&(a[xo]=ko),i&&(a[So]=i),r&&(a[Ao]=r),s&&(a[xi]=s),o&&(a[No]=o),Mo(t,Oo,a)}open(t,i){this.onDisconnect=i,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Re.set("previous_websocket_failure",!0);try{let r;if(te()){let s=this.nodeAdmin?"AdminNode":"Node";r={headers:{"User-Agent":`Firebase/${on}/${yr}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(r.proxy={origin:a})}this.mySock=new ln(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");let s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");let s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let i=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(i);r&&r.length>1&&parseFloat(r[1])<4.4&&(t=!0)}return!t&&ln!==null&&!n.forceDisallow_}static previouslyFailed(){return Re.isInMemoryStorage||Re.get("previous_websocket_failure")===!0}markConnectionHealthy(){Re.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let i=this.frames.join("");this.frames=null;let r=Ge(i);this.onMessage(r)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(f(this.frames===null,"We already have a frame buffer"),t.length<=6){let i=Number(t);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let i=t.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(i);else{let r=this.extractFrameCount_(i);r!==null&&this.appendFrame_(r)}}send(t){this.resetKeepAlive();let i=R(t);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);let r=Eo(i,Zc);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(eu))}sendString_(t){try{this.mySock.send(t)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),tu=(()=>{class n{static get ALL_TRANSPORTS(){return[Ai,vt]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){let i=vt&&vt.isAvailable(),r=i&&!vt.previouslyFailed();if(t.webSocketOnly&&(i||$("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[vt];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),nu=6e4,iu=5e3,ru=10*1024,su=100*1024,_i="t",$s="d",ou="s",zs="r",au="e",Gs="o",qs="a",Ys="n",Ks="p",lu="h",Oi=class{constructor(e,t,i,r,s,o,a,l,c,h){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Mt("c:"+this.id+":"),this.transportManager_=new tu(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));let r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Et(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>su?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>ru?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(_i in e){let t=e[_i];t===qs?this.upgradeIfSecondaryHealthy_():t===zs?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===Gs&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=yt("t",e),i=yt("d",e);if(t==="c")this.onSecondaryControl_(i);else if(t==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Ks,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:qs,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Ys,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=yt("t",e),i=yt("d",e);t==="c"?this.onControl_(i):t==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=yt(_i,e);if($s in e){let i=e[$s];if(t===lu){let r=N({},i);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(t===Ys){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===ou?this.onConnectionShutdown_(i):t===zs?this.onReset_(i):t===au?Ii("Server Error: "+i):t===Gs?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Ii("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,i=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),on!==i&&$("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),Et(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(nu))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Et(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(iu))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Ks,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Re.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var cn=class{put(e,t,i,r){}merge(e,t,i,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}};var un=class{constructor(e){this.allowedEvents_=e,this.listeners_={},f(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let i=[...this.listeners_[e]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});let r=this.getInitialEvent(e);r&&t.apply(i,r)}off(e,t,i){this.validateEventType_(e);let r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===t&&(!i||i===r[s].context)){r.splice(s,1);return}}validateEventType_(e){f(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var dn=class n extends un{static getInstance(){return new n}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Qn()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return f(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var Qs=32,Js=768,E=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function w(){return new E("")}function v(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Ee(n){return n.pieces_.length-n.pieceNum_}function S(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new E(n.pieces_,e)}function Uo(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function cu(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function jo(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function Ho(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new E(e,0)}function M(n,e){let t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof E)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{let i=e.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&t.push(i[r])}return new E(t,0)}function C(n){return n.pieceNum_>=n.pieces_.length}function j(n,e){let t=v(n),i=v(e);if(t===null)return e;if(t===i)return j(S(n),S(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function br(n,e){if(Ee(n)!==Ee(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function J(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(Ee(n)>Ee(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}var Ri=class{constructor(e,t){this.errorPrefix_=t,this.parts_=jo(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=pt(this.parts_[i]);Vo(this)}};function uu(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=pt(e),Vo(n)}function du(n){let e=n.parts_.pop();n.byteLength_-=pt(e),n.parts_.length>0&&(n.byteLength_-=1)}function Vo(n){if(n.byteLength_>Js)throw new Error(n.errorPrefix_+"has a key path longer than "+Js+" bytes ("+n.byteLength_+").");if(n.parts_.length>Qs)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Qs+") or object contains a cycle "+Oe(n))}function Oe(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var Mi=class n extends un{static getInstance(){return new n}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}getInitialEvent(e){return f(e==="visible","Unknown event type: "+e),[this.visible_]}};var Ct=1e3,hu=300*1e3,Xs=30*1e3,fu=1.3,pu=3e4,mu="server_kill",Zs=3,wr=(()=>{class n extends cn{constructor(t,i,r,s,o,a,l,c){if(super(),this.repoInfo_=t,this.applicationId_=i,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=n.nextPersistentConnectionId_++,this.log_=Mt("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ct,this.maxReconnectDelay_=hu,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!te())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Mi.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&dn.getInstance().on("online",this.onOnline_,this)}sendRequest(t,i,r){let s=++this.requestNumber_,o={r:s,a:t,b:i};this.log_(R(o)),f(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),r&&(this.requestCBHash_[s]=r)}get(t){this.initConnection_();let i=new ke,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let l=a.d;a.s==="ok"?i.resolve(l):i.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),i.promise}listen(t,i,r,s){this.initConnection_();let o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),f(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),f(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let l={onComplete:s,hashFn:i,query:t,tag:r};this.listens.get(a).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(t){let i=this.outstandingGets_[t];this.sendRequest("g",i.request,r=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(r)})}sendListen_(t){let i=t.query,r=i._path.toString(),s=i._queryIdentifier;this.log_("Listen on "+r+" for "+s);let o={p:r},a="q";t.tag&&(o.q=i._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(a,o,l=>{let c=l.d,h=l.s;n.warnOnListenWarnings_(c,i),(this.listens.get(r)&&this.listens.get(r).get(s))===t&&(this.log_("listen response",l),h!=="ok"&&this.removeListen_(r,s),t.onComplete&&t.onComplete(h,c))})}static warnOnListenWarnings_(t,i){if(t&&typeof t=="object"&&ne(t,"w")){let r=Ae(t,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){let s='".indexOn": "'+i._queryParams.getIndex().toString()+'"',o=i._path.toString();$(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||bs(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Xs)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,i=Cs(t)?"auth":"gauth",r={cred:t};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(i,r,s=>{let o=s.s,a=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let i=t.s,r=t.d||"error";i==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,r)})}unlisten(t,i){let r=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),f(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,t._queryObject,i)}sendUnlisten_(t,i,r,s){this.log_("Unlisten on "+t+" for "+i);let o={p:t},a="n";s&&(o.q=r,o.t=s),this.sendRequest(a,o)}onDisconnectPut(t,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,i,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:i,onComplete:r})}onDisconnectMerge(t,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,i,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:i,onComplete:r})}onDisconnectCancel(t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(t,i,r,s){let o={p:i,d:r};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,i,r,s){this.putInternal("p",t,i,r,s)}merge(t,i,r,s){this.putInternal("m",t,i,r,s)}putInternal(t,i,r,s,o){this.initConnection_();let a={p:i,d:r};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++;let l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+i)}sendPut_(t){let i=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(i,r,o=>{this.log_(i+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let i={c:t};this.log_("reportStats",i),this.sendRequest("s",i,r=>{if(r.s!=="ok"){let o=r.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+R(t));let i=t.r,r=this.requestCBHash_[i];r&&(delete this.requestCBHash_[i],r(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,i){this.log_("handleServerMessage",t,i),t==="d"?this.onDataUpdate_(i.p,i.d,!1,i.t):t==="m"?this.onDataUpdate_(i.p,i.d,!0,i.t):t==="c"?this.onListenRevoked_(i.p,i.q):t==="ac"?this.onAuthRevoked_(i.s,i.d):t==="apc"?this.onAppCheckRevoked_(i.s,i.d):t==="sd"?this.onSecurityDebugPacket_(i):Ii("Unrecognized action received from server: "+R(t)+`
Are you using the latest client?`)}onReady_(t,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){f(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ct,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Ct,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>pu&&(this.reconnectDelay_=Ct),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_),i=Math.max(0,this.reconnectDelay_-t);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*fu)}this.onConnectStatus_(!1)}establishConnection_(){return _(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),i=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,a=!1,l=null,c=function(){l?l.close():(a=!0,r())},h=function(u){f(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(u)};this.realtime_={close:c,sendRequest:h};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[u,p]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?L("getToken() completed but was canceled"):(L("getToken() completed. Creating connection."),this.authToken_=u&&u.accessToken,this.appCheckToken_=p&&p.token,l=new Oi(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,i,r,m=>{$(m+" ("+this.repoInfo_.toString()+")"),this.interrupt(mu)},o))}catch(u){this.log_("Failed to get token: "+u),a||(this.repoInfo_.nodeAdmin&&$(u),c())}}})}interrupt(t){L("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){L("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Jn(this.interruptReasons_)&&(this.reconnectDelay_=Ct,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let i=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let i=this.outstandingPuts_[t];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,i){let r;i?r=i.map(o=>vr(o)).join("$"):r="default";let s=this.removeListen_(t,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,i){let r=new E(t).toString(),s;if(this.listens.has(r)){let o=this.listens.get(r);s=o.get(i),o.delete(i),o.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(t,i){L("Auth token revoked: "+t+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Zs&&(this.reconnectDelay_=Xs,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,i){L("App check token revoked: "+t+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Zs&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let i of t.values())this.sendListen_(i);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},i="js";te()&&(this.repoInfo_.nodeAdmin?i="admin_node":i="node"),t["sdk."+i+"."+yr.replace(/\./g,"-")]=1,Qn()?t["framework.cordova"]=1:gs()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=dn.getInstance().currentlyOnline();return Jn(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),y=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var et=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let i=new y(Ze,e),r=new y(Ze,t);return this.compare(i,r)!==0}minPost(){return y.MIN}};var sn,hn=class extends et{static get __EMPTY_NODE(){return sn}static set __EMPTY_NODE(e){sn=e}compare(e,t){return ot(e.name,t.name)}isDefinedOn(e){throw Pe("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return y.MIN}maxPost(){return new y(De,sn)}makePost(e,t){return f(typeof e=="string","KeyIndex indexValue must always be a string."),new y(e,sn)}toString(){return".key"}},Je=new hn;var Ye=class{constructor(e,t,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?i(e.key,t):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Q=(()=>{class n{constructor(t,i,r,s,o){this.key=t,this.value=i,this.color=r??n.RED,this.left=s??q.EMPTY_NODE,this.right=o??q.EMPTY_NODE}copy(t,i,r,s,o){return new n(t??this.key,i??this.value,r??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,i,r){let s=this,o=r(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,i,r),null):o===0?s=s.copy(null,i,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,i,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return q.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,i){let r,s;if(r=this,i(t,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(t,i),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),i(t,r.key)===0){if(r.right.isEmpty())return q.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(t,i))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,i)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),Di=class{copy(e,t,i,r,s){return this}insert(e,t,i){return new Q(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},q=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Q.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Q.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),t===0)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,r=null;for(;!i.isEmpty();)if(t=this.comparator_(e,i.key),t===0){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else t<0?i=i.left:t>0&&(r=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ye(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Ye(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Ye(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Ye(this.root_,null,this.comparator_,!0,e)}};q.EMPTY_NODE=new Di;function _u(n,e){return ot(n.name,e.name)}function Er(n,e){return ot(n,e)}var Li;function gu(n){Li=n}var $o=function(n){return typeof n=="number"?"number:"+Io(n):"string:"+n},zo=function(n){if(n.isLeafNode()){let e=n.val();f(typeof e=="string"||typeof e=="number"||typeof e=="object"&&ne(e,".sv"),"Priority must be a string or number.")}else f(n===Li||n.isEmpty(),"priority of unexpected type.");f(n===Li||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var eo,tt=(()=>{class n{static set __childrenNodeConstructor(t){eo=t}static get __childrenNodeConstructor(){return eo}constructor(t,i=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=i,this.lazyHash_=null,f(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),zo(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return C(t)?this:v(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,i){return null}updateImmediateChild(t,i){return t===".priority"?this.updatePriority(i):i.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,i).updatePriority(this.priorityNode_)}updateChild(t,i){let r=v(t);return r===null?i:i.isEmpty()&&r!==".priority"?this:(f(r!==".priority"||Ee(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(S(t),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,i){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+$o(this.priorityNode_.val())+":");let i=typeof this.value_;t+=i+":",i==="number"?t+=Io(this.value_):t+=this.value_,this.lazyHash_=bo(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(f(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let i=typeof t.value_,r=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(i),o=n.VALUE_TYPE_ORDER.indexOf(r);return f(s>=0,"Unknown leaf type: "+i),f(o>=0,"Unknown leaf type: "+r),s===o?r==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let i=t;return this.value_===i.value_&&this.priorityNode_.equals(i.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),Go,qo;function yu(n){Go=n}function vu(n){qo=n}var Fi=class extends et{compare(e,t){let i=e.node.getPriority(),r=t.node.getPriority(),s=i.compareTo(r);return s===0?ot(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return y.MIN}maxPost(){return new y(De,new tt("[PRIORITY-POST]",qo))}makePost(e,t){let i=Go(e);return new y(t,new tt("[PRIORITY-POST]",i))}toString(){return".priority"}},k=new Fi;var Cu=Math.log(2),Bi=class{constructor(e){let t=s=>parseInt(Math.log(s)/Cu,10),i=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let r=i(this.count);this.bits_=e+1&r}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},fn=function(n,e,t,i){n.sort(e);let r=function(l,c){let h=c-l,d,u;if(h===0)return null;if(h===1)return d=n[l],u=t?t(d):d,new Q(u,d.node,Q.BLACK,null,null);{let p=parseInt(h/2,10)+l,m=r(l,p),I=r(p+1,c);return d=n[p],u=t?t(d):d,new Q(u,d.node,Q.BLACK,m,I)}},s=function(l){let c=null,h=null,d=n.length,u=function(m,I){let O=d-m,se=d;d-=m;let oe=r(O+1,se),Te=n[O],$n=t?t(Te):Te;p(new Q($n,Te.node,I,null,oe))},p=function(m){c?(c.left=m,c=m):(h=m,c=m)};for(let m=0;m<l.count;++m){let I=l.nextBitIsOne(),O=Math.pow(2,l.count-(m+1));I?u(O,Q.BLACK):(u(O,Q.BLACK),u(O,Q.RED))}return h},o=new Bi(n.length),a=s(o);return new q(i||e,a)};var gi,qe={},nt=class n{static get Default(){return f(qe&&k,"ChildrenNode.ts has not been loaded"),gi=gi||new n({".priority":qe},{".priority":k}),gi}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){let t=Ae(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof q?t:null}hasIndex(e){return ne(this.indexSet_,e.toString())}addIndex(e,t){f(e!==Je,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let i=[],r=!1,s=t.getIterator(y.Wrap),o=s.getNext();for(;o;)r=r||e.isDefinedOn(o.node),i.push(o),o=s.getNext();let a;r?a=fn(i,e.getCompare()):a=qe;let l=e.toString(),c=N({},this.indexSet_);c[l]=e;let h=N({},this.indexes_);return h[l]=a,new n(h,c)}addToIndexes(e,t){let i=ft(this.indexes_,(r,s)=>{let o=Ae(this.indexSet_,s);if(f(o,"Missing index implementation for "+s),r===qe)if(o.isDefinedOn(e.node)){let a=[],l=t.getIterator(y.Wrap),c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),fn(a,o.getCompare())}else return qe;else{let a=t.get(e.name),l=r;return a&&(l=l.remove(new y(e.name,a))),l.insert(e,e.node)}});return new n(i,this.indexSet_)}removeFromIndexes(e,t){let i=ft(this.indexes_,r=>{if(r===qe)return r;{let s=t.get(e.name);return s?r.remove(new y(e.name,s)):r}});return new n(i,this.indexSet_)}};var bt,g=(()=>{class n{static get EMPTY_NODE(){return bt||(bt=new n(new q(Er),null,nt.Default))}constructor(t,i,r){this.children_=t,this.priorityNode_=i,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&zo(this.priorityNode_),this.children_.isEmpty()&&f(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||bt}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let i=this.children_.get(t);return i===null?bt:i}}getChild(t){let i=v(t);return i===null?this:this.getImmediateChild(i).getChild(S(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,i){if(f(i,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(i);{let r=new y(t,i),s,o;i.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(t,i),o=this.indexMap_.addToIndexes(r,this.children_));let a=s.isEmpty()?bt:this.priorityNode_;return new n(s,a,o)}}updateChild(t,i){let r=v(t);if(r===null)return i;{f(v(t)!==".priority"||Ee(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(r).updateChild(S(t),i);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let i={},r=0,s=0,o=!0;if(this.forEachChild(k,(a,l)=>{i[a]=l.val(t),r++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*r){let a=[];for(let l in i)a[l]=i[l];return a}else return t&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+$o(this.getPriority().val())+":"),this.forEachChild(k,(i,r)=>{let s=r.hash();s!==""&&(t+=":"+i+":"+s)}),this.lazyHash_=t===""?"":bo(t)}return this.lazyHash_}getPredecessorChildName(t,i,r){let s=this.resolveIndex_(r);if(s){let o=s.getPredecessorKey(new y(t,i));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let i=this.resolveIndex_(t);if(i){let r=i.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(t){let i=this.getFirstChildName(t);return i?new y(i,this.children_.get(i)):null}getLastChildName(t){let i=this.resolveIndex_(t);if(i){let r=i.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(t){let i=this.getLastChildName(t);return i?new y(i,this.children_.get(i)):null}forEachChild(t,i){let r=this.resolveIndex_(t);return r?r.inorderTraversal(s=>i(s.name,s.node)):this.children_.inorderTraversal(i)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,i){let r=this.resolveIndex_(i);if(r)return r.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,y.Wrap),o=s.peek();for(;o!=null&&i.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,i){let r=this.resolveIndex_(i);if(r)return r.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,y.Wrap),o=s.peek();for(;o!=null&&i.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Lt?-1:0}withIndex(t){if(t===Je||this.indexMap_.hasIndex(t))return this;{let i=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,i)}}isIndexed(t){return t===Je||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let i=t;if(this.getPriority().equals(i.getPriority()))if(this.children_.count()===i.children_.count()){let r=this.getIterator(k),s=i.getIterator(k),o=r.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=r.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===Je?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),Wi=class extends g{constructor(){super(new q(Er),g.EMPTY_NODE,nt.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return g.EMPTY_NODE}isEmpty(){return!1}},Lt=new Wi;Object.defineProperties(y,{MIN:{value:new y(Ze,g.EMPTY_NODE)},MAX:{value:new y(De,Lt)}});hn.__EMPTY_NODE=g.EMPTY_NODE;tt.__childrenNodeConstructor=g;gu(Lt);vu(Lt);var bu=!0;function F(n,e=null){if(n===null)return g.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),f(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new tt(t,F(e))}if(!(n instanceof Array)&&bu){let t=[],i=!1;if(H(n,(o,a)=>{if(o.substring(0,1)!=="."){let l=F(a);l.isEmpty()||(i=i||!l.getPriority().isEmpty(),t.push(new y(o,l)))}}),t.length===0)return g.EMPTY_NODE;let s=fn(t,_u,o=>o.name,Er);if(i){let o=fn(t,k.getCompare());return new g(s,F(e),new nt({".priority":o},{".priority":k}))}else return new g(s,F(e),nt.Default)}else{let t=g.EMPTY_NODE;return H(n,(i,r)=>{if(ne(n,i)&&i.substring(0,1)!=="."){let s=F(r);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(i,s))}}),t.updatePriority(F(e))}}yu(F);var Ui=class extends et{constructor(e){super(),this.indexPath_=e,f(!C(e)&&v(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let i=this.extractChild(e.node),r=this.extractChild(t.node),s=i.compareTo(r);return s===0?ot(e.name,t.name):s}makePost(e,t){let i=F(e),r=g.EMPTY_NODE.updateChild(this.indexPath_,i);return new y(t,r)}maxPost(){let e=g.EMPTY_NODE.updateChild(this.indexPath_,Lt);return new y(De,e)}toString(){return jo(this.indexPath_,0).join("/")}};var ji=class extends et{compare(e,t){let i=e.node.compareTo(t.node);return i===0?ot(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return y.MIN}maxPost(){return y.MAX}makePost(e,t){let i=F(e);return new y(t,i)}toString(){return".value"}},wu=new ji;function Yo(n){return{type:"value",snapshotNode:n}}function it(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function kt(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Pt(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function Eu(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var At=class{constructor(e){this.index_=e}updateChild(e,t,i,r,s,o){f(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(t);return a.getChild(r).equals(i.getChild(r))&&a.isEmpty()===i.isEmpty()||(o!=null&&(i.isEmpty()?e.hasChild(t)?o.trackChildChange(kt(t,a)):f(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(it(t,i)):o.trackChildChange(Pt(t,i,a))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return i!=null&&(e.isLeafNode()||e.forEachChild(k,(r,s)=>{t.hasChild(r)||i.trackChildChange(kt(r,s))}),t.isLeafNode()||t.forEachChild(k,(r,s)=>{if(e.hasChild(r)){let o=e.getImmediateChild(r);o.equals(s)||i.trackChildChange(Pt(r,s,o))}else i.trackChildChange(it(r,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?g.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var pn=class n{constructor(e){this.indexedFilter_=new At(e.getIndex()),this.index_=e.getIndex(),this.startPost_=n.getStartPost_(e),this.endPost_=n.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,r,s,o){return this.matches(new y(t,i))||(i=g.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,r,s,o)}updateFullNode(e,t,i){t.isLeafNode()&&(t=g.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(g.EMPTY_NODE);let s=this;return t.forEachChild(k,(o,a)=>{s.matches(new y(o,a))||(r=r.updateImmediateChild(o,g.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}};var Hi=class{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{let i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{let i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new pn(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,r,s,o){return this.rangedFilter_.matches(new y(t,i))||(i=g.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,r,s,o):this.fullLimitUpdateChild_(e,t,i,s,o)}updateFullNode(e,t,i){let r;if(t.isLeafNode()||t.isEmpty())r=g.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){r=g.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))r=r.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{r=t.withIndex(this.index_),r=r.updatePriority(g.EMPTY_NODE);let s;this.reverse_?s=r.getReverseIterator(this.index_):s=r.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:r=r.updateImmediateChild(a.name,g.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,r,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(u,p)=>d(p,u)}else o=this.index_.getCompare();let a=e;f(a.numChildren()===this.limit_,"");let l=new y(t,i),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),h=this.rangedFilter_.matches(l);if(a.hasChild(t)){let d=a.getImmediateChild(t),u=r.getChildAfterChild(this.index_,c,this.reverse_);for(;u!=null&&(u.name===t||a.hasChild(u.name));)u=r.getChildAfterChild(this.index_,u,this.reverse_);let p=u==null?1:o(u,l);if(h&&!i.isEmpty()&&p>=0)return s?.trackChildChange(Pt(t,i,d)),a.updateImmediateChild(t,i);{s?.trackChildChange(kt(t,d));let I=a.updateImmediateChild(t,g.EMPTY_NODE);return u!=null&&this.rangedFilter_.matches(u)?(s?.trackChildChange(it(u.name,u.node)),I.updateImmediateChild(u.name,u.node)):I}}else return i.isEmpty()?e:h&&o(c,l)>=0?(s!=null&&(s.trackChildChange(kt(c.name,c.node)),s.trackChildChange(it(t,i))),a.updateImmediateChild(t,i).updateImmediateChild(c.name,g.EMPTY_NODE)):e}};var Vi=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=k}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return f(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return f(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ze}hasEnd(){return this.endSet_}getIndexEndValue(){return f(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return f(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:De}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return f(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===k}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function Iu(n){return n.loadsAllData()?new At(n.getIndex()):n.hasLimit()?new Hi(n):new pn(n)}function to(n){let e={};if(n.isDefault())return e;let t;if(n.index_===k?t="$priority":n.index_===wu?t="$value":n.index_===Je?t="$key":(f(n.index_ instanceof Ui,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=R(t),n.startSet_){let i=n.startAfterSet_?"startAfter":"startAt";e[i]=R(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+R(n.indexStartName_))}if(n.endSet_){let i=n.endBeforeSet_?"endBefore":"endAt";e[i]=R(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+R(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function no(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==k&&(e.i=n.index_.toString()),e}var $i=class n extends cn{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(f(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,i,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=Mt("p:rest:"),this.listens_={}}listen(e,t,i,r){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,i),a={};this.listens_[o]=a;let l=to(e._queryParams);this.restRequest_(s+".json",l,(c,h)=>{let d=h;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(s,d,!1,i),Ae(this.listens_,o)===a){let u;c?c===401?u="permission_denied":u="rest_error:"+c:u="ok",r(u,null)}})}unlisten(e,t){let i=n.getListenId_(e,t);delete this.listens_[i]}get(e){let t=to(e._queryParams),i=e._path.toString(),r=new ke;return this.restRequest_(i+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(i,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(t.auth=r.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+ws(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=Ge(a.responseText)}catch{$("Failed to parse JSON response for "+o+": "+a.responseText)}i(null,l)}else a.status!==401&&a.status!==404&&$("Got unsuccessful REST response for "+o+" Status: "+a.status),i(a.status);i=null}},a.open("GET",o,!0),a.send()})}};var zi=class{constructor(){this.rootNode_=g.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function mn(){return{value:null,children:new Map}}function Ko(n,e,t){if(C(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let i=v(e);n.children.has(i)||n.children.set(i,mn());let r=n.children.get(i);e=S(e),Ko(r,e,t)}}function Gi(n,e,t){n.value!==null?t(e,n.value):Tu(n,(i,r)=>{let s=new E(e.toString()+"/"+i);Gi(r,s,t)})}function Tu(n,e){n.children.forEach((t,i)=>{e(i,t)})}var qi=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=N({},e);return this.last_&&H(this.last_,(i,r)=>{t[i]=t[i]-r}),this.last_=e,t}};var io=10*1e3,Su=30*1e3,xu=300*1e3,Yi=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new qi(e);let i=io+(Su-io)*Math.random();Et(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){let e=this.statsListener_.get(),t={},i=!1;H(e,(r,s)=>{s>0&&ne(this.statsToReport_,r)&&(t[r]=s,i=!0)}),i&&this.server_.reportStats(t),Et(this.reportStats_.bind(this),Math.floor(Math.random()*2*xu))}};var re=(function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n})(re||{});function Qo(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Ir(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Tr(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var Ki=class n{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=re.ACK_USER_WRITE,this.source=Qo()}operationForChild(e){if(C(this.path)){if(this.affectedTree.value!=null)return f(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new E(e));return new n(w(),t,this.revert)}}else return f(v(this.path)===e,"operationForChild called for unrelated child."),new n(S(this.path),this.affectedTree,this.revert)}};var _n=class n{constructor(e,t){this.source=e,this.path=t,this.type=re.LISTEN_COMPLETE}operationForChild(e){return C(this.path)?new n(this.source,w()):new n(this.source,S(this.path))}};var rt=class n{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=re.OVERWRITE}operationForChild(e){return C(this.path)?new n(this.source,w(),this.snap.getImmediateChild(e)):new n(this.source,S(this.path),this.snap)}};var gn=class n{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=re.MERGE}operationForChild(e){if(C(this.path)){let t=this.children.subtree(new E(e));return t.isEmpty()?null:t.value?new rt(this.source,w(),t.value):new n(this.source,w(),t)}else return f(v(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,S(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var fe=class{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(C(e))return this.isFullyInitialized()&&!this.filtered_;let t=v(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var Qi=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function ku(n,e,t,i){let r=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(Eu(o.childName,o.snapshotNode))}),wt(n,r,"child_removed",e,i,t),wt(n,r,"child_added",e,i,t),wt(n,r,"child_moved",s,i,t),wt(n,r,"child_changed",e,i,t),wt(n,r,"value",e,i,t),r}function wt(n,e,t,i,r,s){let o=i.filter(a=>a.type===t);o.sort((a,l)=>Au(n,a,l)),o.forEach(a=>{let l=Pu(n,a,s);r.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,n.query_))})})}function Pu(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function Au(n,e,t){if(e.childName==null||t.childName==null)throw Pe("Should only compare child_ events.");let i=new y(e.childName,e.snapshotNode),r=new y(t.childName,t.snapshotNode);return n.index_.compare(i,r)}function Pn(n,e){return{eventCache:n,serverCache:e}}function Tt(n,e,t,i){return Pn(new fe(e,t,i),n.serverCache)}function Jo(n,e,t,i){return Pn(n.eventCache,new fe(e,t,i))}function Ji(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Le(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var yi,Nu=()=>(yi||(yi=new q(Oc)),yi),V=class n{static fromObject(e){let t=new n(null);return H(e,(i,r)=>{t=t.set(new E(i),r)}),t}constructor(e,t=Nu()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:w(),value:this.value};if(C(e))return null;{let i=v(e),r=this.children.get(i);if(r!==null){let s=r.findRootMostMatchingPathAndValue(S(e),t);return s!=null?{path:M(new E(i),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(C(e))return this;{let t=v(e),i=this.children.get(t);return i!==null?i.subtree(S(e)):new n(null)}}set(e,t){if(C(e))return new n(t,this.children);{let i=v(e),s=(this.children.get(i)||new n(null)).set(S(e),t),o=this.children.insert(i,s);return new n(this.value,o)}}remove(e){if(C(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=v(e),i=this.children.get(t);if(i){let r=i.remove(S(e)),s;return r.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,r),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(C(e))return this.value;{let t=v(e),i=this.children.get(t);return i?i.get(S(e)):null}}setTree(e,t){if(C(e))return t;{let i=v(e),s=(this.children.get(i)||new n(null)).setTree(S(e),t),o;return s.isEmpty()?o=this.children.remove(i):o=this.children.insert(i,s),new n(this.value,o)}}fold(e){return this.fold_(w(),e)}fold_(e,t){let i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_(M(e,r),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,w(),t)}findOnPath_(e,t,i){let r=this.value?i(t,this.value):!1;if(r)return r;if(C(e))return null;{let s=v(e),o=this.children.get(s);return o?o.findOnPath_(S(e),M(t,s),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,w(),t)}foreachOnPath_(e,t,i){if(C(e))return this;{this.value&&i(t,this.value);let r=v(e),s=this.children.get(r);return s?s.foreachOnPath_(S(e),M(t,r),i):new n(null)}}foreach(e){this.foreach_(w(),e)}foreach_(e,t){this.children.inorderTraversal((i,r)=>{r.foreach_(M(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}};var X=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new V(null))}};function St(n,e,t){if(C(e))return new X(new V(t));{let i=n.writeTree_.findRootMostValueAndPath(e);if(i!=null){let r=i.path,s=i.value,o=j(r,e);return s=s.updateChild(o,t),new X(n.writeTree_.set(r,s))}else{let r=new V(t),s=n.writeTree_.setTree(e,r);return new X(s)}}}function ro(n,e,t){let i=n;return H(t,(r,s)=>{i=St(i,M(e,r),s)}),i}function so(n,e){if(C(e))return X.empty();{let t=n.writeTree_.setTree(e,new V(null));return new X(t)}}function Xi(n,e){return Fe(n,e)!=null}function Fe(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(j(t.path,e)):null}function oo(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(k,(i,r)=>{e.push(new y(i,r))}):n.writeTree_.children.inorderTraversal((i,r)=>{r.value!=null&&e.push(new y(i,r.value))}),e}function we(n,e){if(C(e))return n;{let t=Fe(n,e);return t!=null?new X(new V(t)):new X(n.writeTree_.subtree(e))}}function Zi(n){return n.writeTree_.isEmpty()}function st(n,e){return Xo(w(),n.writeTree_,e)}function Xo(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((r,s)=>{r===".priority"?(f(s.value!==null,"Priority writes must always be leaf nodes"),i=s.value):t=Xo(M(n,r),s,t)}),!t.getChild(n).isEmpty()&&i!==null&&(t=t.updateChild(M(n,".priority"),i)),t}}function Sr(n,e){return na(e,n)}function Ou(n,e,t,i,r){f(i>n.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:r}),r&&(n.visibleWrites=St(n.visibleWrites,e,t)),n.lastWriteId=i}function Ru(n,e){for(let t=0;t<n.allWrites.length;t++){let i=n.allWrites[t];if(i.writeId===e)return i}return null}function Mu(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);f(t>=0,"removeWrite called with nonexistent writeId.");let i=n.allWrites[t];n.allWrites.splice(t,1);let r=i.visible,s=!1,o=n.allWrites.length-1;for(;r&&o>=0;){let a=n.allWrites[o];a.visible&&(o>=t&&Du(a,i.path)?r=!1:J(i.path,a.path)&&(s=!0)),o--}if(r){if(s)return Lu(n),!0;if(i.snap)n.visibleWrites=so(n.visibleWrites,i.path);else{let a=i.children;H(a,l=>{n.visibleWrites=so(n.visibleWrites,M(i.path,l))})}return!0}else return!1}function Du(n,e){if(n.snap)return J(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&J(M(n.path,t),e))return!0;return!1}function Lu(n){n.visibleWrites=Zo(n.allWrites,Fu,w()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function Fu(n){return n.visible}function Zo(n,e,t){let i=X.empty();for(let r=0;r<n.length;++r){let s=n[r];if(e(s)){let o=s.path,a;if(s.snap)J(t,o)?(a=j(t,o),i=St(i,a,s.snap)):J(o,t)&&(a=j(o,t),i=St(i,w(),s.snap.getChild(a)));else if(s.children){if(J(t,o))a=j(t,o),i=ro(i,a,s.children);else if(J(o,t))if(a=j(o,t),C(a))i=ro(i,w(),s.children);else{let l=Ae(s.children,v(a));if(l){let c=l.getChild(S(a));i=St(i,w(),c)}}}else throw Pe("WriteRecord should have .snap or .children")}}return i}function ea(n,e,t,i,r){if(!i&&!r){let s=Fe(n.visibleWrites,e);if(s!=null)return s;{let o=we(n.visibleWrites,e);if(Zi(o))return t;if(t==null&&!Xi(o,w()))return null;{let a=t||g.EMPTY_NODE;return st(o,a)}}}else{let s=we(n.visibleWrites,e);if(!r&&Zi(s))return t;if(!r&&t==null&&!Xi(s,w()))return null;{let o=function(c){return(c.visible||r)&&(!i||!~i.indexOf(c.writeId))&&(J(c.path,e)||J(e,c.path))},a=Zo(n.allWrites,o,e),l=t||g.EMPTY_NODE;return st(a,l)}}}function Bu(n,e,t){let i=g.EMPTY_NODE,r=Fe(n.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(k,(s,o)=>{i=i.updateImmediateChild(s,o)}),i;if(t){let s=we(n.visibleWrites,e);return t.forEachChild(k,(o,a)=>{let l=st(we(s,new E(o)),a);i=i.updateImmediateChild(o,l)}),oo(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}else{let s=we(n.visibleWrites,e);return oo(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}}function Wu(n,e,t,i,r){f(i||r,"Either existingEventSnap or existingServerSnap must exist");let s=M(e,t);if(Xi(n.visibleWrites,s))return null;{let o=we(n.visibleWrites,s);return Zi(o)?r.getChild(t):st(o,r.getChild(t))}}function Uu(n,e,t,i){let r=M(e,t),s=Fe(n.visibleWrites,r);if(s!=null)return s;if(i.isCompleteForChild(t)){let o=we(n.visibleWrites,r);return st(o,i.getNode().getImmediateChild(t))}else return null}function ju(n,e){return Fe(n.visibleWrites,e)}function Hu(n,e,t,i,r,s,o){let a,l=we(n.visibleWrites,e),c=Fe(l,w());if(c!=null)a=c;else if(t!=null)a=st(l,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let h=[],d=o.getCompare(),u=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o),p=u.getNext();for(;p&&h.length<r;)d(p,i)!==0&&h.push(p),p=u.getNext();return h}else return[]}function Vu(){return{visibleWrites:X.empty(),allWrites:[],lastWriteId:-1}}function yn(n,e,t,i){return ea(n.writeTree,n.treePath,e,t,i)}function xr(n,e){return Bu(n.writeTree,n.treePath,e)}function ao(n,e,t,i){return Wu(n.writeTree,n.treePath,e,t,i)}function vn(n,e){return ju(n.writeTree,M(n.treePath,e))}function $u(n,e,t,i,r,s){return Hu(n.writeTree,n.treePath,e,t,i,r,s)}function kr(n,e,t){return Uu(n.writeTree,n.treePath,e,t)}function ta(n,e){return na(M(n.treePath,e),n.writeTree)}function na(n,e){return{treePath:n,writeTree:e}}var er=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,i=e.childName;f(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),f(i!==".priority","Only non-priority child changes can be tracked.");let r=this.changeMap.get(i);if(r){let s=r.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(i,Pt(i,e.snapshotNode,r.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(i);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(i,kt(i,r.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(i,it(i,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(i,Pt(i,e.snapshotNode,r.oldSnap));else throw Pe("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}};var tr=class{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}},ia=new tr,Nt=class{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let i=this.optCompleteServerCache_!=null?new fe(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return kr(this.writes_,e,i)}}getChildAfterChild(e,t,i){let r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Le(this.viewCache_),s=$u(this.writes_,r,t,1,i,e);return s.length===0?null:s[0]}};function zu(n){return{filter:n}}function Gu(n,e){f(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),f(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function qu(n,e,t,i,r){let s=new er,o,a;if(t.type===re.OVERWRITE){let c=t;c.source.fromUser?o=nr(n,e,c.path,c.snap,i,r,s):(f(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!C(c.path),o=Cn(n,e,c.path,c.snap,i,r,a,s))}else if(t.type===re.MERGE){let c=t;c.source.fromUser?o=Ku(n,e,c.path,c.children,i,r,s):(f(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=ir(n,e,c.path,c.children,i,r,a,s))}else if(t.type===re.ACK_USER_WRITE){let c=t;c.revert?o=Xu(n,e,c.path,i,r,s):o=Qu(n,e,c.path,c.affectedTree,i,r,s)}else if(t.type===re.LISTEN_COMPLETE)o=Ju(n,e,t.path,i,s);else throw Pe("Unknown operation type: "+t.type);let l=s.getChanges();return Yu(e,o,l),{viewCache:o,changes:l}}function Yu(n,e,t){let i=e.eventCache;if(i.isFullyInitialized()){let r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=Ji(n);(t.length>0||!n.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&t.push(Yo(Ji(e)))}}function ra(n,e,t,i,r,s){let o=e.eventCache;if(vn(i,t)!=null)return e;{let a,l;if(C(t))if(f(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let c=Le(e),h=c instanceof g?c:g.EMPTY_NODE,d=xr(i,h);a=n.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let c=yn(i,Le(e));a=n.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{let c=v(t);if(c===".priority"){f(Ee(t)===1,"Can't have a priority with additional path components");let h=o.getNode();l=e.serverCache.getNode();let d=ao(i,t,h,l);d!=null?a=n.filter.updatePriority(h,d):a=o.getNode()}else{let h=S(t),d;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();let u=ao(i,t,o.getNode(),l);u!=null?d=o.getNode().getImmediateChild(c).updateChild(h,u):d=o.getNode().getImmediateChild(c)}else d=kr(i,c,e.serverCache);d!=null?a=n.filter.updateChild(o.getNode(),c,d,h,r,s):a=o.getNode()}}return Tt(e,a,o.isFullyInitialized()||C(t),n.filter.filtersNodes())}}function Cn(n,e,t,i,r,s,o,a){let l=e.serverCache,c,h=o?n.filter:n.filter.getIndexedFilter();if(C(t))c=h.updateFullNode(l.getNode(),i,null);else if(h.filtersNodes()&&!l.isFiltered()){let p=l.getNode().updateChild(t,i);c=h.updateFullNode(l.getNode(),p,null)}else{let p=v(t);if(!l.isCompleteForPath(t)&&Ee(t)>1)return e;let m=S(t),O=l.getNode().getImmediateChild(p).updateChild(m,i);p===".priority"?c=h.updatePriority(l.getNode(),O):c=h.updateChild(l.getNode(),p,O,m,ia,null)}let d=Jo(e,c,l.isFullyInitialized()||C(t),h.filtersNodes()),u=new Nt(r,d,s);return ra(n,d,t,r,u,a)}function nr(n,e,t,i,r,s,o){let a=e.eventCache,l,c,h=new Nt(r,e,s);if(C(t))c=n.filter.updateFullNode(e.eventCache.getNode(),i,o),l=Tt(e,c,!0,n.filter.filtersNodes());else{let d=v(t);if(d===".priority")c=n.filter.updatePriority(e.eventCache.getNode(),i),l=Tt(e,c,a.isFullyInitialized(),a.isFiltered());else{let u=S(t),p=a.getNode().getImmediateChild(d),m;if(C(u))m=i;else{let I=h.getCompleteChild(d);I!=null?Uo(u)===".priority"&&I.getChild(Ho(u)).isEmpty()?m=I:m=I.updateChild(u,i):m=g.EMPTY_NODE}if(p.equals(m))l=e;else{let I=n.filter.updateChild(a.getNode(),d,m,u,h,o);l=Tt(e,I,a.isFullyInitialized(),n.filter.filtersNodes())}}}return l}function lo(n,e){return n.eventCache.isCompleteForChild(e)}function Ku(n,e,t,i,r,s,o){let a=e;return i.foreach((l,c)=>{let h=M(t,l);lo(e,v(h))&&(a=nr(n,a,h,c,r,s,o))}),i.foreach((l,c)=>{let h=M(t,l);lo(e,v(h))||(a=nr(n,a,h,c,r,s,o))}),a}function co(n,e,t){return t.foreach((i,r)=>{e=e.updateChild(i,r)}),e}function ir(n,e,t,i,r,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;C(t)?c=i:c=new V(null).setTree(t,i);let h=e.serverCache.getNode();return c.children.inorderTraversal((d,u)=>{if(h.hasChild(d)){let p=e.serverCache.getNode().getImmediateChild(d),m=co(n,p,u);l=Cn(n,l,new E(d),m,r,s,o,a)}}),c.children.inorderTraversal((d,u)=>{let p=!e.serverCache.isCompleteForChild(d)&&u.value===null;if(!h.hasChild(d)&&!p){let m=e.serverCache.getNode().getImmediateChild(d),I=co(n,m,u);l=Cn(n,l,new E(d),I,r,s,o,a)}}),l}function Qu(n,e,t,i,r,s,o){if(vn(r,t)!=null)return e;let a=e.serverCache.isFiltered(),l=e.serverCache;if(i.value!=null){if(C(t)&&l.isFullyInitialized()||l.isCompleteForPath(t))return Cn(n,e,t,l.getNode().getChild(t),r,s,a,o);if(C(t)){let c=new V(null);return l.getNode().forEachChild(Je,(h,d)=>{c=c.set(new E(h),d)}),ir(n,e,t,c,r,s,a,o)}else return e}else{let c=new V(null);return i.foreach((h,d)=>{let u=M(t,h);l.isCompleteForPath(u)&&(c=c.set(h,l.getNode().getChild(u)))}),ir(n,e,t,c,r,s,a,o)}}function Ju(n,e,t,i,r){let s=e.serverCache,o=Jo(e,s.getNode(),s.isFullyInitialized()||C(t),s.isFiltered());return ra(n,o,t,i,ia,r)}function Xu(n,e,t,i,r,s){let o;if(vn(i,t)!=null)return e;{let a=new Nt(i,e,r),l=e.eventCache.getNode(),c;if(C(t)||v(t)===".priority"){let h;if(e.serverCache.isFullyInitialized())h=yn(i,Le(e));else{let d=e.serverCache.getNode();f(d instanceof g,"serverChildren would be complete if leaf node"),h=xr(i,d)}h=h,c=n.filter.updateFullNode(l,h,s)}else{let h=v(t),d=kr(i,h,e.serverCache);d==null&&e.serverCache.isCompleteForChild(h)&&(d=l.getImmediateChild(h)),d!=null?c=n.filter.updateChild(l,h,d,S(t),a,s):e.eventCache.getNode().hasChild(h)?c=n.filter.updateChild(l,h,g.EMPTY_NODE,S(t),a,s):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=yn(i,Le(e)),o.isLeafNode()&&(c=n.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||vn(i,w())!=null,Tt(e,c,o,n.filter.filtersNodes())}}var rr=class{constructor(e,t){this.query_=e,this.eventRegistrations_=[];let i=this.query_._queryParams,r=new At(i.getIndex()),s=Iu(i);this.processor_=zu(s);let o=t.serverCache,a=t.eventCache,l=r.updateFullNode(g.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(g.EMPTY_NODE,a.getNode(),null),h=new fe(l,o.isFullyInitialized(),r.filtersNodes()),d=new fe(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Pn(d,h),this.eventGenerator_=new Qi(this.query_)}get query(){return this.query_}};function Zu(n){return n.viewCache_.serverCache.getNode()}function ed(n,e){let t=Le(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!C(e)&&!t.getImmediateChild(v(e)).isEmpty())?t.getChild(e):null}function uo(n){return n.eventRegistrations_.length===0}function td(n,e){n.eventRegistrations_.push(e)}function ho(n,e,t){let i=[];if(t){f(e==null,"A cancel should cancel all event registrations.");let r=n.query._path;n.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(t,r);o&&i.push(o)})}if(e){let r=[];for(let s=0;s<n.eventRegistrations_.length;++s){let o=n.eventRegistrations_[s];if(!o.matches(e))r.push(o);else if(e.hasAnyCallback()){r=r.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=r}else n.eventRegistrations_=[];return i}function fo(n,e,t,i){e.type===re.MERGE&&e.source.queryId!==null&&(f(Le(n.viewCache_),"We should always have a full cache before handling merges"),f(Ji(n.viewCache_),"Missing event cache, even though we have a server cache"));let r=n.viewCache_,s=qu(n.processor_,r,e,t,i);return Gu(n.processor_,s.viewCache),f(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,sa(n,s.changes,s.viewCache.eventCache.getNode(),null)}function nd(n,e){let t=n.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(k,(s,o)=>{i.push(it(s,o))}),t.isFullyInitialized()&&i.push(Yo(t.getNode())),sa(n,i,t.getNode(),e)}function sa(n,e,t,i){let r=i?[i]:n.eventRegistrations_;return ku(n.eventGenerator_,e,t,r)}var bn,sr=class{constructor(){this.views=new Map}};function id(n){f(!bn,"__referenceConstructor has already been defined"),bn=n}function rd(){return f(bn,"Reference.ts has not been loaded"),bn}function sd(n){return n.views.size===0}function Pr(n,e,t,i){let r=e.source.queryId;if(r!==null){let s=n.views.get(r);return f(s!=null,"SyncTree gave us an op for an invalid query."),fo(s,e,t,i)}else{let s=[];for(let o of n.views.values())s=s.concat(fo(o,e,t,i));return s}}function od(n,e,t,i,r){let s=e._queryIdentifier,o=n.views.get(s);if(!o){let a=yn(t,r?i:null),l=!1;a?l=!0:i instanceof g?(a=xr(t,i),l=!1):(a=g.EMPTY_NODE,l=!1);let c=Pn(new fe(a,l,!1),new fe(i,r,!1));return new rr(e,c)}return o}function ad(n,e,t,i,r,s){let o=od(n,e,i,r,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),td(o,t),nd(o,t)}function ld(n,e,t,i){let r=e._queryIdentifier,s=[],o=[],a=Ie(n);if(r==="default")for(let[l,c]of n.views.entries())o=o.concat(ho(c,t,i)),uo(c)&&(n.views.delete(l),c.query._queryParams.loadsAllData()||s.push(c.query));else{let l=n.views.get(r);l&&(o=o.concat(ho(l,t,i)),uo(l)&&(n.views.delete(r),l.query._queryParams.loadsAllData()||s.push(l.query)))}return a&&!Ie(n)&&s.push(new(rd())(e._repo,e._path)),{removed:s,events:o}}function oa(n){let e=[];for(let t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Xe(n,e){let t=null;for(let i of n.views.values())t=t||ed(i,e);return t}function aa(n,e){if(e._queryParams.loadsAllData())return An(n);{let i=e._queryIdentifier;return n.views.get(i)}}function la(n,e){return aa(n,e)!=null}function Ie(n){return An(n)!=null}function An(n){for(let e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var wn;function cd(n){f(!wn,"__referenceConstructor has already been defined"),wn=n}function ud(){return f(wn,"Reference.ts has not been loaded"),wn}var dd=1,En=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new V(null),this.pendingWriteTree_=Vu(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function hd(n,e,t,i,r){return Ou(n.pendingWriteTree_,e,t,i,r),r?Ft(n,new rt(Qo(),e,t)):[]}function Ke(n,e,t=!1){let i=Ru(n.pendingWriteTree_,e);if(Mu(n.pendingWriteTree_,e)){let s=new V(null);return i.snap!=null?s=s.set(w(),!0):H(i.children,o=>{s=s.set(new E(o),!0)}),Ft(n,new Ki(i.path,s,t))}else return[]}function Nn(n,e,t){return Ft(n,new rt(Ir(),e,t))}function fd(n,e,t){let i=V.fromObject(t);return Ft(n,new gn(Ir(),e,i))}function pd(n,e){return Ft(n,new _n(Ir(),e))}function md(n,e,t){let i=Ar(n,t);if(i){let r=Nr(i),s=r.path,o=r.queryId,a=j(s,e),l=new _n(Tr(o),a);return Or(n,s,l)}else return[]}function or(n,e,t,i,r=!1){let s=e._path,o=n.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||la(o,e))){let l=ld(o,e,t,i);sd(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));let c=l.removed;if(a=l.events,!r){let h=c.findIndex(u=>u._queryParams.loadsAllData())!==-1,d=n.syncPointTree_.findOnPath(s,(u,p)=>Ie(p));if(h&&!d){let u=n.syncPointTree_.subtree(s);if(!u.isEmpty()){let p=yd(u);for(let m=0;m<p.length;++m){let I=p[m],O=I.query,se=ha(n,I);n.listenProvider_.startListening(xt(O),In(n,O),se.hashFn,se.onComplete)}}}!d&&c.length>0&&!i&&(h?n.listenProvider_.stopListening(xt(e),null):c.forEach(u=>{let p=n.queryToTagMap.get(On(u));n.listenProvider_.stopListening(xt(u),p)}))}vd(n,c)}return a}function _d(n,e,t,i){let r=Ar(n,i);if(r!=null){let s=Nr(r),o=s.path,a=s.queryId,l=j(o,e),c=new rt(Tr(a),l,t);return Or(n,o,c)}else return[]}function gd(n,e,t,i){let r=Ar(n,i);if(r){let s=Nr(r),o=s.path,a=s.queryId,l=j(o,e),c=V.fromObject(t),h=new gn(Tr(a),l,c);return Or(n,o,h)}else return[]}function po(n,e,t,i=!1){let r=e._path,s=null,o=!1;n.syncPointTree_.foreachOnPath(r,(u,p)=>{let m=j(u,r);s=s||Xe(p,m),o=o||Ie(p)});let a=n.syncPointTree_.get(r);a?(o=o||Ie(a),s=s||Xe(a,w())):(a=new sr,n.syncPointTree_=n.syncPointTree_.set(r,a));let l;s!=null?l=!0:(l=!1,s=g.EMPTY_NODE,n.syncPointTree_.subtree(r).foreachChild((p,m)=>{let I=Xe(m,w());I&&(s=s.updateImmediateChild(p,I))}));let c=la(a,e);if(!c&&!e._queryParams.loadsAllData()){let u=On(e);f(!n.queryToTagMap.has(u),"View does not exist, but we have a tag");let p=Cd();n.queryToTagMap.set(u,p),n.tagToQueryMap.set(p,u)}let h=Sr(n.pendingWriteTree_,r),d=ad(a,e,t,h,s,l);if(!c&&!o&&!i){let u=aa(a,e);d=d.concat(bd(n,e,u))}return d}function ca(n,e,t){let r=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{let l=j(o,e),c=Xe(a,l);if(c)return c});return ea(r,e,s,t,!0)}function Ft(n,e){return ua(e,n.syncPointTree_,null,Sr(n.pendingWriteTree_,w()))}function ua(n,e,t,i){if(C(n.path))return da(n,e,t,i);{let r=e.get(w());t==null&&r!=null&&(t=Xe(r,w()));let s=[],o=v(n.path),a=n.operationForChild(o),l=e.children.get(o);if(l&&a){let c=t?t.getImmediateChild(o):null,h=ta(i,o);s=s.concat(ua(a,l,c,h))}return r&&(s=s.concat(Pr(r,n,i,t))),s}}function da(n,e,t,i){let r=e.get(w());t==null&&r!=null&&(t=Xe(r,w()));let s=[];return e.children.inorderTraversal((o,a)=>{let l=t?t.getImmediateChild(o):null,c=ta(i,o),h=n.operationForChild(o);h&&(s=s.concat(da(h,a,l,c)))}),r&&(s=s.concat(Pr(r,n,i,t))),s}function ha(n,e){let t=e.query,i=In(n,t);return{hashFn:()=>(Zu(e)||g.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return i?md(n,t._path,i):pd(n,t._path);{let s=Dc(r,t);return or(n,t,null,s)}}}}function In(n,e){let t=On(e);return n.queryToTagMap.get(t)}function On(n){return n._path.toString()+"$"+n._queryIdentifier}function Ar(n,e){return n.tagToQueryMap.get(e)}function Nr(n){let e=n.indexOf("$");return f(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new E(n.substr(0,e))}}function Or(n,e,t){let i=n.syncPointTree_.get(e);f(i,"Missing sync point for query tag that we're tracking");let r=Sr(n.pendingWriteTree_,e);return Pr(i,t,r,null)}function yd(n){return n.fold((e,t,i)=>{if(t&&Ie(t))return[An(t)];{let r=[];return t&&(r=oa(t)),H(i,(s,o)=>{r=r.concat(o)}),r}})}function xt(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(ud())(n._repo,n._path):n}function vd(n,e){for(let t=0;t<e.length;++t){let i=e[t];if(!i._queryParams.loadsAllData()){let r=On(i),s=n.queryToTagMap.get(r);n.queryToTagMap.delete(r),n.tagToQueryMap.delete(s)}}}function Cd(){return dd++}function bd(n,e,t){let i=e._path,r=In(n,e),s=ha(n,t),o=n.listenProvider_.startListening(xt(e),r,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(i);if(r)f(!Ie(a.value),"If we're adding a query, it shouldn't be shadowed");else{let l=a.fold((c,h,d)=>{if(!C(c)&&h&&Ie(h))return[An(h).query];{let u=[];return h&&(u=u.concat(oa(h).map(p=>p.query))),H(d,(p,m)=>{u=u.concat(m)}),u}});for(let c=0;c<l.length;++c){let h=l[c];n.listenProvider_.stopListening(xt(h),In(n,h))}}return o}var ar=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},lr=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=M(this.path_,e);return new n(this.syncTree_,t)}node(){return ca(this.syncTree_,this.path_)}},wd=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},mo=function(n,e,t){if(!n||typeof n!="object")return n;if(f(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return Ed(n[".sv"],e,t);if(typeof n[".sv"]=="object")return Id(n[".sv"],e);f(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},Ed=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:f(!1,"Unexpected server value: "+n)}},Id=function(n,e,t){n.hasOwnProperty("increment")||f(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let i=n.increment;typeof i!="number"&&f(!1,"Unexpected increment value: "+i);let r=e.node();if(f(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;let o=r.getValue();return typeof o!="number"?i:o+i},Td=function(n,e,t,i){return Rr(e,new lr(t,n),i)},Sd=function(n,e,t){return Rr(n,new ar(e),t)};function Rr(n,e,t){let i=n.getPriority().val(),r=mo(i,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,a=mo(o.getValue(),e,t);return a!==o.getValue()||r!==o.getPriority().val()?new tt(a,F(r)):n}else{let o=n;return s=o,r!==o.getPriority().val()&&(s=s.updatePriority(new tt(r))),o.forEachChild(k,(a,l)=>{let c=Rr(l,e.getImmediateChild(a),t);c!==l&&(s=s.updateImmediateChild(a,c))}),s}}var Ot=class{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}};function Mr(n,e){let t=e instanceof E?e:new E(e),i=n,r=v(t);for(;r!==null;){let s=Ae(i.node.children,r)||{children:{},childCount:0};i=new Ot(r,i,s),t=S(t),r=v(t)}return i}function at(n){return n.node.value}function fa(n,e){n.node.value=e,cr(n)}function pa(n){return n.node.childCount>0}function xd(n){return at(n)===void 0&&!pa(n)}function Rn(n,e){H(n.node.children,(t,i)=>{e(new Ot(t,n,i))})}function ma(n,e,t,i){t&&!i&&e(n),Rn(n,r=>{ma(r,e,!0,i)}),t&&i&&e(n)}function kd(n,e,t){let i=t?n:n.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function Bt(n){return new E(n.parent===null?n.name:Bt(n.parent)+"/"+n.name)}function cr(n){n.parent!==null&&Pd(n.parent,n.name,n)}function Pd(n,e,t){let i=xd(t),r=ne(n.node.children,e);i&&r?(delete n.node.children[e],n.node.childCount--,cr(n)):!i&&!r&&(n.node.children[e]=t.node,n.node.childCount++,cr(n))}var Ad=/[\[\].#$\/\u0000-\u001F\u007F]/,Nd=/[\[\].#$\u0000-\u001F\u007F]/,vi=10*1024*1024,_a=function(n){return typeof n=="string"&&n.length!==0&&!Ad.test(n)},ga=function(n){return typeof n=="string"&&n.length!==0&&!Nd.test(n)},Od=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),ga(n)};var ya=function(n,e,t){let i=t instanceof E?new Ri(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Oe(i));if(typeof e=="function")throw new Error(n+"contains a function "+Oe(i)+" with contents = "+e.toString());if(wo(e))throw new Error(n+"contains "+e.toString()+" "+Oe(i));if(typeof e=="string"&&e.length>vi/3&&pt(e)>vi)throw new Error(n+"contains a string greater than "+vi+" utf8 bytes "+Oe(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,s=!1;if(H(e,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!_a(o)))throw new Error(n+" contains an invalid key ("+o+") "+Oe(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);uu(i,o),ya(n,a,i),du(i)}),r&&s)throw new Error(n+' contains ".value" child '+Oe(i)+" in addition to actual children.")}};var va=function(n,e,t,i){if(!(i&&t===void 0)&&!ga(t))throw new Error(Xn(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Rd=function(n,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),va(n,e,t,i)};var Md=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!_a(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!Od(t))throw new Error(Xn(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var ur=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Ca(n,e){let t=null;for(let i=0;i<e.length;i++){let r=e[i],s=r.getPath();t!==null&&!br(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(r)}t&&n.eventLists_.push(t)}function ba(n,e,t){Ca(n,t),wa(n,i=>br(i,e))}function Be(n,e,t){Ca(n,t),wa(n,i=>J(i,e)||J(e,i))}function wa(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){let r=n.eventLists_[i];if(r){let s=r.path;e(s)?(Dd(n.eventLists_[i]),n.eventLists_[i]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function Dd(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let i=t.getEventRunner();Me&&L("event: "+t.toString()),Dt(i)}}}var Ld="repo_interrupt",Fd=25,dr=class{constructor(e,t,i,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new ur,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=mn(),this.transactionQueueTree_=new Ot,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function Bd(n,e,t){if(n.stats_=Cr(n.repoInfo_),n.forceRestClient_||Wc())n.server_=new $i(n.repoInfo_,(i,r,s,o)=>{_o(n,i,r,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>go(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{R(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new wr(n.repoInfo_,e,(i,r,s,o)=>{_o(n,i,r,s,o)},i=>{go(n,i)},i=>{Ud(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=jc(n.repoInfo_,()=>new Yi(n.stats_,n.server_)),n.infoData_=new zi,n.infoSyncTree_=new En({startListening:(i,r,s,o)=>{let a=[],l=n.infoData_.getNode(i._path);return l.isEmpty()||(a=Nn(n.infoSyncTree_,i._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Dr(n,"connected",!1),n.serverSyncTree_=new En({startListening:(i,r,s,o)=>(n.server_.listen(i,s,r,(a,l)=>{let c=o(a,l);Be(n.eventQueue_,i._path,c)}),[]),stopListening:(i,r)=>{n.server_.unlisten(i,r)}})}function Wd(n){let t=n.infoData_.getNode(new E(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Ea(n){return wd({timestamp:Wd(n)})}function _o(n,e,t,i,r){n.dataUpdateCount++;let s=new E(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(r)if(i){let l=ft(t,c=>F(c));o=gd(n.serverSyncTree_,s,l,r)}else{let l=F(t);o=_d(n.serverSyncTree_,s,l,r)}else if(i){let l=ft(t,c=>F(c));o=fd(n.serverSyncTree_,s,l)}else{let l=F(t);o=Nn(n.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=Fr(n,s)),Be(n.eventQueue_,a,o)}function go(n,e){Dr(n,"connected",e),e===!1&&Hd(n)}function Ud(n,e){H(e,(t,i)=>{Dr(n,t,i)})}function Dr(n,e,t){let i=new E("/.info/"+e),r=F(t);n.infoData_.updateSnapshot(i,r);let s=Nn(n.infoSyncTree_,i,r);Be(n.eventQueue_,i,s)}function jd(n){return n.nextWriteId_++}function Hd(n){Ia(n,"onDisconnectEvents");let e=Ea(n),t=mn();Gi(n.onDisconnect_,w(),(r,s)=>{let o=Td(r,s,n.serverSyncTree_,e);Ko(t,r,o)});let i=[];Gi(t,w(),(r,s)=>{i=i.concat(Nn(n.serverSyncTree_,r,s));let o=qd(n,r);Fr(n,o)}),n.onDisconnect_=mn(),Be(n.eventQueue_,w(),i)}function Vd(n,e,t){let i;v(e._path)===".info"?i=po(n.infoSyncTree_,e,t):i=po(n.serverSyncTree_,e,t),ba(n.eventQueue_,e._path,i)}function yo(n,e,t){let i;v(e._path)===".info"?i=or(n.infoSyncTree_,e,t):i=or(n.serverSyncTree_,e,t),ba(n.eventQueue_,e._path,i)}function $d(n){n.persistentConnection_&&n.persistentConnection_.interrupt(Ld)}function Ia(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),L(t,...e)}function Ta(n,e,t){return ca(n.serverSyncTree_,e,t)||g.EMPTY_NODE}function Lr(n,e=n.transactionQueueTree_){if(e||Mn(n,e),at(e)){let t=xa(n,e);f(t.length>0,"Sending zero length transaction queue"),t.every(r=>r.status===0)&&zd(n,Bt(e),t)}else pa(e)&&Rn(e,t=>{Lr(n,t)})}function zd(n,e,t){let i=t.map(c=>c.currentWriteId),r=Ta(n,e,i),s=r,o=r.hash();for(let c=0;c<t.length;c++){let h=t[c];f(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;let d=j(e,h.path);s=s.updateChild(d,h.currentOutputSnapshotRaw)}let a=s.val(!0),l=e;n.server_.put(l.toString(),a,c=>{Ia(n,"transaction put response",{path:l.toString(),status:c});let h=[];if(c==="ok"){let d=[];for(let u=0;u<t.length;u++)t[u].status=2,h=h.concat(Ke(n.serverSyncTree_,t[u].currentWriteId)),t[u].onComplete&&d.push(()=>t[u].onComplete(null,!0,t[u].currentOutputSnapshotResolved)),t[u].unwatcher();Mn(n,Mr(n.transactionQueueTree_,e)),Lr(n,n.transactionQueueTree_),Be(n.eventQueue_,e,h);for(let u=0;u<d.length;u++)Dt(d[u])}else{if(c==="datastale")for(let d=0;d<t.length;d++)t[d].status===3?t[d].status=4:t[d].status=0;else{$("transaction at "+l.toString()+" failed: "+c);for(let d=0;d<t.length;d++)t[d].status=4,t[d].abortReason=c}Fr(n,e)}},o)}function Fr(n,e){let t=Sa(n,e),i=Bt(t),r=xa(n,t);return Gd(n,r,i),i}function Gd(n,e,t){if(e.length===0)return;let i=[],r=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let l=e[a],c=j(t,l.path),h=!1,d;if(f(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)h=!0,d=l.abortReason,r=r.concat(Ke(n.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=Fd)h=!0,d="maxretry",r=r.concat(Ke(n.serverSyncTree_,l.currentWriteId,!0));else{let u=Ta(n,l.path,o);l.currentInputSnapshot=u;let p=e[a].update(u.val());if(p!==void 0){ya("transaction failed: Data returned ",p,l.path);let m=F(p);typeof p=="object"&&p!=null&&ne(p,".priority")||(m=m.updatePriority(u.getPriority()));let O=l.currentWriteId,se=Ea(n),oe=Sd(m,u,se);l.currentOutputSnapshotRaw=m,l.currentOutputSnapshotResolved=oe,l.currentWriteId=jd(n),o.splice(o.indexOf(O),1),r=r.concat(hd(n.serverSyncTree_,l.path,oe,l.currentWriteId,l.applyLocally)),r=r.concat(Ke(n.serverSyncTree_,O,!0))}else h=!0,d="nodata",r=r.concat(Ke(n.serverSyncTree_,l.currentWriteId,!0))}Be(n.eventQueue_,t,r),r=[],h&&(e[a].status=2,(function(u){setTimeout(u,Math.floor(0))})(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?i.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):i.push(()=>e[a].onComplete(new Error(d),!1,null))))}Mn(n,n.transactionQueueTree_);for(let a=0;a<i.length;a++)Dt(i[a]);Lr(n,n.transactionQueueTree_)}function Sa(n,e){let t,i=n.transactionQueueTree_;for(t=v(e);t!==null&&at(i)===void 0;)i=Mr(i,t),e=S(e),t=v(e);return i}function xa(n,e){let t=[];return ka(n,e,t),t.sort((i,r)=>i.order-r.order),t}function ka(n,e,t){let i=at(e);if(i)for(let r=0;r<i.length;r++)t.push(i[r]);Rn(e,r=>{ka(n,r,t)})}function Mn(n,e){let t=at(e);if(t){let i=0;for(let r=0;r<t.length;r++)t[r].status!==2&&(t[i]=t[r],i++);t.length=i,fa(e,t.length>0?t:void 0)}Rn(e,i=>{Mn(n,i)})}function qd(n,e){let t=Bt(Sa(n,e)),i=Mr(n.transactionQueueTree_,e);return kd(i,r=>{Ci(n,r)}),Ci(n,i),ma(i,r=>{Ci(n,r)}),t}function Ci(n,e){let t=at(e);if(t){let i=[],r=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(f(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(f(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),r=r.concat(Ke(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&i.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?fa(e,void 0):t.length=s+1,Be(n.eventQueue_,Bt(e),r);for(let o=0;o<i.length;o++)Dt(i[o])}}function Yd(n){let e="",t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let r=t[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function Kd(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let i=t.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):$(`Invalid query segment '${t}' in query '${n}'`)}return e}var vo=function(n,e){let t=Qd(n),i=t.namespace;t.domain==="firebase.com"&&he(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&t.domain!=="localhost"&&he("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||Ac();let r=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new an(t.host,t.secure,i,r,e,"",i!==t.subdomain),path:new E(t.pathString)}},Qd=function(n){let e="",t="",i="",r="",s="",o=!0,a="https",l=443;if(typeof n=="string"){let c=n.indexOf("//");c>=0&&(a=n.substring(0,c-1),n=n.substring(c+2));let h=n.indexOf("/");h===-1&&(h=n.length);let d=n.indexOf("?");d===-1&&(d=n.length),e=n.substring(0,Math.min(h,d)),h<d&&(r=Yd(n.substring(h,d)));let u=Kd(n.substring(Math.min(n.length,d)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;let p=e.slice(0,c);if(p.toLowerCase()==="localhost")t="localhost";else if(p.split(".").length<=2)t=p;else{let m=e.indexOf(".");i=e.substring(0,m).toLowerCase(),t=e.substring(m+1),s=i}"ns"in u&&(s=u.ns)}return{host:e,port:l,domain:t,subdomain:i,secure:o,scheme:a,pathString:r,namespace:s}};var Tn=class{constructor(e,t,i,r){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=r}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+R(this.snapshot.exportVal())}},Sn=class{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var hr=class{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return f(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var fr=class n{constructor(e,t,i,r){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=r}get key(){return C(this._path)?null:Uo(this._path)}get ref(){return new pe(this._repo,this._path)}get _queryIdentifier(){let e=no(this._queryParams),t=vr(e);return t==="{}"?"default":t}get _queryObject(){return no(this._queryParams)}isEqual(e){if(e=ue(e),!(e instanceof n))return!1;let t=this._repo===e._repo,i=br(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&i&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+cu(this._path)}};var pe=class n extends fr{constructor(e,t){super(e,t,new Vi,!1)}get parent(){let e=Ho(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},xn=class n{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let t=new E(e),i=kn(this.ref,e);return new n(this._node.getChild(t),i,k)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,r)=>e(new n(r,kn(this.ref,i),k)))}hasChild(e){let t=new E(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function Dn(n,e){return n=ue(n),n._checkNotDeleted("ref"),e!==void 0?kn(n._root,e):n._root}function kn(n,e){return n=ue(n),v(n._path)===null?Rd("child","path",e,!1):va("child","path",e,!1),new pe(n._repo,M(n._path,e))}var pr=class n{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){let i=t._queryParams.getIndex();return new Tn("value",this,new xn(e.snapshotNode,new pe(t._repo,t._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Sn(this,e,t):null}matches(e){return e instanceof n?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},mr=class n{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Sn(this,e,t):null}createEvent(e,t){f(e.childName!=null,"Child events should have a childName.");let i=kn(new pe(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new Tn(e.type,this,new xn(e.snapshotNode,i,r),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof n?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function Jd(n,e,t,i,r){let s;if(typeof i=="object"&&(s=void 0,r=i),typeof i=="function"&&(s=i),r&&r.onlyOnce){let l=t,c=(h,d)=>{yo(n._repo,n,a),l(h,d)};c.userCallback=t.userCallback,c.context=t.context,t=c}let o=new hr(t,s||void 0),a=e==="value"?new pr(o):new mr(e,o);return Vd(n._repo,n,a),()=>yo(n._repo,n,a)}function Ln(n,e,t,i){return Jd(n,"value",e,t,i)}id(pe);cd(pe);var Xd="FIREBASE_DATABASE_EMULATOR_HOST",_r={},Zd=!1;function eh(n,e,t,i){let r=e.lastIndexOf(":"),s=e.substring(0,r),o=Jt(s);n.repoInfo_=new an(e,o,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0,t),i&&(n.authTokenProvider_=i)}function th(n,e,t,i,r){let s=i||n.options.databaseURL;s===void 0&&(n.options.projectId||he("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),L("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=vo(s,r),a=o.repoInfo,l,c;typeof process<"u"&&process.env&&(c=process.env[Xd]),c?(l=!0,s=`http://${c}?ns=${a.namespace}`,o=vo(s,r),a=o.repoInfo):l=!o.repoInfo.secure;let h=r&&l?new It(It.OWNER):new Si(n.name,n.options,e);Md("Invalid Firebase Database URL",o),C(o.path)||he("Database URL must point to the root of a Firebase Database (not including a child path).");let d=ih(a,n,h,new Ti(n,t));return new gr(d,n)}function nh(n,e){let t=_r[e];(!t||t[n.key]!==n)&&he(`Database ${e}(${n.repoInfo_}) has already been deleted.`),$d(n),delete t[n.key]}function ih(n,e,t,i){let r=_r[e.name];r||(r={},_r[e.name]=r);let s=r[n.toURLString()];return s&&he("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new dr(n,Zd,t,i),r[n.toURLString()]=s,s}var gr=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Bd(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new pe(this._repo,w())),this._rootInternal}_delete(){return this._rootInternal!==null&&(nh(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&he("Cannot call "+e+" on a deleted database.")}};function Pa(n=gt(),e){let t=be(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){let i=hs("database");i&&rh(t,...i)}return t}function rh(n,e,t,i={}){n=ue(n),n._checkNotDeleted("useEmulator");let r=`${e}:${t}`,s=n._repoInternal;if(n._instanceStarted){if(r===n._repoInternal.repoInfo_.host&&ye(i,s.repoInfo_.emulatorOptions))return;he("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&he('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new It(It.OWNER);else if(i.mockUserToken){let a=typeof i.mockUserToken=="string"?i.mockUserToken:ps(i.mockUserToken,n.app.options.projectId);o=new It(a)}Jt(e)&&(fs(e),ms("Database",!0)),eh(s,r,i,o)}function sh(n){xc(Ls),K(new B("database",(e,{instanceIdentifier:t})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return th(i,r,s,t)},"PUBLIC").setMultipleInstances(!0)),U(Ws,Us,n),U(Ws,Us,"esm2020")}wr.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};wr.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};sh();var oh="firebase",ah="12.7.0";U(oh,ah,"app");var Oa="@firebase/installations",jr="0.6.19";var Ra=1e4,Ma=`w:${jr}`,Da="FIS_v2",lh="https://firebaseinstallations.googleapis.com/v1",ch=3600*1e3,uh="installations",dh="Installations";var hh={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Ue=new ce(uh,dh,hh);function La(n){return n instanceof Y&&n.code.includes("request-failed")}function Fa({projectId:n}){return`${lh}/projects/${n}/installations`}function Ba(n){return{token:n.token,requestStatus:2,expiresIn:ph(n.expiresIn),creationTime:Date.now()}}function Wa(n,e){return _(this,null,function*(){let i=(yield e.json()).error;return Ue.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})})}function Ua({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function fh(n,{refreshToken:e}){let t=Ua(n);return t.append("Authorization",mh(e)),t}function ja(n){return _(this,null,function*(){let e=yield n();return e.status>=500&&e.status<600?n():e})}function ph(n){return Number(n.replace("s","000"))}function mh(n){return`${Da} ${n}`}function _h(i,r){return _(this,arguments,function*({appConfig:n,heartbeatServiceProvider:e},{fid:t}){let s=Fa(n),o=Ua(n),a=e.getImmediate({optional:!0});if(a){let d=yield a.getHeartbeatsHeader();d&&o.append("x-firebase-client",d)}let l={fid:t,authVersion:Da,appId:n.appId,sdkVersion:Ma},c={method:"POST",headers:o,body:JSON.stringify(l)},h=yield ja(()=>fetch(s,c));if(h.ok){let d=yield h.json();return{fid:d.fid||t,registrationStatus:2,refreshToken:d.refreshToken,authToken:Ba(d.authToken)}}else throw yield Wa("Create Installation",h)})}function Ha(n){return new Promise(e=>{setTimeout(e,n)})}function gh(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}var yh=/^[cdef][\w-]{21}$/,Ur="";function vh(){try{let n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;let t=Ch(n);return yh.test(t)?t:Ur}catch{return Ur}}function Ch(n){return gh(n).substr(0,22)}function Bn(n){return`${n.appName}!${n.appId}`}var Va=new Map;function $a(n,e){let t=Bn(n);za(t,e),bh(t,e)}function za(n,e){let t=Va.get(n);if(t)for(let i of t)i(e)}function bh(n,e){let t=wh();t&&t.postMessage({key:n,fid:e}),Eh()}var We=null;function wh(){return!We&&"BroadcastChannel"in self&&(We=new BroadcastChannel("[Firebase] FID Change"),We.onmessage=n=>{za(n.data.key,n.data.fid)}),We}function Eh(){Va.size===0&&We&&(We.close(),We=null)}var Ih="firebase-installations-database",Th=1,je="firebase-installations-store",Br=null;function Hr(){return Br||(Br=nn(Ih,Th,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(je)}}})),Br}function Fn(n,e){return _(this,null,function*(){let t=Bn(n),r=(yield Hr()).transaction(je,"readwrite"),s=r.objectStore(je),o=yield s.get(t);return yield s.put(e,t),yield r.done,(!o||o.fid!==e.fid)&&$a(n,e.fid),e})}function Ga(n){return _(this,null,function*(){let e=Bn(n),i=(yield Hr()).transaction(je,"readwrite");yield i.objectStore(je).delete(e),yield i.done})}function Wn(n,e){return _(this,null,function*(){let t=Bn(n),r=(yield Hr()).transaction(je,"readwrite"),s=r.objectStore(je),o=yield s.get(t),a=e(o);return a===void 0?yield s.delete(t):yield s.put(a,t),yield r.done,a&&(!o||o.fid!==a.fid)&&$a(n,a.fid),a})}function Vr(n){return _(this,null,function*(){let e,t=yield Wn(n.appConfig,i=>{let r=Sh(i),s=xh(n,r);return e=s.registrationPromise,s.installationEntry});return t.fid===Ur?{installationEntry:yield e}:{installationEntry:t,registrationPromise:e}})}function Sh(n){let e=n||{fid:vh(),registrationStatus:0};return qa(e)}function xh(n,e){if(e.registrationStatus===0){if(!navigator.onLine){let r=Promise.reject(Ue.create("app-offline"));return{installationEntry:e,registrationPromise:r}}let t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=kh(n,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:Ph(n)}:{installationEntry:e}}function kh(n,e){return _(this,null,function*(){try{let t=yield _h(n,e);return Fn(n.appConfig,t)}catch(t){throw La(t)&&t.customData.serverCode===409?yield Ga(n.appConfig):yield Fn(n.appConfig,{fid:e.fid,registrationStatus:0}),t}})}function Ph(n){return _(this,null,function*(){let e=yield Aa(n.appConfig);for(;e.registrationStatus===1;)yield Ha(100),e=yield Aa(n.appConfig);if(e.registrationStatus===0){let{installationEntry:t,registrationPromise:i}=yield Vr(n);return i||t}return e})}function Aa(n){return Wn(n,e=>{if(!e)throw Ue.create("installation-not-found");return qa(e)})}function qa(n){return Ah(n)?{fid:n.fid,registrationStatus:0}:n}function Ah(n){return n.registrationStatus===1&&n.registrationTime+Ra<Date.now()}function Nh(i,r){return _(this,arguments,function*({appConfig:n,heartbeatServiceProvider:e},t){let s=Oh(n,t),o=fh(n,t),a=e.getImmediate({optional:!0});if(a){let d=yield a.getHeartbeatsHeader();d&&o.append("x-firebase-client",d)}let l={installation:{sdkVersion:Ma,appId:n.appId}},c={method:"POST",headers:o,body:JSON.stringify(l)},h=yield ja(()=>fetch(s,c));if(h.ok){let d=yield h.json();return Ba(d)}else throw yield Wa("Generate Auth Token",h)})}function Oh(n,{fid:e}){return`${Fa(n)}/${e}/authTokens:generate`}function $r(n,e=!1){return _(this,null,function*(){let t,i=yield Wn(n.appConfig,s=>{if(!Ya(s))throw Ue.create("not-registered");let o=s.authToken;if(!e&&Dh(o))return s;if(o.requestStatus===1)return t=Rh(n,e),s;{if(!navigator.onLine)throw Ue.create("app-offline");let a=Fh(s);return t=Mh(n,a),a}});return t?yield t:i.authToken})}function Rh(n,e){return _(this,null,function*(){let t=yield Na(n.appConfig);for(;t.authToken.requestStatus===1;)yield Ha(100),t=yield Na(n.appConfig);let i=t.authToken;return i.requestStatus===0?$r(n,e):i})}function Na(n){return Wn(n,e=>{if(!Ya(e))throw Ue.create("not-registered");let t=e.authToken;return Bh(t)?ae(N({},e),{authToken:{requestStatus:0}}):e})}function Mh(n,e){return _(this,null,function*(){try{let t=yield Nh(n,e),i=ae(N({},e),{authToken:t});return yield Fn(n.appConfig,i),t}catch(t){if(La(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))yield Ga(n.appConfig);else{let i=ae(N({},e),{authToken:{requestStatus:0}});yield Fn(n.appConfig,i)}throw t}})}function Ya(n){return n!==void 0&&n.registrationStatus===2}function Dh(n){return n.requestStatus===2&&!Lh(n)}function Lh(n){let e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+ch}function Fh(n){let e={requestStatus:1,requestTime:Date.now()};return ae(N({},n),{authToken:e})}function Bh(n){return n.requestStatus===1&&n.requestTime+Ra<Date.now()}function Wh(n){return _(this,null,function*(){let e=n,{installationEntry:t,registrationPromise:i}=yield Vr(e);return i?i.catch(console.error):$r(e).catch(console.error),t.fid})}function Uh(n,e=!1){return _(this,null,function*(){let t=n;return yield jh(t),(yield $r(t,e)).token})}function jh(n){return _(this,null,function*(){let{registrationPromise:e}=yield Vr(n);e&&(yield e)})}function Hh(n){if(!n||!n.options)throw Wr("App Configuration");if(!n.name)throw Wr("App Name");let e=["projectId","apiKey","appId"];for(let t of e)if(!n.options[t])throw Wr(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Wr(n){return Ue.create("missing-app-config-values",{valueName:n})}var Ka="installations",Vh="installations-internal",$h=n=>{let e=n.getProvider("app").getImmediate(),t=Hh(e),i=be(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},zh=n=>{let e=n.getProvider("app").getImmediate(),t=be(e,Ka).getImmediate();return{getId:()=>Wh(t),getToken:r=>Uh(t,r)}};function Gh(){K(new B(Ka,$h,"PUBLIC")),K(new B(Vh,zh,"PRIVATE"))}Gh();U(Oa,jr);U(Oa,jr,"esm2020");var Un="analytics",qh="firebase_id",Yh="origin",Kh=60*1e3,Qh="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Jr="https://www.googletagmanager.com/gtag/js";var W=new ve("@firebase/analytics");var Jh={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},z=new ce("analytics","Analytics",Jh);function Xh(n){if(!n.startsWith(Jr)){let e=z.create("invalid-gtag-resource",{gtagURL:n});return W.warn(e.message),""}return n}function nl(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function Zh(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function ef(n,e){let t=Zh("firebase-js-sdk-policy",{createScriptURL:Xh}),i=document.createElement("script"),r=`${Jr}?l=${n}&id=${e}`;i.src=t?t?.createScriptURL(r):r,i.async=!0,document.head.appendChild(i)}function tf(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}function nf(n,e,t,i,r,s){return _(this,null,function*(){let o=i[r];try{if(o)yield e[o];else{let l=(yield nl(t)).find(c=>c.measurementId===r);l&&(yield e[l.appId])}}catch(a){W.error(a)}n("config",r,s)})}function rf(n,e,t,i,r){return _(this,null,function*(){try{let s=[];if(r&&r.send_to){let o=r.send_to;Array.isArray(o)||(o=[o]);let a=yield nl(t);for(let l of o){let c=a.find(d=>d.measurementId===l),h=c&&e[c.appId];if(h)s.push(h);else{s=[];break}}}s.length===0&&(s=Object.values(e)),yield Promise.all(s),n("event",i,r||{})}catch(s){W.error(s)}})}function sf(n,e,t,i){function r(s,...o){return _(this,null,function*(){try{if(s==="event"){let[a,l]=o;yield rf(n,e,t,a,l)}else if(s==="config"){let[a,l]=o;yield nf(n,e,t,i,a,l)}else if(s==="consent"){let[a,l]=o;n("consent",a,l)}else if(s==="get"){let[a,l,c]=o;n("get",a,l,c)}else if(s==="set"){let[a]=o;n("set",a)}else n(s,...o)}catch(a){W.error(a)}})}return r}function of(n,e,t,i,r){let s=function(...o){window[i].push(arguments)};return window[r]&&typeof window[r]=="function"&&(s=window[r]),window[r]=sf(s,n,e,t),{gtagCore:s,wrappedGtag:window[r]}}function af(n){let e=window.document.getElementsByTagName("script");for(let t of Object.values(e))if(t.src&&t.src.includes(Jr)&&t.src.includes(n))return t;return null}var lf=30,cf=1e3,Gr=class{constructor(e={},t=cf){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}},il=new Gr;function uf(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}function df(n){return _(this,null,function*(){let{appId:e,apiKey:t}=n,i={method:"GET",headers:uf(t)},r=Qh.replace("{app-id}",e),s=yield fetch(r,i);if(s.status!==200&&s.status!==304){let o="";try{let a=yield s.json();a.error?.message&&(o=a.error.message)}catch{}throw z.create("config-fetch-failed",{httpStatus:s.status,responseMessage:o})}return s.json()})}function hf(i){return _(this,arguments,function*(n,e=il,t){let{appId:r,apiKey:s,measurementId:o}=n.options;if(!r)throw z.create("no-app-id");if(!s){if(o)return{measurementId:o,appId:r};throw z.create("no-api-key")}let a=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},l=new qr;return setTimeout(()=>_(null,null,function*(){l.abort()}),t!==void 0?t:Kh),rl({appId:r,apiKey:s,measurementId:o},a,l,e)})}function rl(s,o,a){return _(this,arguments,function*(n,{throttleEndTimeMillis:e,backoffCount:t},i,r=il){let{appId:l,measurementId:c}=n;try{yield ff(i,e)}catch(h){if(c)return W.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${h?.message}]`),{appId:l,measurementId:c};throw h}try{let h=yield df(n);return r.deleteThrottleMetadata(l),h}catch(h){let d=h;if(!pf(d)){if(r.deleteThrottleMetadata(l),c)return W.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${d?.message}]`),{appId:l,measurementId:c};throw h}let u=Number(d?.customData?.httpStatus)===503?Zn(t,r.intervalMillis,lf):Zn(t,r.intervalMillis),p={throttleEndTimeMillis:Date.now()+u,backoffCount:t+1};return r.setThrottleMetadata(l,p),W.debug(`Calling attemptFetch again in ${u} millis`),rl(n,p,i,r)}})}function ff(n,e){return new Promise((t,i)=>{let r=Math.max(e-Date.now(),0),s=setTimeout(t,r);n.addEventListener(()=>{clearTimeout(s),i(z.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function pf(n){if(!(n instanceof Y)||!n.customData)return!1;let e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}var qr=class{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}};var Yr;function mf(n,e,t,i,r){return _(this,null,function*(){if(r&&r.global){n("event",t,i);return}else{let s=yield e,o=ae(N({},i),{send_to:s});n("event",t,o)}})}function _f(n,e,t,i){return _(this,null,function*(){if(i&&i.global){let r={};for(let s of Object.keys(t))r[`user_properties.${s}`]=t[s];return n("set",r),Promise.resolve()}else{let r=yield e;n("config",r,{update:!0,user_properties:t})}})}var Kr;function gf(n){Kr=n}function yf(n){Yr=n}function vf(){return _(this,null,function*(){if(Xt())try{yield Zt()}catch(n){return W.warn(z.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}else return W.warn(z.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0})}function Cf(n,e,t,i,r,s,o){return _(this,null,function*(){let a=hf(n);a.then(u=>{t[u.measurementId]=u.appId,n.options.measurementId&&u.measurementId!==n.options.measurementId&&W.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${u.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(u=>W.error(u)),e.push(a);let l=vf().then(u=>{if(u)return i.getId()}),[c,h]=yield Promise.all([a,l]);af(s)||ef(s,c.measurementId),Kr&&(r("consent","default",Kr),gf(void 0)),r("js",new Date);let d=o?.config??{};return d[Yh]="firebase",d.update=!0,h!=null&&(d[qh]=h),r("config",c.measurementId,d),Yr&&(r("set",Yr),yf(void 0)),c.measurementId})}var Qr=class{constructor(e){this.app=e}_delete(){return delete lt[this.app.options.appId],Promise.resolve()}},lt={},Qa=[],Ja={},zr="dataLayer",bf="gtag",Xa,Xr,Za=!1;function wf(){let n=[];if(_s()&&n.push("This is a browser extension environment."),ys()||n.push("Cookies are not available."),n.length>0){let e=n.map((i,r)=>`(${r+1}) ${i}`).join(" "),t=z.create("invalid-analytics-context",{errorInfo:e});W.warn(t.message)}}function Ef(n,e,t){wf();let i=n.options.appId;if(!i)throw z.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)W.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw z.create("no-api-key");if(lt[i]!=null)throw z.create("already-exists",{id:i});if(!Za){tf(zr);let{wrappedGtag:s,gtagCore:o}=of(lt,Qa,Ja,zr,bf);Xr=s,Xa=o,Za=!0}return lt[i]=Cf(n,Qa,Ja,e,Xa,zr,t),new Qr(n)}function sl(n=gt()){n=ue(n);let e=be(n,Un);return e.isInitialized()?e.getImmediate():If(n)}function If(n,e={}){let t=be(n,Un);if(t.isInitialized()){let r=t.getImmediate();if(ye(e,t.getOptions()))return r;throw z.create("already-initialized")}return t.initialize({options:e})}function Tf(n,e,t){n=ue(n),_f(Xr,lt[n.app.options.appId],e,t).catch(i=>W.error(i))}function Sf(n,e,t,i){n=ue(n),mf(Xr,lt[n.app.options.appId],e,t,i).catch(r=>W.error(r))}var el="@firebase/analytics",tl="0.10.19";function xf(){K(new B(Un,(e,{options:t})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();return Ef(i,r,t)},"PUBLIC")),K(new B("analytics-internal",n,"PRIVATE")),U(el,tl),U(el,tl,"esm2020");function n(e){try{let t=e.getProvider(Un).getImmediate();return{logEvent:(i,r,s)=>Sf(t,i,r,s),setUserProperties:(i,r)=>Tf(t,i,r)}}catch(t){throw z.create("interop-component-reg-failed",{reason:t})}}}xf();var kf={apiKey:"AIzaSyAYVgFEonP6_I087pT0Q4USXkMB1GrpnDc",authDomain:"profile-cd57b.firebaseapp.com",projectId:"profile-cd57b",storageBucket:"profile-cd57b.firebasestorage.app",messagingSenderId:"65056567945",appId:"1:65056567945:web:1565e4167a491b0d46cc58",measurementId:"G-0PRMQQ440W",databaseURL:"https://profile-cd57b-default-rtdb.firebaseio.com/"},ol=fi(kf),Qp=sl(ol),jn=Pa(ol);var Hn=class n{projects=Z([]);skills=Z([]);contents=Z([]);isLoading=Z(!0);projectsRef;skillsRef;contentsRef;constructor(){this.projectsRef=Dn(jn,"portfolio/projects"),this.skillsRef=Dn(jn,"portfolio/skills"),this.contentsRef=Dn(jn,"portfolio/contents"),this.subscribeToChanges()}subscribeToChanges(){Ln(this.projectsRef,e=>{let t=e.val();this.projects.set(t||[]),this.isLoading.set(!1)},e=>{console.error("Error al cargar proyectos:",e),this.isLoading.set(!1)}),Ln(this.skillsRef,e=>{let t=e.val();this.skills.set(t||[])},e=>{console.error("Error al cargar habilidades:",e)}),Ln(this.contentsRef,e=>{let t=e.val();this.contents.set(t||[])},e=>{console.error("Error al cargar contenidos:",e)})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=He({token:n,factory:n.\u0275fac,providedIn:"root"})};var Af=(n,e)=>e.titleButton,Nf=(n,e)=>e.subTitle;function Of(n,e){if(n&1&&(G(0,"li",9)(1,"div",10)(2,"strong",11),A(3),le()(),G(4,"div",12)(5,"span",13),A(6),le(),G(7,"span",14),A(8),le()()()),n&2){let t=e.$implicit;b(3),D(t.subTitle),b(3),D(t.description),b(2),D(t.date)}}function Rf(n,e){if(n&1&&(G(0,"div",6)(1,"h3",7),A(2),le(),G(3,"ul",8),me(4,Of,9,3,"li",9,Nf),le()()),n&2){let t=e.$implicit;b(2),D(t.titleButton),b(2),_e(t.listContent)}}function Mf(n,e){if(n&1){let t=jt();G(0,"div",1),Ht("click",function(r){Ve(t);let s=ee();return $e(s.onBackdropClick(r))}),G(1,"div",2),Ht("click",function(r){return Ve(t),$e(r.stopPropagation())}),G(2,"div",3)(3,"h2"),A(4),le(),G(5,"button",4),Ht("click",function(){Ve(t);let r=ee();return $e(r.closeModal())}),G(6,"span"),A(7,"\xD7"),le()()(),G(8,"div",5),me(9,Rf,6,1,"div",6,Af),le()()()}if(n&2){let t=ee();b(4),D(t.title),b(5),_e(t.contents)}}var Vn=class n{isOpen=!1;title="M\xE1s sobre m\xED";contents=[];close=new es;onBackdropClick(e){e.target===e.currentTarget&&this.closeModal()}closeModal(){this.close.emit(),document.body.style.overflow="auto"}ngOnChanges(e){e.isOpen&&(this.isOpen?document.body.style.overflow="hidden":document.body.style.overflow="auto")}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ut({type:n,selectors:[["app-modal"]],inputs:{isOpen:"isOpen",title:"title",contents:"contents"},outputs:{close:"close"},features:[Zr],decls:1,vars:1,consts:[[1,"modal-backdrop"],[1,"modal-backdrop",3,"click"],[1,"modal-container",3,"click"],[1,"modal-header"],["aria-label","Cerrar modal",1,"modal-close-btn",3,"click"],[1,"modal-content"],[1,"modal-section"],[1,"section-title"],[1,"modal-list"],[1,"modal-item"],[1,"modal-item-header"],[1,"modal-item-title"],[1,"modal-item-body"],[1,"modal-item-institution"],[1,"modal-item-date"]],template:function(t,i){t&1&&Se(0,Mf,11,1,"div",0),t&2&&xe(i.isOpen?0:-1)},dependencies:[$t],styles:[".modal-backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#000000b3;display:flex;align-items:center;justify-content:center;z-index:1000;animation:_ngcontent-%COMP%_fadeIn .3s ease;padding:1rem;overflow-y:auto}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.modal-container[_ngcontent-%COMP%]{background:var(--bgColor);border-radius:16px;max-width:800px;width:100%;max-height:90vh;display:flex;flex-direction:column;box-shadow:var(--shadowEnd);border:2px solid var(--subtitle);animation:_ngcontent-%COMP%_slideUp .3s ease;overflow:hidden}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(50px);opacity:0}to{transform:translateY(0);opacity:1}}.modal-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1.5rem;border-bottom:2px solid var(--subtitle);background:var(--bgColorHover)}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:var(--title);margin:0}.modal-close-btn[_ngcontent-%COMP%]{background:transparent;border:2px solid var(--subtitle);border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s ease;color:var(--title);font-size:1.5rem;line-height:1}.modal-close-btn[_ngcontent-%COMP%]:hover{background:var(--bgColorActivate);border-color:var(--title);transform:rotate(90deg)}.modal-close-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block}.modal-content[_ngcontent-%COMP%]{padding:1.5rem;overflow-y:auto;flex:1;display:flex;flex-direction:column;gap:2rem}.modal-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.section-title[_ngcontent-%COMP%]{font-size:1.3rem;font-weight:600;color:var(--title);margin:0;padding-bottom:.75rem;border-bottom:2px solid var(--subtitle)}.modal-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:1rem}.modal-item[_ngcontent-%COMP%]{background:var(--bgColorHover);border-radius:12px;padding:1rem;border-left:4px solid var(--subtitle);transition:all .3s ease}.modal-item[_ngcontent-%COMP%]:hover{background:var(--bgColorActivate);transform:translate(5px);box-shadow:var(--shadowStart)}.modal-item-header[_ngcontent-%COMP%]{margin-bottom:.5rem}.modal-item-title[_ngcontent-%COMP%]{color:var(--title);font-size:1.1rem;font-weight:600;display:block}.modal-item-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.modal-item-institution[_ngcontent-%COMP%]{color:var(--subtitle);font-size:.95rem;display:block}.modal-item-date[_ngcontent-%COMP%]{color:var(--text);font-size:.85rem;font-style:italic;display:block}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:var(--bgColor);border-radius:4px}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--subtitle);border-radius:4px}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:var(--title)}@media (max-width: 768px){.modal-container[_ngcontent-%COMP%]{max-width:95%;max-height:95vh;border-radius:12px}.modal-header[_ngcontent-%COMP%]{padding:1rem}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem}.modal-close-btn[_ngcontent-%COMP%]{width:35px;height:35px;font-size:1.25rem}.modal-content[_ngcontent-%COMP%]{padding:1rem;gap:1.5rem}.section-title[_ngcontent-%COMP%]{font-size:1.1rem}.modal-item[_ngcontent-%COMP%]{padding:.75rem}.modal-item-title[_ngcontent-%COMP%]{font-size:1rem}}@media (max-width: 480px){.modal-backdrop[_ngcontent-%COMP%]{padding:.5rem}.modal-container[_ngcontent-%COMP%]{max-width:100%;max-height:100vh;border-radius:0}.modal-header[_ngcontent-%COMP%]{padding:.75rem}.modal-content[_ngcontent-%COMP%]{padding:.75rem;gap:1rem}}"]})};var Df=(n,e)=>e.h2,ll=(n,e)=>e.name;function Lf(n,e){n&1&&(x(0,"div",9),A(1,"Cargando proyectos..."),P())}function Ff(n,e){if(n&1){let t=jt();x(0,"div",22),ze("click",function(){let r=Ve(t).$implicit,s=ee(2);return $e(s.openProject(r.url))}),x(1,"div",23),ut(2,"img",24),P(),x(3,"div",25)(4,"h3"),A(5),P(),x(6,"p",26),A(7),P(),x(8,"span",27),A(9),P()()()}if(n&2){let t=e.$implicit;b(2),ge("src",t.img,ct)("alt",t.name),b(3),D(t.name),b(2),D(t.tool),b(),ns("active",t.state.toLowerCase()==="active"||t.state.toLowerCase()==="activo"),b(),is(" ",t.state," ")}}function Bf(n,e){if(n&1&&me(0,Ff,10,7,"div",21,ll),n&2){let t=ee();_e(t.projects())}}function Wf(n,e){if(n&1&&(x(0,"span",29),A(1),P()),n&2){let t=e.$implicit;b(),D(t)}}function Uf(n,e){if(n&1&&me(0,Wf,2,1,"span",29,ts),n&2){let t=ee().$implicit;_e(t.items)}}function jf(n,e){if(n&1&&ut(0,"img",31),n&2){let t=ee().$implicit;ge("src",t.img,ct)("alt",t.name)}}function Hf(n,e){if(n&1&&(x(0,"div",30),Se(1,jf,1,2,"img",31),x(2,"span"),A(3),P()()),n&2){let t=e.$implicit;b(),xe(t.img?1:-1),b(2),D(t.name)}}function Vf(n,e){if(n&1&&me(0,Hf,4,2,"div",30,ll),n&2){let t=ee().$implicit;_e(t.itemsObject)}}function $f(n,e){if(n&1&&(x(0,"div",17)(1,"h3"),A(2),P(),x(3,"div",28),Se(4,Uf,2,0),Se(5,Vf,2,0),P()()),n&2){let t=e.$implicit;b(2),D(t.h2),b(2),xe(t.items?4:-1),b(),xe(t.itemsObject?5:-1)}}var al=class n{themeService=Wt(zt);languageService=Wt(qt);portfolioService=Wt(Hn);ngOnInit(){this.themeService.currentTheme()}projects=this.portfolioService.projects;skills=this.portfolioService.skills;allContents=this.portfolioService.contents;isLoading=this.portfolioService.isLoading;t=rs(()=>this.languageService.getTranslations());isModalOpen=!1;fullName="Jhojan Danilo Toro Perez";profileImage="assets/img/MyProfile.png";get currentTheme(){return this.themeService.currentTheme()}get currentWallpaper(){return this.themeService.currentWallpaper()}get currentLanguage(){return this.languageService.currentLanguage()}toggleTheme(){this.themeService.toggleTheme()}toggleLanguage(){this.languageService.toggleLanguage()}openProject(e){e&&window.open(e,"_blank")}openModal(){this.isModalOpen=!0}closeModal(){this.isModalOpen=!1}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ut({type:n,selectors:[["app-portfolio"]],decls:33,vars:16,consts:[[1,"portfolio-container"],[1,"portfolio-header"],[1,"theme-toggle-btn",3,"click","title"],[1,"theme-icon",3,"src","alt"],[1,"full-name"],[1,"portfolio-main"],[1,"portfolio-column","projects-column"],[1,"column-header"],[1,"projects-list"],[1,"loading-message"],[1,"portfolio-column","center-column"],[1,"about-me-btn",3,"click"],[1,"btn-icon"],[1,"profile-image-container"],["alt","Jhojan Danilo Toro Perez","loading","lazy",1,"profile-image",3,"src"],[1,"portfolio-column","skills-column"],[1,"skills-content"],[1,"skill-group"],[3,"close","isOpen","title","contents"],[1,"language-toggle-btn",3,"click","title"],[1,"language-code"],[1,"project-card"],[1,"project-card",3,"click"],[1,"project-image"],["loading","lazy",3,"src","alt"],[1,"project-info"],[1,"project-tool"],[1,"project-state"],[1,"skills-list"],[1,"skill-chip"],[1,"skill-item-object"],[1,"skill-icon",3,"src","alt"]],template:function(t,i){t&1&&(x(0,"div",0)(1,"header",1)(2,"button",2),ze("click",function(){return i.toggleTheme()}),ut(3,"img",3),P(),x(4,"h1",4),A(5),P()(),x(6,"main",5)(7,"section",6)(8,"div",7)(9,"h2"),A(10),P()(),x(11,"div",8),Se(12,Lf,2,0,"div",9)(13,Bf,2,0),P()(),x(14,"section",10)(15,"button",11),ze("click",function(){return i.openModal()}),x(16,"h2"),A(17),P(),x(18,"span",12),A(19,"\u2192"),P()(),x(20,"div",13),ut(21,"img",14),P()(),x(22,"section",15)(23,"div",7)(24,"h2"),A(25),P()(),x(26,"div",16),me(27,$f,6,3,"div",17,Df),P()()(),x(29,"app-modal",18),ze("close",function(){return i.closeModal()}),P(),x(30,"button",19),ze("click",function(){return i.toggleLanguage()}),x(31,"span",20),A(32),P()()()),t&2&&(b(2),ge("title",i.t().changeTheme),zn("aria-label",i.t().changeThemeToLight),b(),ge("src",i.currentTheme==="dark"?"assets/img/Cambio_tema/sun.png":"assets/img/Cambio_tema/moon.png",ct)("alt",i.currentTheme==="dark"?i.t().changeThemeToLight:i.t().changeThemeToDark),b(2),D(i.fullName),b(5),D(i.t().projects),b(2),xe(i.isLoading()?12:13),b(5),D(i.t().aboutMe),b(4),ge("src",i.profileImage,ct),b(4),D(i.t().hardAndSoftSkills),b(2),_e(i.skills()),b(2),ge("isOpen",i.isModalOpen)("title",i.t().modalTitle)("contents",i.allContents()),b(),ge("title",i.currentLanguage==="es"?"EN":"ES"),zn("aria-label",i.currentLanguage==="es"?"Change to English":"Cambiar a Espa\xF1ol"),b(2),D(i.currentLanguage==="es"?"EN":"ES"))},dependencies:[$t,Vn],styles:[".portfolio-container[_ngcontent-%COMP%]{height:100vh;padding:1rem;display:flex;flex-direction:column;gap:1rem;width:100%;max-width:100%;margin:0;overflow:hidden}.portfolio-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;position:relative;padding:1rem 0;width:100%}.theme-toggle-btn[_ngcontent-%COMP%]{position:absolute;left:0;width:40px;height:40px;border-radius:50%;border:2px solid var(--buttonBorder);background:var(--buttonBg);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s ease;box-shadow:var(--shadowStart)}.theme-toggle-btn[_ngcontent-%COMP%]:hover{background:var(--buttonBgHover);border-color:var(--title);transform:scale(1.1);box-shadow:var(--shadowMid)}.theme-toggle-btn[_ngcontent-%COMP%]:active{transform:scale(.95)}.theme-icon[_ngcontent-%COMP%]{width:20px;height:20px;object-fit:contain}.full-name[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:700;color:var(--title);text-align:right;margin:0 0 0 auto;text-shadow:var(--shadowStart);letter-spacing:2px;font-family:Courier New,Consolas,Monaco,Lucida Console,monospace;text-transform:uppercase}.portfolio-main[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:stretch;gap:1rem;flex:1;min-height:0;overflow:hidden;width:100%}.portfolio-column[_ngcontent-%COMP%]{background:transparent;border-radius:0;padding:1rem;box-shadow:none;border:none;display:flex;flex-direction:column;gap:1rem;transition:all .3s ease;max-height:100%;min-height:0;overflow:hidden;justify-content:space-between;flex:1;min-width:0}.portfolio-column[_ngcontent-%COMP%]:hover{box-shadow:none;transform:none}.column-header[_ngcontent-%COMP%]{border-bottom:2px solid var(--subtitle);padding-bottom:.5rem;margin-bottom:.75rem}.column-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:600;color:var(--title);margin:0;text-align:center}.projects-column[_ngcontent-%COMP%]{min-height:auto}.loading-message[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:var(--text);font-size:1rem;opacity:.7}.projects-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.6rem;flex:1;min-height:0;overflow-y:auto;justify-content:flex-start}.project-card[_ngcontent-%COMP%]{background:var(--cardBg);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:8px;padding:.6rem;cursor:pointer;transition:all .3s ease;border:1px solid var(--buttonBorder);width:90%;max-width:90%;margin:0 auto}.project-card[_ngcontent-%COMP%]:hover{background:var(--cardBgHover);border-color:var(--title);transform:translate(5px);box-shadow:var(--shadowStart)}.project-image[_ngcontent-%COMP%]{width:100%;height:90px;border-radius:6px;overflow:hidden;margin-bottom:.4rem}.project-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.project-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.95rem;font-weight:600;color:var(--title);margin:0 0 .2rem;line-height:1.3}.project-tool[_ngcontent-%COMP%]{font-size:.85rem;color:var(--subtitle);margin:0 0 .4rem;line-height:1.2}.project-state[_ngcontent-%COMP%]{display:inline-block;padding:.2rem .6rem;border-radius:10px;font-size:.75rem;background:var(--chipBg);-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);color:var(--text);border:1px solid var(--buttonBorder);font-weight:500}.project-state.active[_ngcontent-%COMP%]{background:#4caf50;color:#fff;border-color:#4caf50;box-shadow:0 2px 4px #4caf504d}.center-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;justify-content:space-between}.about-me-btn[_ngcontent-%COMP%]{background:var(--buttonBg);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:8px;padding:1rem;border:2px solid var(--buttonBorder);cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:space-between;width:100%;text-align:left;box-shadow:var(--shadowStart)}.about-me-btn[_ngcontent-%COMP%]:hover{background:var(--buttonBgHover);transform:translateY(-2px);box-shadow:var(--shadowMid);border-color:var(--title)}.about-me-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}.about-me-btn[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:var(--title);margin:0;flex:1}.btn-icon[_ngcontent-%COMP%]{font-size:1.5rem;color:var(--title);transition:transform .3s ease}.about-me-btn[_ngcontent-%COMP%]:hover   .btn-icon[_ngcontent-%COMP%]{transform:translate(5px)}.profile-image-container[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;min-height:0;max-height:100%;background:transparent;border-radius:0;padding:0;border:none;overflow:hidden}.profile-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;width:100%;height:100%;object-fit:contain;border-radius:0;box-shadow:none;transition:none}.profile-image[_ngcontent-%COMP%]:hover{transform:none}.skills-column[_ngcontent-%COMP%]{min-height:auto}.skills-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;flex:1;min-height:0;overflow-y:auto;justify-content:space-between}.skill-group[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:var(--title);margin:0 0 .75rem;text-align:center;border-bottom:1px solid var(--subtitle);padding-bottom:.5rem}.skills-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;justify-content:center}.skill-chip[_ngcontent-%COMP%]{display:inline-block;padding:.4rem .8rem;background:var(--chipBg);-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);color:var(--text);border-radius:16px;font-size:.85rem;border:1px solid var(--buttonBorder);transition:all .3s ease;font-weight:500}.skill-chip[_ngcontent-%COMP%]:hover{background:var(--chipBgHover);border-color:var(--title);transform:translateY(-2px);box-shadow:var(--shadowStart)}.skill-item-object[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.4rem .8rem;background:var(--chipBg);-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);color:var(--text);border-radius:16px;font-size:.85rem;border:1px solid var(--buttonBorder);transition:all .3s ease;font-weight:500}.skill-item-object[_ngcontent-%COMP%]:hover{background:var(--chipBgHover);border-color:var(--title);transform:translateY(-2px);box-shadow:var(--shadowStart)}.skill-item-object[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--text)}.skill-icon[_ngcontent-%COMP%]{width:20px;height:20px;object-fit:contain;flex-shrink:0}@media (max-width: 1024px){.portfolio-container[_ngcontent-%COMP%]{height:100vh;overflow-y:auto;padding:1rem}.portfolio-main[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;min-height:auto;align-items:stretch}.portfolio-column[_ngcontent-%COMP%]{min-height:auto;max-height:none;justify-content:flex-start;flex:1 1 auto}.full-name[_ngcontent-%COMP%]{font-size:1.5rem}.theme-toggle-btn[_ngcontent-%COMP%]{width:45px;height:45px}.projects-list[_ngcontent-%COMP%], .skills-content[_ngcontent-%COMP%]{overflow-y:visible;max-height:none}}@media (max-width: 768px){.portfolio-container[_ngcontent-%COMP%]{padding:.75rem;gap:1rem;height:100vh;overflow-y:auto}.portfolio-header[_ngcontent-%COMP%]{padding:.75rem 0;flex-shrink:0}.portfolio-main[_ngcontent-%COMP%]{min-height:auto}.full-name[_ngcontent-%COMP%]{font-size:1.25rem;padding-left:50px}.theme-toggle-btn[_ngcontent-%COMP%]{width:40px;height:40px;left:.5rem}.theme-icon[_ngcontent-%COMP%]{width:20px;height:20px}.portfolio-column[_ngcontent-%COMP%]{padding:.75rem;border-radius:12px;max-height:none;justify-content:flex-start}.column-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.1rem}.project-image[_ngcontent-%COMP%]{height:100px}.profile-image-container[_ngcontent-%COMP%]{min-height:200px;max-height:300px}.projects-list[_ngcontent-%COMP%], .skills-content[_ngcontent-%COMP%]{overflow-y:visible;max-height:none}}@media (max-width: 480px){.portfolio-container[_ngcontent-%COMP%]{padding:.5rem;gap:.75rem}.portfolio-header[_ngcontent-%COMP%]{padding:.5rem 0}.full-name[_ngcontent-%COMP%]{font-size:1rem;padding-left:45px}.theme-toggle-btn[_ngcontent-%COMP%]{width:35px;height:35px;left:.25rem}.theme-icon[_ngcontent-%COMP%]{width:18px;height:18px}.portfolio-column[_ngcontent-%COMP%]{padding:.75rem;gap:.75rem}.column-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1rem}.about-me-btn[_ngcontent-%COMP%]{padding:.75rem}.about-me-btn[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1rem}.project-image[_ngcontent-%COMP%]{height:80px}.profile-image-container[_ngcontent-%COMP%]{min-height:150px;max-height:250px;padding:.5rem}.skills-list[_ngcontent-%COMP%]{gap:.5rem}.skill-chip[_ngcontent-%COMP%]{font-size:.8rem;padding:.4rem .8rem}}.language-toggle-btn[_ngcontent-%COMP%]{position:fixed;bottom:1.5rem;right:1.5rem;width:50px;height:50px;border-radius:50%;border:2px solid var(--buttonBorder);background:var(--buttonBg);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s ease;box-shadow:var(--shadowMid);z-index:100}.language-toggle-btn[_ngcontent-%COMP%]:hover{background:var(--buttonBgHover);border-color:var(--title);transform:scale(1.1);box-shadow:var(--shadowEnd)}.language-toggle-btn[_ngcontent-%COMP%]:active{transform:scale(.95)}.language-code[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:var(--title);font-family:Courier New,Consolas,Monaco,Lucida Console,monospace;letter-spacing:1px}.projects-list[_ngcontent-%COMP%]::-webkit-scrollbar, .skills-content[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.projects-list[_ngcontent-%COMP%]::-webkit-scrollbar-track, .skills-content[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:var(--bgColor);border-radius:3px}.projects-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .skills-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--subtitle);border-radius:3px}.projects-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .skills-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:var(--title)}@media (max-width: 768px){.language-toggle-btn[_ngcontent-%COMP%]{width:45px;height:45px;bottom:1rem;right:1rem}.language-code[_ngcontent-%COMP%]{font-size:.9rem}}@media (max-width: 480px){.language-toggle-btn[_ngcontent-%COMP%]{width:40px;height:40px;bottom:.75rem;right:.75rem}.language-code[_ngcontent-%COMP%]{font-size:.85rem}}"]})};export{al as PortfolioComponent};
