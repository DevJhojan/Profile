<div class="portfolio-container">
  <!-- Header -->
  <header class="portfolio-header">
    <button
      class="theme-toggle-btn"
      (click)="toggleTheme()"
      [attr.aria-label]="t().changeThemeToLight"
      [title]="t().changeTheme">
      <img
        [src]="currentTheme === 'dark' ? 'assets/img/Cambio_tema/sun.png' : 'assets/img/Cambio_tema/moon.png'"
        [alt]="currentTheme === 'dark' ? t().changeThemeToLight : t().changeThemeToDark"
        class="theme-icon">
    </button>
    <div class="name-section">
    @if (cvUrl()) {
      <a [href]="cvUrl()" target="_blank" class="cv-download-btn" title="Descargar curriculum">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
          <polyline points="7 10 12 15 17 10"></polyline>
          <line x1="12" y1="15" x2="12" y2="3"></line>
        </svg>
        <span class="cv-tooltip">Descargar curriculum</span>
      </a>
    }
      <h1 class="full-name">{{ fullName }}</h1>
      @if (contactInfo().length > 0) {
        <div class="contact-section">
          @for (contact of contactInfo(); track contact.url) {
            <a [href]="contact.url" target="_blank" rel="noopener noreferrer" class="contact-btn" [title]="contact.name">
              @if (contact.icon) {
                <img [src]="contact.icon" [alt]="contact.name" class="contact-icon">
              }
              <span>{{ contact.name }}</span>
            </a>
          }
        </div>
      }
    </div>
  </header>

  <!-- Sección Principal - 3 Columnas -->
  <main class="portfolio-main">
    <!-- Columna Central - Información Personal (Primera en móvil) -->
    <section class="portfolio-column center-column mobile-first">
      <!-- Botón "Más sobre mí" -->
      <button class="about-me-btn" (click)="openModal()">
        <h2>{{ t().aboutMe }}</h2>
        <span class="btn-icon">→</span>
      </button>

      <!-- Imagen de Perfil -->
      <div class="profile-image-container">
        <img
          [src]="profileImage"
          alt="Jhojan Danilo Toro Perez"
          class="profile-image"
          loading="lazy">
      </div>
    </section>

    <!-- Columna Izquierda - Proyectos -->
    <section class="portfolio-column projects-column" [class.mobile-visible]="showProjects()">
      <div class="column-header">
        <h2>{{ t().projects }}</h2>
        <a routerLink="/politica-y-privacidad" class="privacy-link">Política de Privacidad</a>
        <div class="header-actions">
          <div class="sort-dropdown">
            <button class="sort-btn" (click)="toggleSortMenu()" title="Ordenar proyectos">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M3 6h18M7 12h10M11 18h2"/>
              </svg>
            </button>
            @if (showSortMenu()) {
              <div class="sort-menu">
                <button class="sort-option" [class.active]="projectSortOrder() === 'default'" (click)="setSortOrder('default')">
                  Por defecto
                </button>
                <button class="sort-option" [class.active]="projectSortOrder() === 'name-asc'" (click)="setSortOrder('name-asc')">
                  Nombre A-Z
                </button>
                <button class="sort-option" [class.active]="projectSortOrder() === 'name-desc'" (click)="setSortOrder('name-desc')">
                  Nombre Z-A
                </button>
                <button class="sort-option" [class.active]="projectSortOrder() === 'state-asc'" (click)="setSortOrder('state-asc')">
                  Estado A-Z
                </button>
                <button class="sort-option" [class.active]="projectSortOrder() === 'state-desc'" (click)="setSortOrder('state-desc')">
                  Estado Z-A
                </button>
                <button class="sort-option" [class.active]="projectSortOrder() === 'recent-first'" (click)="setSortOrder('recent-first')">
                  Más reciente primero
                </button>
                <button class="sort-option" [class.active]="projectSortOrder() === 'oldest-first'" (click)="setSortOrder('oldest-first')">
                  Más antiguo primero
                </button>
              </div>
            }
          </div>
        </div>
      </div>
      <div class="projects-list">
        @if (isLoading()) {
          <div class="loading-message">Cargando proyectos...</div>
        } @else {
          @for (project of sortedProjects(); track project.name) {
            <div class="project-card" (click)="openProject(project.url)">
              <div class="project-image">
                <img [src]="project.img" [alt]="project.name" loading="lazy">
              </div>
              <div class="project-info">
                <h3>{{ project.name }}</h3>
                <p class="project-tool">{{ project.tool }}</p>
                <span class="project-state" [class.active]="project.state.toLowerCase() === 'active' || project.state.toLowerCase() === 'activo'">
                  {{ project.state }}
                </span>
              </div>
            </div>
          }
        }
      </div>
    </section>

    <!-- Columna Derecha - Habilidades -->
    <section class="portfolio-column skills-column" [class.mobile-visible]="showSkills()">
      <div class="column-header">
        <h2>{{ t().hardAndSoftSkills }}</h2>
      </div>
      <div class="skills-content">
        @for (skillGroup of translatedSkills(); track skillGroup.h2) {
          <div class="skill-group">
            <h3>{{ skillGroup.h2 }}</h3>
            <div class="skills-list">
              @if (skillGroup.items) {
                @for (skill of skillGroup.items; track skill) {
                  <span class="skill-chip">{{ skill }}</span>
                }
              }
              @if (skillGroup.itemsObject) {
                @for (skillObj of skillGroup.itemsObject; track skillObj.name) {
                  <div class="skill-item-object">
                    @if (skillObj.img) {
                      <img [src]="skillObj.img" [alt]="skillObj.name" class="skill-icon">
                    }
                    <span>{{ skillObj.name }}</span>
                  </div>
                }
              }
            </div>
          </div>
        }
      </div>
    </section>
  </main>

  <!-- Modal "Más sobre mí" -->
  <app-modal
    [isOpen]="isModalOpen"
    [title]="t().modalTitle"
    [contents]="translatedContents()"
    (close)="closeModal()">
  </app-modal>

  <!-- Botón de cambio de idioma -->
  <button
    class="language-toggle-btn"
    (click)="toggleLanguage()"
    [attr.aria-label]="currentLanguage === 'es' ? 'Change to English' : 'Cambiar a Español'"
    [title]="currentLanguage === 'es' ? 'EN' : 'ES'">
    <span class="language-code">{{ currentLanguage === 'es' ? 'EN' : 'ES' }}</span>
  </button>

  <!-- Botones de navegación móvil -->
  <div class="mobile-navigation-buttons">
    <button class="mobile-nav-btn" (click)="toggleProjects()" [class.active]="showProjects()">
      <span>{{ t().projects }}</span>
    </button>
    <button class="mobile-nav-btn" (click)="toggleSkills()" [class.active]="showSkills()">
      <span>{{ t().hardAndSoftSkills }}</span>
    </button>
  </div>
</div>

