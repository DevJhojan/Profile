import{$a as Kt,Da as qn,Ea as _e,Fa as ye,Ga as os,Ha as ve,Ia as Ce,Ja as le,Ka as E,L as ge,La as P,Ma as Ge,Na as q,O as ts,Oa as ce,P as ht,Pa as Gt,Qa as qe,Ra as qt,Sa as Q,Ta as as,U as ze,Ua as A,V as Ve,Va as D,W as ns,Wa as ls,X as is,_a as Yt,a as k,b as U,c as g,ca as K,ea as rs,hb as Qt,ma as $e,na as b,ra as ss,xa as $t}from"./chunk-SVLBNVCY.js";var Jt=class n{THEME_KEY="portfolio-theme";darkWallpaper="assets/img/Wallparpers/wallpaper-dark.jpg";lightWallpaper="assets/img/Wallparpers/wallpaper-light.jpg";currentTheme=K(this.getInitialTheme());currentWallpaper=K(this.getWallpaperForTheme(this.currentTheme()));constructor(){let e=this.currentTheme();this.applyTheme(e),Kt(()=>{let t=this.currentTheme();this.currentWallpaper.set(this.getWallpaperForTheme(t)),this.applyTheme(t)})}getInitialTheme(){let e=localStorage.getItem(this.THEME_KEY);return e==="light"||e==="dark"?e:"dark"}getWallpaperForTheme(e){return e==="dark"?this.darkWallpaper:this.lightWallpaper}toggleTheme(){let e=this.currentTheme()==="dark"?"light":"dark";this.currentTheme.set(e),localStorage.setItem(this.THEME_KEY,e)}applyTheme(e){let t=document.documentElement,i=document.body;e==="light"?(t.classList.add("lightTheme"),t.classList.remove("darkTheme")):(t.classList.remove("lightTheme"),t.classList.add("darkTheme"));let r=this.getWallpaperForTheme(e);i.style.backgroundImage=`url(${r})`,i.style.backgroundSize="cover",i.style.backgroundPosition="center",i.style.backgroundAttachment="fixed"}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ge({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ye=class n{LANGUAGE_KEY="portfolio-language";currentLanguage=K(this.getInitialLanguage());translations={es:{changeTheme:"Cambiar tema",changeThemeToLight:"Cambiar a tema claro",changeThemeToDark:"Cambiar a tema oscuro",projects:"Proyectos",aboutMe:"M\xE1s sobre m\xED",hardAndSoftSkills:"Habilidades duras y blandas",active:"Activo",tooling:"Herramientas",softSkills:"Habilidades blandas",hardSkills:"Duras",skills:"Habilidades",modalTitle:"M\xE1s sobre m\xED",training:"Formaci\xF3n",experience:"Experiencia",referred:"Referencias",activeState:"Activo",pending:"Pendiente",completed:"Finalizado"},en:{changeTheme:"Change theme",changeThemeToLight:"Change to light theme",changeThemeToDark:"Change to dark theme",projects:"Projects",aboutMe:"More about me",hardAndSoftSkills:"Hard and soft skills",active:"Active",tooling:"Tooling",softSkills:"Soft Skills",hardSkills:"Hard",skills:"Skills",modalTitle:"More about me",training:"Training",experience:"Experience",referred:"Referred",activeState:"Active",pending:"Pending",completed:"Completed"}};constructor(){Kt(()=>{let e=this.currentLanguage();localStorage.setItem(this.LANGUAGE_KEY,e)})}getInitialLanguage(){let e=localStorage.getItem(this.LANGUAGE_KEY);return e==="es"||e==="en"?e:navigator.language.split("-")[0]==="es"?"es":"en"}toggleLanguage(){let e=this.currentLanguage()==="es"?"en":"es";this.currentLanguage.set(e)}getTranslations(){return this.translations[this.currentLanguage()]}getTranslation(e){return this.translations[this.currentLanguage()][e]}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ge({token:n,factory:n.\u0275fac,providedIn:"root"})};var cs=()=>{};var Yn={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var f=function(n,e){if(!n)throw Ae(e)},Ae=function(n){return new Error("Firebase Database ("+Yn.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};var hs=function(n){let e=[],t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},pl=function(n){let e=[],t=0,i=0;for(;t<n.length;){let r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){let s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){let s=n[t++],o=n[t++],a=n[t++],l=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{let s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},en={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){let s=n[r],o=r+1<n.length,a=o?n[r+1]:0,l=r+2<n.length,c=l?n[r+2]:0,h=s>>2,u=(s&3)<<4|a>>4,d=(a&15)<<2|c>>6,p=c&63;l||(p=64,o||(d=64)),i.push(t[h],t[u],t[d],t[p])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(hs(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):pl(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){let s=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;let c=r<n.length?t[n.charAt(r)]:64;++r;let u=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||a==null||c==null||u==null)throw new Kn;let d=s<<2|a>>4;if(i.push(d),c!==64){let p=a<<4&240|c>>2;if(i.push(p),u!==64){let m=c<<6&192|u;i.push(m)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Kn=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},Qn=function(n){let e=hs(n);return en.encodeByteArray(e,!0)},mt=function(n){return Qn(n).replace(/\./g,"")},Xt=function(n){try{return en.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function fs(n){return ps(void 0,n)}function ps(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(let t in e)!e.hasOwnProperty(t)||!ml(t)||(n[t]=ps(n[t],e[t]));return n}function ml(n){return n!=="__proto__"}function gl(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var _l=()=>gl().__FIREBASE_DEFAULTS__,yl=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},vl=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Xt(n[1]);return e&&JSON.parse(e)},ms=()=>{try{return cs()||_l()||yl()||vl()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Cl=n=>ms()?.emulatorHosts?.[n],gs=n=>{let e=Cl(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Jn=()=>ms()?.config;var Pe=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}};function tn(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}function _s(n){return g(this,null,function*(){return(yield fetch(n,{credentials:"include"})).ok})}function ys(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=k({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[mt(JSON.stringify(t)),mt(JSON.stringify(o)),""].join(".")}var pt={};function bl(){let n={prod:[],emulator:[]};for(let e of Object.keys(pt))pt[e]?n.emulator.push(e):n.prod.push(e);return n}function wl(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var ds=!1;function vs(n,e){if(typeof window>"u"||typeof document>"u"||!tn(window.location.host)||pt[n]===e||pt[n]||ds)return;pt[n]=e;function t(d){return`__firebase__banner__${d}`}let i="__firebase__banner",s=bl().prod.length>0;function o(){let d=document.getElementById(i);d&&d.remove()}function a(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="fixed",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function l(d,p){d.setAttribute("width","24"),d.setAttribute("id",p),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function c(){let d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{ds=!0,o()},d}function h(d,p){d.setAttribute("id",p),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function u(){let d=wl(i),p=t("text"),m=document.getElementById(p)||document.createElement("span"),T=t("learnmore"),O=document.getElementById(T)||document.createElement("a"),oe=t("preprendIcon"),ae=document.getElementById(oe)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){let ke=d.element;a(ke),h(O,T);let Gn=c();l(ae,oe),ke.append(ae,m,O,Gn),document.body.appendChild(ke)}s?(m.innerText="Preview backend disconnected.",ae.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ae.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,m.innerText="Preview backend running in this workspace."),m.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",u):u()}function El(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Xn(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(El())}function Cs(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function bs(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ne(){return Yn.NODE_CLIENT===!0||Yn.NODE_ADMIN===!0}function nn(){try{return typeof indexedDB=="object"}catch{return!1}}function rn(){return new Promise((n,e)=>{try{let t=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}function ws(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}var Il="FirebaseError",J=class n extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=Il,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,de.prototype.create)}},de=class{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){let i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?Tl(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new J(r,a,i)}};function Tl(n,e){return n.replace(Sl,(t,i)=>{let r=e[i];return r!=null?String(r):`<${i}?>`})}var Sl=/\{\$([^}]+)}/g;function Ke(n){return JSON.parse(n)}function R(n){return JSON.stringify(n)}var Es=function(n){let e={},t={},i={},r="";try{let s=n.split(".");e=Ke(Xt(s[0])||""),t=Ke(Xt(s[1])||""),r=s[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:r}};var Is=function(n){let e=Es(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},Ts=function(n){let e=Es(n).claims;return typeof e=="object"&&e.admin===!0};function ie(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Ne(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Zn(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function gt(n,e,t){let i={};for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=e.call(t,n[r],r,n));return i}function be(n,e){if(n===e)return!0;let t=Object.keys(n),i=Object.keys(e);for(let r of t){if(!i.includes(r))return!1;let s=n[r],o=e[r];if(us(s)&&us(o)){if(!be(s,o))return!1}else if(s!==o)return!1}for(let r of i)if(!t.includes(r))return!1;return!0}function us(n){return n!==null&&typeof n=="object"}function Ss(n){let e=[];for(let[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}var Zt=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);let i=this.W_;if(typeof e=="string")for(let u=0;u<16;u++)i[u]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let u=0;u<16;u++)i[u]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let u=16;u<80;u++){let d=i[u-3]^i[u-8]^i[u-14]^i[u-16];i[u]=(d<<1|d>>>31)&4294967295}let r=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,h;for(let u=0;u<80;u++){u<40?u<20?(c=a^s&(o^a),h=1518500249):(c=s^o^a,h=1859775393):u<60?(c=s&o|a&(s|o),h=2400959708):(c=s^o^a,h=3395469782);let d=(r<<5|r>>>27)+c+l+h+i[u]&4294967295;l=a,a=o,o=(s<<30|s>>>2)&4294967295,s=r,r=d}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);let i=t-this.blockSize,r=0,s=this.buf_,o=this.inbuf_;for(;r<t;){if(o===0)for(;r<=i;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<t;)if(s[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}else for(;r<t;)if(s[o]=e[r],++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){let e=[],t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=t&255,t/=256;this.compress_(this.buf_);let i=0;for(let r=0;r<5;r++)for(let s=24;s>=0;s-=8)e[i]=this.chain_[r]>>s&255,++i;return e}};function ei(n,e){return`${n} failed: ${e} argument `}var xs=function(n){let e=[],t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);if(r>=55296&&r<=56319){let s=r-55296;i++,f(i<n.length,"Surrogate pair missing trail surrogate.");let o=n.charCodeAt(i)-56320;r=65536+(s<<10)+o}r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):r<65536?(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},_t=function(n){let e=0;for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};var xl=1e3,kl=2,Pl=14400*1e3,Al=.5;function ti(n,e=xl,t=kl){let i=e*Math.pow(t,n),r=Math.round(Al*i*(Math.random()-.5)*2);return Math.min(Pl,i+r)}function ue(n){return n&&n._delegate?n._delegate:n}var B=class{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Oe="[DEFAULT]";var sn=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let i=new Pe;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Ol(e))try{this.getOrInitializeService({instanceIdentifier:Oe})}catch{}for(let[t,i]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Oe){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return g(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Oe){return this.instances.has(e)}getOptions(e=Oe){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,t){let i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);let s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){let i=this.onInitCallbacks.get(t);if(i)for(let r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Nl(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Oe){return this.component?this.component.multipleInstances?e:Oe:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Nl(n){return n===Oe?void 0:n}function Ol(n){return n.instantiationMode==="EAGER"}var yt=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new sn(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var Rl=[],S=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(S||{}),Ml={debug:S.DEBUG,verbose:S.VERBOSE,info:S.INFO,warn:S.WARN,error:S.ERROR,silent:S.SILENT},Dl=S.INFO,Ll={[S.DEBUG]:"log",[S.VERBOSE]:"log",[S.INFO]:"info",[S.WARN]:"warn",[S.ERROR]:"error"},Fl=(n,e,...t)=>{if(e<n.logLevel)return;let i=new Date().toISOString(),r=Ll[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},we=class{constructor(e){this.name=e,this._logLevel=Dl,this._logHandler=Fl,this._userLogHandler=null,Rl.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in S))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Ml[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,S.DEBUG,...e),this._logHandler(this,S.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,S.VERBOSE,...e),this._logHandler(this,S.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,S.INFO,...e),this._logHandler(this,S.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,S.WARN,...e),this._logHandler(this,S.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,S.ERROR,...e),this._logHandler(this,S.ERROR,...e)}};var Bl=(n,e)=>e.some(t=>n instanceof t),ks,Ps;function Wl(){return ks||(ks=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ul(){return Ps||(Ps=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var As=new WeakMap,ii=new WeakMap,Ns=new WeakMap,ni=new WeakMap,si=new WeakMap;function jl(n){let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(re(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&As.set(t,n)}).catch(()=>{}),si.set(e,n),e}function Hl(n){if(ii.has(n))return;let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});ii.set(n,e)}var ri={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ii.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Ns.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return re(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Os(n){ri=n(ri)}function zl(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let i=n.call(on(this),e,...t);return Ns.set(i,e.sort?e.sort():[e]),re(i)}:Ul().includes(n)?function(...e){return n.apply(on(this),e),re(As.get(this))}:function(...e){return re(n.apply(on(this),e))}}function Vl(n){return typeof n=="function"?zl(n):(n instanceof IDBTransaction&&Hl(n),Bl(n,Wl())?new Proxy(n,ri):n)}function re(n){if(n instanceof IDBRequest)return jl(n);if(ni.has(n))return ni.get(n);let e=Vl(n);return e!==n&&(ni.set(n,e),si.set(e,n)),e}var on=n=>si.get(n);function an(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){let o=indexedDB.open(n,e),a=re(o);return i&&o.addEventListener("upgradeneeded",l=>{i(re(o.result),l.oldVersion,l.newVersion,re(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}var $l=["get","getKey","getAll","getAllKeys","count"],Gl=["put","add","delete","clear"],oi=new Map;function Rs(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(oi.get(e))return oi.get(e);let t=e.replace(/FromIndex$/,""),i=e!==t,r=Gl.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||$l.includes(t)))return;let s=function(o,...a){return g(this,null,function*(){let l=this.transaction(o,r?"readwrite":"readonly"),c=l.store;return i&&(c=c.index(a.shift())),(yield Promise.all([c[t](...a),r&&l.done]))[0]})};return oi.set(e,s),s}Os(n=>U(k({},n),{get:(e,t,i)=>Rs(e,t)||n.get(e,t,i),has:(e,t)=>!!Rs(e,t)||n.has(e,t)}));var li=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(ql(t)){let i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}};function ql(n){return n.getComponent()?.type==="VERSION"}var ci="@firebase/app",Ms="0.14.6";var he=new we("@firebase/app"),Yl="@firebase/app-compat",Kl="@firebase/analytics-compat",Ql="@firebase/analytics",Jl="@firebase/app-check-compat",Xl="@firebase/app-check",Zl="@firebase/auth",ec="@firebase/auth-compat",tc="@firebase/database",nc="@firebase/data-connect",ic="@firebase/database-compat",rc="@firebase/functions",sc="@firebase/functions-compat",oc="@firebase/installations",ac="@firebase/installations-compat",lc="@firebase/messaging",cc="@firebase/messaging-compat",dc="@firebase/performance",uc="@firebase/performance-compat",hc="@firebase/remote-config",fc="@firebase/remote-config-compat",pc="@firebase/storage",mc="@firebase/storage-compat",gc="@firebase/firestore",_c="@firebase/ai",yc="@firebase/firestore-compat",vc="firebase",Cc="12.6.0";var di="[DEFAULT]",bc={[ci]:"fire-core",[Yl]:"fire-core-compat",[Ql]:"fire-analytics",[Kl]:"fire-analytics-compat",[Xl]:"fire-app-check",[Jl]:"fire-app-check-compat",[Zl]:"fire-auth",[ec]:"fire-auth-compat",[tc]:"fire-rtdb",[nc]:"fire-data-connect",[ic]:"fire-rtdb-compat",[rc]:"fire-fn",[sc]:"fire-fn-compat",[oc]:"fire-iid",[ac]:"fire-iid-compat",[lc]:"fire-fcm",[cc]:"fire-fcm-compat",[dc]:"fire-perf",[uc]:"fire-perf-compat",[hc]:"fire-rc",[fc]:"fire-rc-compat",[pc]:"fire-gcs",[mc]:"fire-gcs-compat",[gc]:"fire-fst",[yc]:"fire-fst-compat",[_c]:"fire-vertex","fire-js":"fire-js",[vc]:"fire-js-all"};var ln=new Map,wc=new Map,ui=new Map;function Ds(n,e){try{n.container.addComponent(e)}catch(t){he.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function X(n){let e=n.name;if(ui.has(e))return he.debug(`There were multiple attempts to register component ${e}.`),!1;ui.set(e,n);for(let t of ln.values())Ds(t,n);for(let t of wc.values())Ds(t,n);return!0}function Ie(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ws(n){return n==null?!1:n.settings!==void 0}var Ec={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ee=new de("app","Firebase",Ec);var hi=class{constructor(e,t,i){this._isDeleted=!1,this._options=k({},e),this._config=k({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new B("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ee.create("app-deleted",{appName:this._name})}};var Us=Cc;function mi(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let i=k({name:di,automaticDataCollectionEnabled:!0},e),r=i.name;if(typeof r!="string"||!r)throw Ee.create("bad-app-name",{appName:String(r)});if(t||(t=Jn()),!t)throw Ee.create("no-options");let s=ln.get(r);if(s){if(be(t,s.options)&&be(i,s.config))return s;throw Ee.create("duplicate-app",{appName:r})}let o=new yt(r);for(let l of ui.values())o.addComponent(l);let a=new hi(t,i,o);return ln.set(r,a),a}function Ct(n=di){let e=ln.get(n);if(!e&&n===di&&Jn())return mi();if(!e)throw Ee.create("no-app",{appName:n});return e}function j(n,e,t){let i=bc[n]??n;t&&(i+=`-${t}`);let r=i.match(/\s|\//),s=e.match(/\s|\//);if(r||s){let o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),he.warn(o.join(" "));return}X(new B(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var Ic="firebase-heartbeat-database",Tc=1,vt="firebase-heartbeat-store",ai=null;function js(){return ai||(ai=an(Ic,Tc,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(vt)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ee.create("idb-open",{originalErrorMessage:n.message})})),ai}function Sc(n){return g(this,null,function*(){try{let t=(yield js()).transaction(vt),i=yield t.objectStore(vt).get(Hs(n));return yield t.done,i}catch(e){if(e instanceof J)he.warn(e.message);else{let t=Ee.create("idb-get",{originalErrorMessage:e?.message});he.warn(t.message)}}})}function Ls(n,e){return g(this,null,function*(){try{let i=(yield js()).transaction(vt,"readwrite");yield i.objectStore(vt).put(e,Hs(n)),yield i.done}catch(t){if(t instanceof J)he.warn(t.message);else{let i=Ee.create("idb-set",{originalErrorMessage:t?.message});he.warn(i.message)}}})}function Hs(n){return`${n.name}!${n.options.appId}`}var xc=1024,kc=30,fi=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new pi(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}triggerHeartbeat(){return g(this,null,function*(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Fs();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>kc){let r=Ac(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){he.warn(e)}})}getHeartbeatsHeader(){return g(this,null,function*(){try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=Fs(),{heartbeatsToSend:t,unsentEntries:i}=Pc(this._heartbeatsCache.heartbeats),r=mt(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return he.warn(e),""}})}};function Fs(){return new Date().toISOString().substring(0,10)}function Pc(n,e=xc){let t=[],i=n.slice();for(let r of n){let s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),Bs(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),Bs(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}var pi=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return g(this,null,function*(){return nn()?rn().then(()=>!0).catch(()=>!1):!1})}read(){return g(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield Sc(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return g(this,null,function*(){if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Ls(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return g(this,null,function*(){if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Ls(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function Bs(n){return mt(JSON.stringify({version:2,heartbeats:n})).length}function Ac(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function Nc(n){X(new B("platform-logger",e=>new li(e),"PRIVATE")),X(new B("heartbeat",e=>new fi(e),"PRIVATE")),j(ci,Ms,n),j(ci,Ms,"esm2020"),j("fire-js","")}Nc("");var zs="@firebase/database",Vs="1.1.0";var Cr="";function Oc(n){Cr=n}var Ei=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),R(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Ke(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var Ii=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return ie(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var Io=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Ei(e)}}catch{}return new Ii},Me=Io("localStorage"),Ti=Io("sessionStorage");var Ze=new we("@firebase/database"),Rc=(function(){let n=1;return function(){return n++}})(),To=function(n){let e=xs(n),t=new Zt;t.update(e);let i=t.digest();return en.encodeByteArray(i)},Lt=function(...n){let e="";for(let t=0;t<n.length;t++){let i=n[t];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=Lt.apply(null,i):typeof i=="object"?e+=R(i):e+=i,e+=" "}return e},De=null,$s=!0,Mc=function(n,e){f(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Ze.logLevel=S.VERBOSE,De=Ze.log.bind(Ze),e&&Ti.set("logging_enabled",!0)):typeof n=="function"?De=n:(De=null,Ti.remove("logging_enabled"))},L=function(...n){if($s===!0&&($s=!1,De===null&&Ti.get("logging_enabled")===!0&&Mc(!0)),De){let e=Lt.apply(null,n);De(e)}},Ft=function(n){return function(...e){L(n,...e)}},Si=function(...n){let e="FIREBASE INTERNAL ERROR: "+Lt(...n);Ze.error(e)},fe=function(...n){let e=`FIREBASE FATAL ERROR: ${Lt(...n)}`;throw Ze.error(e),new Error(e)},$=function(...n){let e="FIREBASE WARNING: "+Lt(...n);Ze.warn(e)},Dc=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&$("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},So=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},Lc=function(n){if(ne()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},nt="[MIN_NAME]",Le="[MAX_NAME]",ct=function(n,e){if(n===e)return 0;if(n===nt||e===Le)return-1;if(e===nt||n===Le)return 1;{let t=Gs(n),i=Gs(e);return t!==null?i!==null?t-i===0?n.length-e.length:t-i:-1:i!==null?1:n<e?-1:1}},Fc=function(n,e){return n===e?0:n<e?-1:1},bt=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+R(e))},br=function(n){if(typeof n!="object"||n===null)return R(n);let e=[];for(let i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)i!==0&&(t+=","),t+=R(e[i]),t+=":",t+=br(n[e[i]]);return t+="}",t},xo=function(n,e){let t=n.length;if(t<=e)return[n];let i=[];for(let r=0;r<t;r+=e)r+e>t?i.push(n.substring(r,t)):i.push(n.substring(r,r+e));return i};function z(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var ko=function(n){f(!So(n),"Invalid JSON number");let e=11,t=52,i=(1<<e-1)-1,r,s,o,a,l;n===0?(s=0,o=0,r=1/n===-1/0?1:0):(r=n<0,n=Math.abs(n),n>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),i),s=a+i,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-i-t))));let c=[];for(l=t;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(r?1:0),c.reverse();let h=c.join(""),u="";for(l=0;l<64;l+=8){let d=parseInt(h.substr(l,8),2).toString(16);d.length===1&&(d="0"+d),u=u+d}return u.toLowerCase()},Bc=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Wc=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function Uc(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");let i=new Error(n+" at "+e._path.toString()+": "+t);return i.code=n.toUpperCase(),i}var jc=new RegExp("^-?(0*)\\d{1,10}$"),Hc=-2147483648,zc=2147483647,Gs=function(n){if(jc.test(n)){let e=Number(n);if(e>=Hc&&e<=zc)return e}return null},Bt=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw $("Exception was thrown by user callback.",t),e},Math.floor(0))}},Vc=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},St=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var xi=class{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,Ws(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(i=>this.appCheck=i)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.appCheckProvider?.get().then(t=>t.addTokenListener(e))}notifyForInvalidToken(){$(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}};var ki=class{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(L("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',$(e)}},xt=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),dn="5",Po="v",Ao="s",No="r",Oo="f",Ro=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Mo="ls",Do="p",Pi="ac",Lo="websocket",Fo="long_polling";var un=class{constructor(e,t,i,r,s=!1,o="",a=!1,l=!1,c=null){this.secure=t,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this.emulatorOptions=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Me.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Me.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function $c(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function Bo(n,e,t){f(typeof e=="string","typeof type must == string"),f(typeof t=="object","typeof params must == object");let i;if(e===Lo)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===Fo)i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);$c(n)&&(t.ns=n.namespace);let r=[];return z(t,(s,o)=>{r.push(s+"="+o)}),i+r.join("&")}var Ai=class{constructor(){this.counters_={}}incrementCounter(e,t=1){ie(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return fs(this.counters_)}};var gi={},_i={};function wr(n){let e=n.toString();return gi[e]||(gi[e]=new Ai),gi[e]}function Gc(n,e){let t=n.toString();return _i[t]||(_i[t]=e()),_i[t]}var Ni=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&Bt(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var qs="start",qc="close",Yc="pLPCommand",Kc="pRTLPCB",Wo="id",Uo="pw",jo="ser",Qc="cb",Jc="seg",Xc="ts",Zc="d",ed="dframe",Ho=1870,zo=30,td=Ho-zo,nd=25e3,id=3e4,Oi=class n{constructor(e,t,i,r,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Ft(e),this.stats_=wr(t),this.urlFn=l=>(this.appCheckToken&&(l[Pi]=this.appCheckToken),Bo(t,Fo,l))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Ni(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(id)),Lc(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Ri((...s)=>{let[o,a,l,c,h]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===qs)this.id=a,this.password=l;else if(o===qc)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let i={};i[qs]="t",i[jo]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[Qc]=this.scriptTagHolder.uniqueCallbackIdentifier),i[Po]=dn,this.transportSessionId&&(i[Ao]=this.transportSessionId),this.lastSessionId&&(i[Mo]=this.lastSessionId),this.applicationId&&(i[Do]=this.applicationId),this.appCheckToken&&(i[Pi]=this.appCheckToken),typeof location<"u"&&location.hostname&&Ro.test(location.hostname)&&(i[No]=Oo);let r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return ne()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Bc()&&!Wc()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=R(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let i=Qn(t),r=xo(i,td);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(ne())return;this.myDisconnFrame=document.createElement("iframe");let i={};i[ed]="t",i[Wo]=e,i[Uo]=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=R(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},Ri=class n{constructor(e,t,i,r){if(this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,ne())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=Rc(),window[Yc+this.uniqueCallbackIdentifier]=e,window[Kc+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){L("frame writing exception"),a.stack&&L(a.stack),L(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||L("No IE domain setting required")}catch{let i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[Wo]=this.myID,e[Uo]=this.myPW,e[jo]=this.currentSerial;let t=this.urlFn(e),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+zo+i.length<=Ho;){let o=this.pendingSegs.shift();i=i+"&"+Jc+r+"="+o.seg+"&"+Xc+r+"="+o.ts+"&"+Zc+r+"="+o.d,r++}return t=t+i,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(i,Math.floor(nd)),s=()=>{clearTimeout(r),i()};this.addTag(e,s)}addTag(e,t){ne()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){let r=i.readyState;(!r||r==="loaded"||r==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{L("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}};var rd=16384,sd=45e3,hn=null;typeof MozWebSocket<"u"?hn=MozWebSocket:typeof WebSocket<"u"&&(hn=WebSocket);var wt=(()=>{class n{constructor(t,i,r,s,o,a,l){this.connId=t,this.applicationId=r,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Ft(this.connId),this.stats_=wr(i),this.connURL=n.connectionURL_(i,a,l,s,r),this.nodeAdmin=i.nodeAdmin}static connectionURL_(t,i,r,s,o){let a={};return a[Po]=dn,!ne()&&typeof location<"u"&&location.hostname&&Ro.test(location.hostname)&&(a[No]=Oo),i&&(a[Ao]=i),r&&(a[Mo]=r),s&&(a[Pi]=s),o&&(a[Do]=o),Bo(t,Lo,a)}open(t,i){this.onDisconnect=i,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Me.set("previous_websocket_failure",!0);try{let r;if(ne()){let s=this.nodeAdmin?"AdminNode":"Node";r={headers:{"User-Agent":`Firebase/${dn}/${Cr}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(r.proxy={origin:a})}this.mySock=new hn(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");let s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");let s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let i=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(i);r&&r.length>1&&parseFloat(r[1])<4.4&&(t=!0)}return!t&&hn!==null&&!n.forceDisallow_}static previouslyFailed(){return Me.isInMemoryStorage||Me.get("previous_websocket_failure")===!0}markConnectionHealthy(){Me.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let i=this.frames.join("");this.frames=null;let r=Ke(i);this.onMessage(r)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(f(this.frames===null,"We already have a frame buffer"),t.length<=6){let i=Number(t);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let i=t.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(i);else{let r=this.extractFrameCount_(i);r!==null&&this.appendFrame_(r)}}send(t){this.resetKeepAlive();let i=R(t);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);let r=xo(i,rd);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(sd))}sendString_(t){try{this.mySock.send(t)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),od=(()=>{class n{static get ALL_TRANSPORTS(){return[Oi,wt]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){let i=wt&&wt.isAvailable(),r=i&&!wt.previouslyFailed();if(t.webSocketOnly&&(i||$("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[wt];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),ad=6e4,ld=5e3,cd=10*1024,dd=100*1024,yi="t",Ys="d",ud="s",Ks="r",hd="e",Qs="o",Js="a",Xs="n",Zs="p",fd="h",Mi=class{constructor(e,t,i,r,s,o,a,l,c,h){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Ft("c:"+this.id+":"),this.transportManager_=new od(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));let r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=St(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>dd?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>cd?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(yi in e){let t=e[yi];t===Js?this.upgradeIfSecondaryHealthy_():t===Ks?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===Qs&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=bt("t",e),i=bt("d",e);if(t==="c")this.onSecondaryControl_(i);else if(t==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Zs,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Js,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Xs,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=bt("t",e),i=bt("d",e);t==="c"?this.onControl_(i):t==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=bt(yi,e);if(Ys in e){let i=e[Ys];if(t===fd){let r=k({},i);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(t===Xs){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===ud?this.onConnectionShutdown_(i):t===Ks?this.onReset_(i):t===hd?Si("Server Error: "+i):t===Qs?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Si("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,i=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),dn!==i&&$("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),St(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(ad))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):St(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(ld))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Zs,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Me.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var fn=class{put(e,t,i,r){}merge(e,t,i,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}};var pn=class{constructor(e){this.allowedEvents_=e,this.listeners_={},f(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let i=[...this.listeners_[e]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});let r=this.getInitialEvent(e);r&&t.apply(i,r)}off(e,t,i){this.validateEventType_(e);let r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===t&&(!i||i===r[s].context)){r.splice(s,1);return}}validateEventType_(e){f(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var mn=class n extends pn{static getInstance(){return new n}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Xn()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return f(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var eo=32,to=768,I=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function w(){return new I("")}function v(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Se(n){return n.pieces_.length-n.pieceNum_}function x(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new I(n.pieces_,e)}function Vo(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function pd(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function $o(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function Go(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new I(e,0)}function M(n,e){let t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof I)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{let i=e.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&t.push(i[r])}return new I(t,0)}function C(n){return n.pieceNum_>=n.pieces_.length}function H(n,e){let t=v(n),i=v(e);if(t===null)return e;if(t===i)return H(x(n),x(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function Er(n,e){if(Se(n)!==Se(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function ee(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(Se(n)>Se(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}var Di=class{constructor(e,t){this.errorPrefix_=t,this.parts_=$o(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=_t(this.parts_[i]);qo(this)}};function md(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=_t(e),qo(n)}function gd(n){let e=n.parts_.pop();n.byteLength_-=_t(e),n.parts_.length>0&&(n.byteLength_-=1)}function qo(n){if(n.byteLength_>to)throw new Error(n.errorPrefix_+"has a key path longer than "+to+" bytes ("+n.byteLength_+").");if(n.parts_.length>eo)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+eo+") or object contains a cycle "+Re(n))}function Re(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var Li=class n extends pn{static getInstance(){return new n}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}getInitialEvent(e){return f(e==="visible","Unknown event type: "+e),[this.visible_]}};var Et=1e3,_d=300*1e3,no=30*1e3,yd=1.3,vd=3e4,Cd="server_kill",io=3,Ir=(()=>{class n extends fn{constructor(t,i,r,s,o,a,l,c){if(super(),this.repoInfo_=t,this.applicationId_=i,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=n.nextPersistentConnectionId_++,this.log_=Ft("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Et,this.maxReconnectDelay_=_d,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!ne())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Li.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&mn.getInstance().on("online",this.onOnline_,this)}sendRequest(t,i,r){let s=++this.requestNumber_,o={r:s,a:t,b:i};this.log_(R(o)),f(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),r&&(this.requestCBHash_[s]=r)}get(t){this.initConnection_();let i=new Pe,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let l=a.d;a.s==="ok"?i.resolve(l):i.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),i.promise}listen(t,i,r,s){this.initConnection_();let o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),f(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),f(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let l={onComplete:s,hashFn:i,query:t,tag:r};this.listens.get(a).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(t){let i=this.outstandingGets_[t];this.sendRequest("g",i.request,r=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(r)})}sendListen_(t){let i=t.query,r=i._path.toString(),s=i._queryIdentifier;this.log_("Listen on "+r+" for "+s);let o={p:r},a="q";t.tag&&(o.q=i._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(a,o,l=>{let c=l.d,h=l.s;n.warnOnListenWarnings_(c,i),(this.listens.get(r)&&this.listens.get(r).get(s))===t&&(this.log_("listen response",l),h!=="ok"&&this.removeListen_(r,s),t.onComplete&&t.onComplete(h,c))})}static warnOnListenWarnings_(t,i){if(t&&typeof t=="object"&&ie(t,"w")){let r=Ne(t,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){let s='".indexOn": "'+i._queryParams.getIndex().toString()+'"',o=i._path.toString();$(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||Ts(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=no)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,i=Is(t)?"auth":"gauth",r={cred:t};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(i,r,s=>{let o=s.s,a=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let i=t.s,r=t.d||"error";i==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,r)})}unlisten(t,i){let r=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),f(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,t._queryObject,i)}sendUnlisten_(t,i,r,s){this.log_("Unlisten on "+t+" for "+i);let o={p:t},a="n";s&&(o.q=r,o.t=s),this.sendRequest(a,o)}onDisconnectPut(t,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,i,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:i,onComplete:r})}onDisconnectMerge(t,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,i,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:i,onComplete:r})}onDisconnectCancel(t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(t,i,r,s){let o={p:i,d:r};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,i,r,s){this.putInternal("p",t,i,r,s)}merge(t,i,r,s){this.putInternal("m",t,i,r,s)}putInternal(t,i,r,s,o){this.initConnection_();let a={p:i,d:r};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++;let l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+i)}sendPut_(t){let i=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(i,r,o=>{this.log_(i+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let i={c:t};this.log_("reportStats",i),this.sendRequest("s",i,r=>{if(r.s!=="ok"){let o=r.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+R(t));let i=t.r,r=this.requestCBHash_[i];r&&(delete this.requestCBHash_[i],r(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,i){this.log_("handleServerMessage",t,i),t==="d"?this.onDataUpdate_(i.p,i.d,!1,i.t):t==="m"?this.onDataUpdate_(i.p,i.d,!0,i.t):t==="c"?this.onListenRevoked_(i.p,i.q):t==="ac"?this.onAuthRevoked_(i.s,i.d):t==="apc"?this.onAppCheckRevoked_(i.s,i.d):t==="sd"?this.onSecurityDebugPacket_(i):Si("Unrecognized action received from server: "+R(t)+`
Are you using the latest client?`)}onReady_(t,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){f(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Et,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Et,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>vd&&(this.reconnectDelay_=Et),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_),i=Math.max(0,this.reconnectDelay_-t);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*yd)}this.onConnectStatus_(!1)}establishConnection_(){return g(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),i=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,a=!1,l=null,c=function(){l?l.close():(a=!0,r())},h=function(d){f(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(d)};this.realtime_={close:c,sendRequest:h};let u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[d,p]=yield Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);a?L("getToken() completed but was canceled"):(L("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=p&&p.token,l=new Mi(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,i,r,m=>{$(m+" ("+this.repoInfo_.toString()+")"),this.interrupt(Cd)},o))}catch(d){this.log_("Failed to get token: "+d),a||(this.repoInfo_.nodeAdmin&&$(d),c())}}})}interrupt(t){L("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){L("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Zn(this.interruptReasons_)&&(this.reconnectDelay_=Et,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let i=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let i=this.outstandingPuts_[t];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,i){let r;i?r=i.map(o=>br(o)).join("$"):r="default";let s=this.removeListen_(t,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,i){let r=new I(t).toString(),s;if(this.listens.has(r)){let o=this.listens.get(r);s=o.get(i),o.delete(i),o.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(t,i){L("Auth token revoked: "+t+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=io&&(this.reconnectDelay_=no,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,i){L("App check token revoked: "+t+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=io&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let i of t.values())this.sendListen_(i);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},i="js";ne()&&(this.repoInfo_.nodeAdmin?i="admin_node":i="node"),t["sdk."+i+"."+Cr.replace(/\./g,"-")]=1,Xn()?t["framework.cordova"]=1:bs()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=mn.getInstance().currentlyOnline();return Zn(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),y=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var it=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let i=new y(nt,e),r=new y(nt,t);return this.compare(i,r)!==0}minPost(){return y.MIN}};var cn,gn=class extends it{static get __EMPTY_NODE(){return cn}static set __EMPTY_NODE(e){cn=e}compare(e,t){return ct(e.name,t.name)}isDefinedOn(e){throw Ae("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return y.MIN}maxPost(){return new y(Le,cn)}makePost(e,t){return f(typeof e=="string","KeyIndex indexValue must always be a string."),new y(e,cn)}toString(){return".key"}},et=new gn;var Je=class{constructor(e,t,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?i(e.key,t):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Z=(()=>{class n{constructor(t,i,r,s,o){this.key=t,this.value=i,this.color=r??n.RED,this.left=s??Y.EMPTY_NODE,this.right=o??Y.EMPTY_NODE}copy(t,i,r,s,o){return new n(t??this.key,i??this.value,r??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,i,r){let s=this,o=r(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,i,r),null):o===0?s=s.copy(null,i,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,i,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Y.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,i){let r,s;if(r=this,i(t,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(t,i),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),i(t,r.key)===0){if(r.right.isEmpty())return Y.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(t,i))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,i)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),Fi=class{copy(e,t,i,r,s){return this}insert(e,t,i){return new Z(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Y=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Z.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Z.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),t===0)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,r=null;for(;!i.isEmpty();)if(t=this.comparator_(e,i.key),t===0){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else t<0?i=i.left:t>0&&(r=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Je(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Je(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Je(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Je(this.root_,null,this.comparator_,!0,e)}};Y.EMPTY_NODE=new Fi;function bd(n,e){return ct(n.name,e.name)}function Tr(n,e){return ct(n,e)}var Bi;function wd(n){Bi=n}var Yo=function(n){return typeof n=="number"?"number:"+ko(n):"string:"+n},Ko=function(n){if(n.isLeafNode()){let e=n.val();f(typeof e=="string"||typeof e=="number"||typeof e=="object"&&ie(e,".sv"),"Priority must be a string or number.")}else f(n===Bi||n.isEmpty(),"priority of unexpected type.");f(n===Bi||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var ro,rt=(()=>{class n{static set __childrenNodeConstructor(t){ro=t}static get __childrenNodeConstructor(){return ro}constructor(t,i=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=i,this.lazyHash_=null,f(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Ko(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return C(t)?this:v(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,i){return null}updateImmediateChild(t,i){return t===".priority"?this.updatePriority(i):i.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,i).updatePriority(this.priorityNode_)}updateChild(t,i){let r=v(t);return r===null?i:i.isEmpty()&&r!==".priority"?this:(f(r!==".priority"||Se(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(x(t),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,i){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+Yo(this.priorityNode_.val())+":");let i=typeof this.value_;t+=i+":",i==="number"?t+=ko(this.value_):t+=this.value_,this.lazyHash_=To(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(f(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let i=typeof t.value_,r=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(i),o=n.VALUE_TYPE_ORDER.indexOf(r);return f(s>=0,"Unknown leaf type: "+i),f(o>=0,"Unknown leaf type: "+r),s===o?r==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let i=t;return this.value_===i.value_&&this.priorityNode_.equals(i.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),Qo,Jo;function Ed(n){Qo=n}function Id(n){Jo=n}var Wi=class extends it{compare(e,t){let i=e.node.getPriority(),r=t.node.getPriority(),s=i.compareTo(r);return s===0?ct(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return y.MIN}maxPost(){return new y(Le,new rt("[PRIORITY-POST]",Jo))}makePost(e,t){let i=Qo(e);return new y(t,new rt("[PRIORITY-POST]",i))}toString(){return".priority"}},N=new Wi;var Td=Math.log(2),Ui=class{constructor(e){let t=s=>parseInt(Math.log(s)/Td,10),i=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let r=i(this.count);this.bits_=e+1&r}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},_n=function(n,e,t,i){n.sort(e);let r=function(l,c){let h=c-l,u,d;if(h===0)return null;if(h===1)return u=n[l],d=t?t(u):u,new Z(d,u.node,Z.BLACK,null,null);{let p=parseInt(h/2,10)+l,m=r(l,p),T=r(p+1,c);return u=n[p],d=t?t(u):u,new Z(d,u.node,Z.BLACK,m,T)}},s=function(l){let c=null,h=null,u=n.length,d=function(m,T){let O=u-m,oe=u;u-=m;let ae=r(O+1,oe),ke=n[O],Gn=t?t(ke):ke;p(new Z(Gn,ke.node,T,null,ae))},p=function(m){c?(c.left=m,c=m):(h=m,c=m)};for(let m=0;m<l.count;++m){let T=l.nextBitIsOne(),O=Math.pow(2,l.count-(m+1));T?d(O,Z.BLACK):(d(O,Z.BLACK),d(O,Z.RED))}return h},o=new Ui(n.length),a=s(o);return new Y(i||e,a)};var vi,Qe={},st=class n{static get Default(){return f(Qe&&N,"ChildrenNode.ts has not been loaded"),vi=vi||new n({".priority":Qe},{".priority":N}),vi}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){let t=Ne(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Y?t:null}hasIndex(e){return ie(this.indexSet_,e.toString())}addIndex(e,t){f(e!==et,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let i=[],r=!1,s=t.getIterator(y.Wrap),o=s.getNext();for(;o;)r=r||e.isDefinedOn(o.node),i.push(o),o=s.getNext();let a;r?a=_n(i,e.getCompare()):a=Qe;let l=e.toString(),c=k({},this.indexSet_);c[l]=e;let h=k({},this.indexes_);return h[l]=a,new n(h,c)}addToIndexes(e,t){let i=gt(this.indexes_,(r,s)=>{let o=Ne(this.indexSet_,s);if(f(o,"Missing index implementation for "+s),r===Qe)if(o.isDefinedOn(e.node)){let a=[],l=t.getIterator(y.Wrap),c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),_n(a,o.getCompare())}else return Qe;else{let a=t.get(e.name),l=r;return a&&(l=l.remove(new y(e.name,a))),l.insert(e,e.node)}});return new n(i,this.indexSet_)}removeFromIndexes(e,t){let i=gt(this.indexes_,r=>{if(r===Qe)return r;{let s=t.get(e.name);return s?r.remove(new y(e.name,s)):r}});return new n(i,this.indexSet_)}};var It,_=(()=>{class n{static get EMPTY_NODE(){return It||(It=new n(new Y(Tr),null,st.Default))}constructor(t,i,r){this.children_=t,this.priorityNode_=i,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&Ko(this.priorityNode_),this.children_.isEmpty()&&f(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||It}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let i=this.children_.get(t);return i===null?It:i}}getChild(t){let i=v(t);return i===null?this:this.getImmediateChild(i).getChild(x(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,i){if(f(i,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(i);{let r=new y(t,i),s,o;i.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(t,i),o=this.indexMap_.addToIndexes(r,this.children_));let a=s.isEmpty()?It:this.priorityNode_;return new n(s,a,o)}}updateChild(t,i){let r=v(t);if(r===null)return i;{f(v(t)!==".priority"||Se(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(r).updateChild(x(t),i);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let i={},r=0,s=0,o=!0;if(this.forEachChild(N,(a,l)=>{i[a]=l.val(t),r++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*r){let a=[];for(let l in i)a[l]=i[l];return a}else return t&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+Yo(this.getPriority().val())+":"),this.forEachChild(N,(i,r)=>{let s=r.hash();s!==""&&(t+=":"+i+":"+s)}),this.lazyHash_=t===""?"":To(t)}return this.lazyHash_}getPredecessorChildName(t,i,r){let s=this.resolveIndex_(r);if(s){let o=s.getPredecessorKey(new y(t,i));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let i=this.resolveIndex_(t);if(i){let r=i.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(t){let i=this.getFirstChildName(t);return i?new y(i,this.children_.get(i)):null}getLastChildName(t){let i=this.resolveIndex_(t);if(i){let r=i.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(t){let i=this.getLastChildName(t);return i?new y(i,this.children_.get(i)):null}forEachChild(t,i){let r=this.resolveIndex_(t);return r?r.inorderTraversal(s=>i(s.name,s.node)):this.children_.inorderTraversal(i)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,i){let r=this.resolveIndex_(i);if(r)return r.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,y.Wrap),o=s.peek();for(;o!=null&&i.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,i){let r=this.resolveIndex_(i);if(r)return r.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,y.Wrap),o=s.peek();for(;o!=null&&i.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Wt?-1:0}withIndex(t){if(t===et||this.indexMap_.hasIndex(t))return this;{let i=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,i)}}isIndexed(t){return t===et||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let i=t;if(this.getPriority().equals(i.getPriority()))if(this.children_.count()===i.children_.count()){let r=this.getIterator(N),s=i.getIterator(N),o=r.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=r.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===et?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),ji=class extends _{constructor(){super(new Y(Tr),_.EMPTY_NODE,st.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return _.EMPTY_NODE}isEmpty(){return!1}},Wt=new ji;Object.defineProperties(y,{MIN:{value:new y(nt,_.EMPTY_NODE)},MAX:{value:new y(Le,Wt)}});gn.__EMPTY_NODE=_.EMPTY_NODE;rt.__childrenNodeConstructor=_;wd(Wt);Id(Wt);var Sd=!0;function F(n,e=null){if(n===null)return _.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),f(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new rt(t,F(e))}if(!(n instanceof Array)&&Sd){let t=[],i=!1;if(z(n,(o,a)=>{if(o.substring(0,1)!=="."){let l=F(a);l.isEmpty()||(i=i||!l.getPriority().isEmpty(),t.push(new y(o,l)))}}),t.length===0)return _.EMPTY_NODE;let s=_n(t,bd,o=>o.name,Tr);if(i){let o=_n(t,N.getCompare());return new _(s,F(e),new st({".priority":o},{".priority":N}))}else return new _(s,F(e),st.Default)}else{let t=_.EMPTY_NODE;return z(n,(i,r)=>{if(ie(n,i)&&i.substring(0,1)!=="."){let s=F(r);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(i,s))}}),t.updatePriority(F(e))}}Ed(F);var Hi=class extends it{constructor(e){super(),this.indexPath_=e,f(!C(e)&&v(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let i=this.extractChild(e.node),r=this.extractChild(t.node),s=i.compareTo(r);return s===0?ct(e.name,t.name):s}makePost(e,t){let i=F(e),r=_.EMPTY_NODE.updateChild(this.indexPath_,i);return new y(t,r)}maxPost(){let e=_.EMPTY_NODE.updateChild(this.indexPath_,Wt);return new y(Le,e)}toString(){return $o(this.indexPath_,0).join("/")}};var zi=class extends it{compare(e,t){let i=e.node.compareTo(t.node);return i===0?ct(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return y.MIN}maxPost(){return y.MAX}makePost(e,t){let i=F(e);return new y(t,i)}toString(){return".value"}},xd=new zi;function Xo(n){return{type:"value",snapshotNode:n}}function ot(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Nt(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Ot(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function kd(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var Rt=class{constructor(e){this.index_=e}updateChild(e,t,i,r,s,o){f(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(t);return a.getChild(r).equals(i.getChild(r))&&a.isEmpty()===i.isEmpty()||(o!=null&&(i.isEmpty()?e.hasChild(t)?o.trackChildChange(Nt(t,a)):f(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(ot(t,i)):o.trackChildChange(Ot(t,i,a))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return i!=null&&(e.isLeafNode()||e.forEachChild(N,(r,s)=>{t.hasChild(r)||i.trackChildChange(Nt(r,s))}),t.isLeafNode()||t.forEachChild(N,(r,s)=>{if(e.hasChild(r)){let o=e.getImmediateChild(r);o.equals(s)||i.trackChildChange(Ot(r,s,o))}else i.trackChildChange(ot(r,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?_.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var yn=class n{constructor(e){this.indexedFilter_=new Rt(e.getIndex()),this.index_=e.getIndex(),this.startPost_=n.getStartPost_(e),this.endPost_=n.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,r,s,o){return this.matches(new y(t,i))||(i=_.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,r,s,o)}updateFullNode(e,t,i){t.isLeafNode()&&(t=_.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(_.EMPTY_NODE);let s=this;return t.forEachChild(N,(o,a)=>{s.matches(new y(o,a))||(r=r.updateImmediateChild(o,_.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}};var Vi=class{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{let i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{let i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new yn(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,r,s,o){return this.rangedFilter_.matches(new y(t,i))||(i=_.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,r,s,o):this.fullLimitUpdateChild_(e,t,i,s,o)}updateFullNode(e,t,i){let r;if(t.isLeafNode()||t.isEmpty())r=_.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){r=_.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))r=r.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{r=t.withIndex(this.index_),r=r.updatePriority(_.EMPTY_NODE);let s;this.reverse_?s=r.getReverseIterator(this.index_):s=r.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:r=r.updateImmediateChild(a.name,_.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,r,s){let o;if(this.reverse_){let u=this.index_.getCompare();o=(d,p)=>u(p,d)}else o=this.index_.getCompare();let a=e;f(a.numChildren()===this.limit_,"");let l=new y(t,i),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),h=this.rangedFilter_.matches(l);if(a.hasChild(t)){let u=a.getImmediateChild(t),d=r.getChildAfterChild(this.index_,c,this.reverse_);for(;d!=null&&(d.name===t||a.hasChild(d.name));)d=r.getChildAfterChild(this.index_,d,this.reverse_);let p=d==null?1:o(d,l);if(h&&!i.isEmpty()&&p>=0)return s?.trackChildChange(Ot(t,i,u)),a.updateImmediateChild(t,i);{s?.trackChildChange(Nt(t,u));let T=a.updateImmediateChild(t,_.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(s?.trackChildChange(ot(d.name,d.node)),T.updateImmediateChild(d.name,d.node)):T}}else return i.isEmpty()?e:h&&o(c,l)>=0?(s!=null&&(s.trackChildChange(Nt(c.name,c.node)),s.trackChildChange(ot(t,i))),a.updateImmediateChild(t,i).updateImmediateChild(c.name,_.EMPTY_NODE)):e}};var $i=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=N}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return f(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return f(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:nt}hasEnd(){return this.endSet_}getIndexEndValue(){return f(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return f(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Le}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return f(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===N}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function Pd(n){return n.loadsAllData()?new Rt(n.getIndex()):n.hasLimit()?new Vi(n):new yn(n)}function so(n){let e={};if(n.isDefault())return e;let t;if(n.index_===N?t="$priority":n.index_===xd?t="$value":n.index_===et?t="$key":(f(n.index_ instanceof Hi,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=R(t),n.startSet_){let i=n.startAfterSet_?"startAfter":"startAt";e[i]=R(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+R(n.indexStartName_))}if(n.endSet_){let i=n.endBeforeSet_?"endBefore":"endAt";e[i]=R(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+R(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function oo(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==N&&(e.i=n.index_.toString()),e}var Gi=class n extends fn{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(f(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,i,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=Ft("p:rest:"),this.listens_={}}listen(e,t,i,r){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,i),a={};this.listens_[o]=a;let l=so(e._queryParams);this.restRequest_(s+".json",l,(c,h)=>{let u=h;if(c===404&&(u=null,c=null),c===null&&this.onDataUpdate_(s,u,!1,i),Ne(this.listens_,o)===a){let d;c?c===401?d="permission_denied":d="rest_error:"+c:d="ok",r(d,null)}})}unlisten(e,t){let i=n.getListenId_(e,t);delete this.listens_[i]}get(e){let t=so(e._queryParams),i=e._path.toString(),r=new Pe;return this.restRequest_(i+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(i,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(t.auth=r.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Ss(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=Ke(a.responseText)}catch{$("Failed to parse JSON response for "+o+": "+a.responseText)}i(null,l)}else a.status!==401&&a.status!==404&&$("Got unsuccessful REST response for "+o+" Status: "+a.status),i(a.status);i=null}},a.open("GET",o,!0),a.send()})}};var qi=class{constructor(){this.rootNode_=_.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function vn(){return{value:null,children:new Map}}function Zo(n,e,t){if(C(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let i=v(e);n.children.has(i)||n.children.set(i,vn());let r=n.children.get(i);e=x(e),Zo(r,e,t)}}function Yi(n,e,t){n.value!==null?t(e,n.value):Ad(n,(i,r)=>{let s=new I(e.toString()+"/"+i);Yi(r,s,t)})}function Ad(n,e){n.children.forEach((t,i)=>{e(i,t)})}var Ki=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=k({},e);return this.last_&&z(this.last_,(i,r)=>{t[i]=t[i]-r}),this.last_=e,t}};var ao=10*1e3,Nd=30*1e3,Od=300*1e3,Qi=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Ki(e);let i=ao+(Nd-ao)*Math.random();St(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){let e=this.statsListener_.get(),t={},i=!1;z(e,(r,s)=>{s>0&&ie(this.statsToReport_,r)&&(t[r]=s,i=!0)}),i&&this.server_.reportStats(t),St(this.reportStats_.bind(this),Math.floor(Math.random()*2*Od))}};var se=(function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n})(se||{});function ea(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Sr(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function xr(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var Ji=class n{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=se.ACK_USER_WRITE,this.source=ea()}operationForChild(e){if(C(this.path)){if(this.affectedTree.value!=null)return f(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new I(e));return new n(w(),t,this.revert)}}else return f(v(this.path)===e,"operationForChild called for unrelated child."),new n(x(this.path),this.affectedTree,this.revert)}};var Cn=class n{constructor(e,t){this.source=e,this.path=t,this.type=se.LISTEN_COMPLETE}operationForChild(e){return C(this.path)?new n(this.source,w()):new n(this.source,x(this.path))}};var at=class n{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=se.OVERWRITE}operationForChild(e){return C(this.path)?new n(this.source,w(),this.snap.getImmediateChild(e)):new n(this.source,x(this.path),this.snap)}};var bn=class n{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=se.MERGE}operationForChild(e){if(C(this.path)){let t=this.children.subtree(new I(e));return t.isEmpty()?null:t.value?new at(this.source,w(),t.value):new n(this.source,w(),t)}else return f(v(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,x(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var pe=class{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(C(e))return this.isFullyInitialized()&&!this.filtered_;let t=v(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var Xi=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function Rd(n,e,t,i){let r=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(kd(o.childName,o.snapshotNode))}),Tt(n,r,"child_removed",e,i,t),Tt(n,r,"child_added",e,i,t),Tt(n,r,"child_moved",s,i,t),Tt(n,r,"child_changed",e,i,t),Tt(n,r,"value",e,i,t),r}function Tt(n,e,t,i,r,s){let o=i.filter(a=>a.type===t);o.sort((a,l)=>Dd(n,a,l)),o.forEach(a=>{let l=Md(n,a,s);r.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,n.query_))})})}function Md(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function Dd(n,e,t){if(e.childName==null||t.childName==null)throw Ae("Should only compare child_ events.");let i=new y(e.childName,e.snapshotNode),r=new y(t.childName,t.snapshotNode);return n.index_.compare(i,r)}function Rn(n,e){return{eventCache:n,serverCache:e}}function kt(n,e,t,i){return Rn(new pe(e,t,i),n.serverCache)}function ta(n,e,t,i){return Rn(n.eventCache,new pe(e,t,i))}function Zi(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Fe(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var Ci,Ld=()=>(Ci||(Ci=new Y(Fc)),Ci),V=class n{static fromObject(e){let t=new n(null);return z(e,(i,r)=>{t=t.set(new I(i),r)}),t}constructor(e,t=Ld()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:w(),value:this.value};if(C(e))return null;{let i=v(e),r=this.children.get(i);if(r!==null){let s=r.findRootMostMatchingPathAndValue(x(e),t);return s!=null?{path:M(new I(i),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(C(e))return this;{let t=v(e),i=this.children.get(t);return i!==null?i.subtree(x(e)):new n(null)}}set(e,t){if(C(e))return new n(t,this.children);{let i=v(e),s=(this.children.get(i)||new n(null)).set(x(e),t),o=this.children.insert(i,s);return new n(this.value,o)}}remove(e){if(C(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=v(e),i=this.children.get(t);if(i){let r=i.remove(x(e)),s;return r.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,r),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(C(e))return this.value;{let t=v(e),i=this.children.get(t);return i?i.get(x(e)):null}}setTree(e,t){if(C(e))return t;{let i=v(e),s=(this.children.get(i)||new n(null)).setTree(x(e),t),o;return s.isEmpty()?o=this.children.remove(i):o=this.children.insert(i,s),new n(this.value,o)}}fold(e){return this.fold_(w(),e)}fold_(e,t){let i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_(M(e,r),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,w(),t)}findOnPath_(e,t,i){let r=this.value?i(t,this.value):!1;if(r)return r;if(C(e))return null;{let s=v(e),o=this.children.get(s);return o?o.findOnPath_(x(e),M(t,s),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,w(),t)}foreachOnPath_(e,t,i){if(C(e))return this;{this.value&&i(t,this.value);let r=v(e),s=this.children.get(r);return s?s.foreachOnPath_(x(e),M(t,r),i):new n(null)}}foreach(e){this.foreach_(w(),e)}foreach_(e,t){this.children.inorderTraversal((i,r)=>{r.foreach_(M(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}};var te=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new V(null))}};function Pt(n,e,t){if(C(e))return new te(new V(t));{let i=n.writeTree_.findRootMostValueAndPath(e);if(i!=null){let r=i.path,s=i.value,o=H(r,e);return s=s.updateChild(o,t),new te(n.writeTree_.set(r,s))}else{let r=new V(t),s=n.writeTree_.setTree(e,r);return new te(s)}}}function lo(n,e,t){let i=n;return z(t,(r,s)=>{i=Pt(i,M(e,r),s)}),i}function co(n,e){if(C(e))return te.empty();{let t=n.writeTree_.setTree(e,new V(null));return new te(t)}}function er(n,e){return Be(n,e)!=null}function Be(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(H(t.path,e)):null}function uo(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(N,(i,r)=>{e.push(new y(i,r))}):n.writeTree_.children.inorderTraversal((i,r)=>{r.value!=null&&e.push(new y(i,r.value))}),e}function Te(n,e){if(C(e))return n;{let t=Be(n,e);return t!=null?new te(new V(t)):new te(n.writeTree_.subtree(e))}}function tr(n){return n.writeTree_.isEmpty()}function lt(n,e){return na(w(),n.writeTree_,e)}function na(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((r,s)=>{r===".priority"?(f(s.value!==null,"Priority writes must always be leaf nodes"),i=s.value):t=na(M(n,r),s,t)}),!t.getChild(n).isEmpty()&&i!==null&&(t=t.updateChild(M(n,".priority"),i)),t}}function kr(n,e){return oa(e,n)}function Fd(n,e,t,i,r){f(i>n.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:r}),r&&(n.visibleWrites=Pt(n.visibleWrites,e,t)),n.lastWriteId=i}function Bd(n,e){for(let t=0;t<n.allWrites.length;t++){let i=n.allWrites[t];if(i.writeId===e)return i}return null}function Wd(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);f(t>=0,"removeWrite called with nonexistent writeId.");let i=n.allWrites[t];n.allWrites.splice(t,1);let r=i.visible,s=!1,o=n.allWrites.length-1;for(;r&&o>=0;){let a=n.allWrites[o];a.visible&&(o>=t&&Ud(a,i.path)?r=!1:ee(i.path,a.path)&&(s=!0)),o--}if(r){if(s)return jd(n),!0;if(i.snap)n.visibleWrites=co(n.visibleWrites,i.path);else{let a=i.children;z(a,l=>{n.visibleWrites=co(n.visibleWrites,M(i.path,l))})}return!0}else return!1}function Ud(n,e){if(n.snap)return ee(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&ee(M(n.path,t),e))return!0;return!1}function jd(n){n.visibleWrites=ia(n.allWrites,Hd,w()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function Hd(n){return n.visible}function ia(n,e,t){let i=te.empty();for(let r=0;r<n.length;++r){let s=n[r];if(e(s)){let o=s.path,a;if(s.snap)ee(t,o)?(a=H(t,o),i=Pt(i,a,s.snap)):ee(o,t)&&(a=H(o,t),i=Pt(i,w(),s.snap.getChild(a)));else if(s.children){if(ee(t,o))a=H(t,o),i=lo(i,a,s.children);else if(ee(o,t))if(a=H(o,t),C(a))i=lo(i,w(),s.children);else{let l=Ne(s.children,v(a));if(l){let c=l.getChild(x(a));i=Pt(i,w(),c)}}}else throw Ae("WriteRecord should have .snap or .children")}}return i}function ra(n,e,t,i,r){if(!i&&!r){let s=Be(n.visibleWrites,e);if(s!=null)return s;{let o=Te(n.visibleWrites,e);if(tr(o))return t;if(t==null&&!er(o,w()))return null;{let a=t||_.EMPTY_NODE;return lt(o,a)}}}else{let s=Te(n.visibleWrites,e);if(!r&&tr(s))return t;if(!r&&t==null&&!er(s,w()))return null;{let o=function(c){return(c.visible||r)&&(!i||!~i.indexOf(c.writeId))&&(ee(c.path,e)||ee(e,c.path))},a=ia(n.allWrites,o,e),l=t||_.EMPTY_NODE;return lt(a,l)}}}function zd(n,e,t){let i=_.EMPTY_NODE,r=Be(n.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(N,(s,o)=>{i=i.updateImmediateChild(s,o)}),i;if(t){let s=Te(n.visibleWrites,e);return t.forEachChild(N,(o,a)=>{let l=lt(Te(s,new I(o)),a);i=i.updateImmediateChild(o,l)}),uo(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}else{let s=Te(n.visibleWrites,e);return uo(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}}function Vd(n,e,t,i,r){f(i||r,"Either existingEventSnap or existingServerSnap must exist");let s=M(e,t);if(er(n.visibleWrites,s))return null;{let o=Te(n.visibleWrites,s);return tr(o)?r.getChild(t):lt(o,r.getChild(t))}}function $d(n,e,t,i){let r=M(e,t),s=Be(n.visibleWrites,r);if(s!=null)return s;if(i.isCompleteForChild(t)){let o=Te(n.visibleWrites,r);return lt(o,i.getNode().getImmediateChild(t))}else return null}function Gd(n,e){return Be(n.visibleWrites,e)}function qd(n,e,t,i,r,s,o){let a,l=Te(n.visibleWrites,e),c=Be(l,w());if(c!=null)a=c;else if(t!=null)a=lt(l,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let h=[],u=o.getCompare(),d=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o),p=d.getNext();for(;p&&h.length<r;)u(p,i)!==0&&h.push(p),p=d.getNext();return h}else return[]}function Yd(){return{visibleWrites:te.empty(),allWrites:[],lastWriteId:-1}}function wn(n,e,t,i){return ra(n.writeTree,n.treePath,e,t,i)}function Pr(n,e){return zd(n.writeTree,n.treePath,e)}function ho(n,e,t,i){return Vd(n.writeTree,n.treePath,e,t,i)}function En(n,e){return Gd(n.writeTree,M(n.treePath,e))}function Kd(n,e,t,i,r,s){return qd(n.writeTree,n.treePath,e,t,i,r,s)}function Ar(n,e,t){return $d(n.writeTree,n.treePath,e,t)}function sa(n,e){return oa(M(n.treePath,e),n.writeTree)}function oa(n,e){return{treePath:n,writeTree:e}}var nr=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,i=e.childName;f(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),f(i!==".priority","Only non-priority child changes can be tracked.");let r=this.changeMap.get(i);if(r){let s=r.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(i,Ot(i,e.snapshotNode,r.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(i);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(i,Nt(i,r.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(i,ot(i,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(i,Ot(i,e.snapshotNode,r.oldSnap));else throw Ae("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}};var ir=class{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}},aa=new ir,Mt=class{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let i=this.optCompleteServerCache_!=null?new pe(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Ar(this.writes_,e,i)}}getChildAfterChild(e,t,i){let r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Fe(this.viewCache_),s=Kd(this.writes_,r,t,1,i,e);return s.length===0?null:s[0]}};function Qd(n){return{filter:n}}function Jd(n,e){f(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),f(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function Xd(n,e,t,i,r){let s=new nr,o,a;if(t.type===se.OVERWRITE){let c=t;c.source.fromUser?o=rr(n,e,c.path,c.snap,i,r,s):(f(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!C(c.path),o=In(n,e,c.path,c.snap,i,r,a,s))}else if(t.type===se.MERGE){let c=t;c.source.fromUser?o=eu(n,e,c.path,c.children,i,r,s):(f(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=sr(n,e,c.path,c.children,i,r,a,s))}else if(t.type===se.ACK_USER_WRITE){let c=t;c.revert?o=iu(n,e,c.path,i,r,s):o=tu(n,e,c.path,c.affectedTree,i,r,s)}else if(t.type===se.LISTEN_COMPLETE)o=nu(n,e,t.path,i,s);else throw Ae("Unknown operation type: "+t.type);let l=s.getChanges();return Zd(e,o,l),{viewCache:o,changes:l}}function Zd(n,e,t){let i=e.eventCache;if(i.isFullyInitialized()){let r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=Zi(n);(t.length>0||!n.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&t.push(Xo(Zi(e)))}}function la(n,e,t,i,r,s){let o=e.eventCache;if(En(i,t)!=null)return e;{let a,l;if(C(t))if(f(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let c=Fe(e),h=c instanceof _?c:_.EMPTY_NODE,u=Pr(i,h);a=n.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{let c=wn(i,Fe(e));a=n.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{let c=v(t);if(c===".priority"){f(Se(t)===1,"Can't have a priority with additional path components");let h=o.getNode();l=e.serverCache.getNode();let u=ho(i,t,h,l);u!=null?a=n.filter.updatePriority(h,u):a=o.getNode()}else{let h=x(t),u;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();let d=ho(i,t,o.getNode(),l);d!=null?u=o.getNode().getImmediateChild(c).updateChild(h,d):u=o.getNode().getImmediateChild(c)}else u=Ar(i,c,e.serverCache);u!=null?a=n.filter.updateChild(o.getNode(),c,u,h,r,s):a=o.getNode()}}return kt(e,a,o.isFullyInitialized()||C(t),n.filter.filtersNodes())}}function In(n,e,t,i,r,s,o,a){let l=e.serverCache,c,h=o?n.filter:n.filter.getIndexedFilter();if(C(t))c=h.updateFullNode(l.getNode(),i,null);else if(h.filtersNodes()&&!l.isFiltered()){let p=l.getNode().updateChild(t,i);c=h.updateFullNode(l.getNode(),p,null)}else{let p=v(t);if(!l.isCompleteForPath(t)&&Se(t)>1)return e;let m=x(t),O=l.getNode().getImmediateChild(p).updateChild(m,i);p===".priority"?c=h.updatePriority(l.getNode(),O):c=h.updateChild(l.getNode(),p,O,m,aa,null)}let u=ta(e,c,l.isFullyInitialized()||C(t),h.filtersNodes()),d=new Mt(r,u,s);return la(n,u,t,r,d,a)}function rr(n,e,t,i,r,s,o){let a=e.eventCache,l,c,h=new Mt(r,e,s);if(C(t))c=n.filter.updateFullNode(e.eventCache.getNode(),i,o),l=kt(e,c,!0,n.filter.filtersNodes());else{let u=v(t);if(u===".priority")c=n.filter.updatePriority(e.eventCache.getNode(),i),l=kt(e,c,a.isFullyInitialized(),a.isFiltered());else{let d=x(t),p=a.getNode().getImmediateChild(u),m;if(C(d))m=i;else{let T=h.getCompleteChild(u);T!=null?Vo(d)===".priority"&&T.getChild(Go(d)).isEmpty()?m=T:m=T.updateChild(d,i):m=_.EMPTY_NODE}if(p.equals(m))l=e;else{let T=n.filter.updateChild(a.getNode(),u,m,d,h,o);l=kt(e,T,a.isFullyInitialized(),n.filter.filtersNodes())}}}return l}function fo(n,e){return n.eventCache.isCompleteForChild(e)}function eu(n,e,t,i,r,s,o){let a=e;return i.foreach((l,c)=>{let h=M(t,l);fo(e,v(h))&&(a=rr(n,a,h,c,r,s,o))}),i.foreach((l,c)=>{let h=M(t,l);fo(e,v(h))||(a=rr(n,a,h,c,r,s,o))}),a}function po(n,e,t){return t.foreach((i,r)=>{e=e.updateChild(i,r)}),e}function sr(n,e,t,i,r,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;C(t)?c=i:c=new V(null).setTree(t,i);let h=e.serverCache.getNode();return c.children.inorderTraversal((u,d)=>{if(h.hasChild(u)){let p=e.serverCache.getNode().getImmediateChild(u),m=po(n,p,d);l=In(n,l,new I(u),m,r,s,o,a)}}),c.children.inorderTraversal((u,d)=>{let p=!e.serverCache.isCompleteForChild(u)&&d.value===null;if(!h.hasChild(u)&&!p){let m=e.serverCache.getNode().getImmediateChild(u),T=po(n,m,d);l=In(n,l,new I(u),T,r,s,o,a)}}),l}function tu(n,e,t,i,r,s,o){if(En(r,t)!=null)return e;let a=e.serverCache.isFiltered(),l=e.serverCache;if(i.value!=null){if(C(t)&&l.isFullyInitialized()||l.isCompleteForPath(t))return In(n,e,t,l.getNode().getChild(t),r,s,a,o);if(C(t)){let c=new V(null);return l.getNode().forEachChild(et,(h,u)=>{c=c.set(new I(h),u)}),sr(n,e,t,c,r,s,a,o)}else return e}else{let c=new V(null);return i.foreach((h,u)=>{let d=M(t,h);l.isCompleteForPath(d)&&(c=c.set(h,l.getNode().getChild(d)))}),sr(n,e,t,c,r,s,a,o)}}function nu(n,e,t,i,r){let s=e.serverCache,o=ta(e,s.getNode(),s.isFullyInitialized()||C(t),s.isFiltered());return la(n,o,t,i,aa,r)}function iu(n,e,t,i,r,s){let o;if(En(i,t)!=null)return e;{let a=new Mt(i,e,r),l=e.eventCache.getNode(),c;if(C(t)||v(t)===".priority"){let h;if(e.serverCache.isFullyInitialized())h=wn(i,Fe(e));else{let u=e.serverCache.getNode();f(u instanceof _,"serverChildren would be complete if leaf node"),h=Pr(i,u)}h=h,c=n.filter.updateFullNode(l,h,s)}else{let h=v(t),u=Ar(i,h,e.serverCache);u==null&&e.serverCache.isCompleteForChild(h)&&(u=l.getImmediateChild(h)),u!=null?c=n.filter.updateChild(l,h,u,x(t),a,s):e.eventCache.getNode().hasChild(h)?c=n.filter.updateChild(l,h,_.EMPTY_NODE,x(t),a,s):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=wn(i,Fe(e)),o.isLeafNode()&&(c=n.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||En(i,w())!=null,kt(e,c,o,n.filter.filtersNodes())}}var or=class{constructor(e,t){this.query_=e,this.eventRegistrations_=[];let i=this.query_._queryParams,r=new Rt(i.getIndex()),s=Pd(i);this.processor_=Qd(s);let o=t.serverCache,a=t.eventCache,l=r.updateFullNode(_.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(_.EMPTY_NODE,a.getNode(),null),h=new pe(l,o.isFullyInitialized(),r.filtersNodes()),u=new pe(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Rn(u,h),this.eventGenerator_=new Xi(this.query_)}get query(){return this.query_}};function ru(n){return n.viewCache_.serverCache.getNode()}function su(n,e){let t=Fe(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!C(e)&&!t.getImmediateChild(v(e)).isEmpty())?t.getChild(e):null}function mo(n){return n.eventRegistrations_.length===0}function ou(n,e){n.eventRegistrations_.push(e)}function go(n,e,t){let i=[];if(t){f(e==null,"A cancel should cancel all event registrations.");let r=n.query._path;n.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(t,r);o&&i.push(o)})}if(e){let r=[];for(let s=0;s<n.eventRegistrations_.length;++s){let o=n.eventRegistrations_[s];if(!o.matches(e))r.push(o);else if(e.hasAnyCallback()){r=r.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=r}else n.eventRegistrations_=[];return i}function _o(n,e,t,i){e.type===se.MERGE&&e.source.queryId!==null&&(f(Fe(n.viewCache_),"We should always have a full cache before handling merges"),f(Zi(n.viewCache_),"Missing event cache, even though we have a server cache"));let r=n.viewCache_,s=Xd(n.processor_,r,e,t,i);return Jd(n.processor_,s.viewCache),f(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,ca(n,s.changes,s.viewCache.eventCache.getNode(),null)}function au(n,e){let t=n.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(N,(s,o)=>{i.push(ot(s,o))}),t.isFullyInitialized()&&i.push(Xo(t.getNode())),ca(n,i,t.getNode(),e)}function ca(n,e,t,i){let r=i?[i]:n.eventRegistrations_;return Rd(n.eventGenerator_,e,t,r)}var Tn,ar=class{constructor(){this.views=new Map}};function lu(n){f(!Tn,"__referenceConstructor has already been defined"),Tn=n}function cu(){return f(Tn,"Reference.ts has not been loaded"),Tn}function du(n){return n.views.size===0}function Nr(n,e,t,i){let r=e.source.queryId;if(r!==null){let s=n.views.get(r);return f(s!=null,"SyncTree gave us an op for an invalid query."),_o(s,e,t,i)}else{let s=[];for(let o of n.views.values())s=s.concat(_o(o,e,t,i));return s}}function uu(n,e,t,i,r){let s=e._queryIdentifier,o=n.views.get(s);if(!o){let a=wn(t,r?i:null),l=!1;a?l=!0:i instanceof _?(a=Pr(t,i),l=!1):(a=_.EMPTY_NODE,l=!1);let c=Rn(new pe(a,l,!1),new pe(i,r,!1));return new or(e,c)}return o}function hu(n,e,t,i,r,s){let o=uu(n,e,i,r,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),ou(o,t),au(o,t)}function fu(n,e,t,i){let r=e._queryIdentifier,s=[],o=[],a=xe(n);if(r==="default")for(let[l,c]of n.views.entries())o=o.concat(go(c,t,i)),mo(c)&&(n.views.delete(l),c.query._queryParams.loadsAllData()||s.push(c.query));else{let l=n.views.get(r);l&&(o=o.concat(go(l,t,i)),mo(l)&&(n.views.delete(r),l.query._queryParams.loadsAllData()||s.push(l.query)))}return a&&!xe(n)&&s.push(new(cu())(e._repo,e._path)),{removed:s,events:o}}function da(n){let e=[];for(let t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function tt(n,e){let t=null;for(let i of n.views.values())t=t||su(i,e);return t}function ua(n,e){if(e._queryParams.loadsAllData())return Mn(n);{let i=e._queryIdentifier;return n.views.get(i)}}function ha(n,e){return ua(n,e)!=null}function xe(n){return Mn(n)!=null}function Mn(n){for(let e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Sn;function pu(n){f(!Sn,"__referenceConstructor has already been defined"),Sn=n}function mu(){return f(Sn,"Reference.ts has not been loaded"),Sn}var gu=1,xn=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new V(null),this.pendingWriteTree_=Yd(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function _u(n,e,t,i,r){return Fd(n.pendingWriteTree_,e,t,i,r),r?Ut(n,new at(ea(),e,t)):[]}function Xe(n,e,t=!1){let i=Bd(n.pendingWriteTree_,e);if(Wd(n.pendingWriteTree_,e)){let s=new V(null);return i.snap!=null?s=s.set(w(),!0):z(i.children,o=>{s=s.set(new I(o),!0)}),Ut(n,new Ji(i.path,s,t))}else return[]}function Dn(n,e,t){return Ut(n,new at(Sr(),e,t))}function yu(n,e,t){let i=V.fromObject(t);return Ut(n,new bn(Sr(),e,i))}function vu(n,e){return Ut(n,new Cn(Sr(),e))}function Cu(n,e,t){let i=Or(n,t);if(i){let r=Rr(i),s=r.path,o=r.queryId,a=H(s,e),l=new Cn(xr(o),a);return Mr(n,s,l)}else return[]}function lr(n,e,t,i,r=!1){let s=e._path,o=n.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||ha(o,e))){let l=fu(o,e,t,i);du(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));let c=l.removed;if(a=l.events,!r){let h=c.findIndex(d=>d._queryParams.loadsAllData())!==-1,u=n.syncPointTree_.findOnPath(s,(d,p)=>xe(p));if(h&&!u){let d=n.syncPointTree_.subtree(s);if(!d.isEmpty()){let p=Eu(d);for(let m=0;m<p.length;++m){let T=p[m],O=T.query,oe=ga(n,T);n.listenProvider_.startListening(At(O),kn(n,O),oe.hashFn,oe.onComplete)}}}!u&&c.length>0&&!i&&(h?n.listenProvider_.stopListening(At(e),null):c.forEach(d=>{let p=n.queryToTagMap.get(Ln(d));n.listenProvider_.stopListening(At(d),p)}))}Iu(n,c)}return a}function bu(n,e,t,i){let r=Or(n,i);if(r!=null){let s=Rr(r),o=s.path,a=s.queryId,l=H(o,e),c=new at(xr(a),l,t);return Mr(n,o,c)}else return[]}function wu(n,e,t,i){let r=Or(n,i);if(r){let s=Rr(r),o=s.path,a=s.queryId,l=H(o,e),c=V.fromObject(t),h=new bn(xr(a),l,c);return Mr(n,o,h)}else return[]}function yo(n,e,t,i=!1){let r=e._path,s=null,o=!1;n.syncPointTree_.foreachOnPath(r,(d,p)=>{let m=H(d,r);s=s||tt(p,m),o=o||xe(p)});let a=n.syncPointTree_.get(r);a?(o=o||xe(a),s=s||tt(a,w())):(a=new ar,n.syncPointTree_=n.syncPointTree_.set(r,a));let l;s!=null?l=!0:(l=!1,s=_.EMPTY_NODE,n.syncPointTree_.subtree(r).foreachChild((p,m)=>{let T=tt(m,w());T&&(s=s.updateImmediateChild(p,T))}));let c=ha(a,e);if(!c&&!e._queryParams.loadsAllData()){let d=Ln(e);f(!n.queryToTagMap.has(d),"View does not exist, but we have a tag");let p=Tu();n.queryToTagMap.set(d,p),n.tagToQueryMap.set(p,d)}let h=kr(n.pendingWriteTree_,r),u=hu(a,e,t,h,s,l);if(!c&&!o&&!i){let d=ua(a,e);u=u.concat(Su(n,e,d))}return u}function fa(n,e,t){let r=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{let l=H(o,e),c=tt(a,l);if(c)return c});return ra(r,e,s,t,!0)}function Ut(n,e){return pa(e,n.syncPointTree_,null,kr(n.pendingWriteTree_,w()))}function pa(n,e,t,i){if(C(n.path))return ma(n,e,t,i);{let r=e.get(w());t==null&&r!=null&&(t=tt(r,w()));let s=[],o=v(n.path),a=n.operationForChild(o),l=e.children.get(o);if(l&&a){let c=t?t.getImmediateChild(o):null,h=sa(i,o);s=s.concat(pa(a,l,c,h))}return r&&(s=s.concat(Nr(r,n,i,t))),s}}function ma(n,e,t,i){let r=e.get(w());t==null&&r!=null&&(t=tt(r,w()));let s=[];return e.children.inorderTraversal((o,a)=>{let l=t?t.getImmediateChild(o):null,c=sa(i,o),h=n.operationForChild(o);h&&(s=s.concat(ma(h,a,l,c)))}),r&&(s=s.concat(Nr(r,n,i,t))),s}function ga(n,e){let t=e.query,i=kn(n,t);return{hashFn:()=>(ru(e)||_.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return i?Cu(n,t._path,i):vu(n,t._path);{let s=Uc(r,t);return lr(n,t,null,s)}}}}function kn(n,e){let t=Ln(e);return n.queryToTagMap.get(t)}function Ln(n){return n._path.toString()+"$"+n._queryIdentifier}function Or(n,e){return n.tagToQueryMap.get(e)}function Rr(n){let e=n.indexOf("$");return f(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new I(n.substr(0,e))}}function Mr(n,e,t){let i=n.syncPointTree_.get(e);f(i,"Missing sync point for query tag that we're tracking");let r=kr(n.pendingWriteTree_,e);return Nr(i,t,r,null)}function Eu(n){return n.fold((e,t,i)=>{if(t&&xe(t))return[Mn(t)];{let r=[];return t&&(r=da(t)),z(i,(s,o)=>{r=r.concat(o)}),r}})}function At(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(mu())(n._repo,n._path):n}function Iu(n,e){for(let t=0;t<e.length;++t){let i=e[t];if(!i._queryParams.loadsAllData()){let r=Ln(i),s=n.queryToTagMap.get(r);n.queryToTagMap.delete(r),n.tagToQueryMap.delete(s)}}}function Tu(){return gu++}function Su(n,e,t){let i=e._path,r=kn(n,e),s=ga(n,t),o=n.listenProvider_.startListening(At(e),r,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(i);if(r)f(!xe(a.value),"If we're adding a query, it shouldn't be shadowed");else{let l=a.fold((c,h,u)=>{if(!C(c)&&h&&xe(h))return[Mn(h).query];{let d=[];return h&&(d=d.concat(da(h).map(p=>p.query))),z(u,(p,m)=>{d=d.concat(m)}),d}});for(let c=0;c<l.length;++c){let h=l[c];n.listenProvider_.stopListening(At(h),kn(n,h))}}return o}var cr=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},dr=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=M(this.path_,e);return new n(this.syncTree_,t)}node(){return fa(this.syncTree_,this.path_)}},xu=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},vo=function(n,e,t){if(!n||typeof n!="object")return n;if(f(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return ku(n[".sv"],e,t);if(typeof n[".sv"]=="object")return Pu(n[".sv"],e);f(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},ku=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:f(!1,"Unexpected server value: "+n)}},Pu=function(n,e,t){n.hasOwnProperty("increment")||f(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let i=n.increment;typeof i!="number"&&f(!1,"Unexpected increment value: "+i);let r=e.node();if(f(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;let o=r.getValue();return typeof o!="number"?i:o+i},Au=function(n,e,t,i){return Dr(e,new dr(t,n),i)},Nu=function(n,e,t){return Dr(n,new cr(e),t)};function Dr(n,e,t){let i=n.getPriority().val(),r=vo(i,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,a=vo(o.getValue(),e,t);return a!==o.getValue()||r!==o.getPriority().val()?new rt(a,F(r)):n}else{let o=n;return s=o,r!==o.getPriority().val()&&(s=s.updatePriority(new rt(r))),o.forEachChild(N,(a,l)=>{let c=Dr(l,e.getImmediateChild(a),t);c!==l&&(s=s.updateImmediateChild(a,c))}),s}}var Dt=class{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}};function Lr(n,e){let t=e instanceof I?e:new I(e),i=n,r=v(t);for(;r!==null;){let s=Ne(i.node.children,r)||{children:{},childCount:0};i=new Dt(r,i,s),t=x(t),r=v(t)}return i}function dt(n){return n.node.value}function _a(n,e){n.node.value=e,ur(n)}function ya(n){return n.node.childCount>0}function Ou(n){return dt(n)===void 0&&!ya(n)}function Fn(n,e){z(n.node.children,(t,i)=>{e(new Dt(t,n,i))})}function va(n,e,t,i){t&&!i&&e(n),Fn(n,r=>{va(r,e,!0,i)}),t&&i&&e(n)}function Ru(n,e,t){let i=t?n:n.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function jt(n){return new I(n.parent===null?n.name:jt(n.parent)+"/"+n.name)}function ur(n){n.parent!==null&&Mu(n.parent,n.name,n)}function Mu(n,e,t){let i=Ou(t),r=ie(n.node.children,e);i&&r?(delete n.node.children[e],n.node.childCount--,ur(n)):!i&&!r&&(n.node.children[e]=t.node,n.node.childCount++,ur(n))}var Du=/[\[\].#$\/\u0000-\u001F\u007F]/,Lu=/[\[\].#$\u0000-\u001F\u007F]/,bi=10*1024*1024,Ca=function(n){return typeof n=="string"&&n.length!==0&&!Du.test(n)},ba=function(n){return typeof n=="string"&&n.length!==0&&!Lu.test(n)},Fu=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),ba(n)};var wa=function(n,e,t){let i=t instanceof I?new Di(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Re(i));if(typeof e=="function")throw new Error(n+"contains a function "+Re(i)+" with contents = "+e.toString());if(So(e))throw new Error(n+"contains "+e.toString()+" "+Re(i));if(typeof e=="string"&&e.length>bi/3&&_t(e)>bi)throw new Error(n+"contains a string greater than "+bi+" utf8 bytes "+Re(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,s=!1;if(z(e,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Ca(o)))throw new Error(n+" contains an invalid key ("+o+") "+Re(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);md(i,o),wa(n,a,i),gd(i)}),r&&s)throw new Error(n+' contains ".value" child '+Re(i)+" in addition to actual children.")}};var Ea=function(n,e,t,i){if(!(i&&t===void 0)&&!ba(t))throw new Error(ei(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Bu=function(n,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Ea(n,e,t,i)};var Wu=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Ca(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!Fu(t))throw new Error(ei(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var hr=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Ia(n,e){let t=null;for(let i=0;i<e.length;i++){let r=e[i],s=r.getPath();t!==null&&!Er(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(r)}t&&n.eventLists_.push(t)}function Ta(n,e,t){Ia(n,t),Sa(n,i=>Er(i,e))}function We(n,e,t){Ia(n,t),Sa(n,i=>ee(i,e)||ee(e,i))}function Sa(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){let r=n.eventLists_[i];if(r){let s=r.path;e(s)?(Uu(n.eventLists_[i]),n.eventLists_[i]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function Uu(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let i=t.getEventRunner();De&&L("event: "+t.toString()),Bt(i)}}}var ju="repo_interrupt",Hu=25,fr=class{constructor(e,t,i,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new hr,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=vn(),this.transactionQueueTree_=new Dt,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function zu(n,e,t){if(n.stats_=wr(n.repoInfo_),n.forceRestClient_||Vc())n.server_=new Gi(n.repoInfo_,(i,r,s,o)=>{Co(n,i,r,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>bo(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{R(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new Ir(n.repoInfo_,e,(i,r,s,o)=>{Co(n,i,r,s,o)},i=>{bo(n,i)},i=>{$u(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=Gc(n.repoInfo_,()=>new Qi(n.stats_,n.server_)),n.infoData_=new qi,n.infoSyncTree_=new xn({startListening:(i,r,s,o)=>{let a=[],l=n.infoData_.getNode(i._path);return l.isEmpty()||(a=Dn(n.infoSyncTree_,i._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Fr(n,"connected",!1),n.serverSyncTree_=new xn({startListening:(i,r,s,o)=>(n.server_.listen(i,s,r,(a,l)=>{let c=o(a,l);We(n.eventQueue_,i._path,c)}),[]),stopListening:(i,r)=>{n.server_.unlisten(i,r)}})}function Vu(n){let t=n.infoData_.getNode(new I(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function xa(n){return xu({timestamp:Vu(n)})}function Co(n,e,t,i,r){n.dataUpdateCount++;let s=new I(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(r)if(i){let l=gt(t,c=>F(c));o=wu(n.serverSyncTree_,s,l,r)}else{let l=F(t);o=bu(n.serverSyncTree_,s,l,r)}else if(i){let l=gt(t,c=>F(c));o=yu(n.serverSyncTree_,s,l)}else{let l=F(t);o=Dn(n.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=Wr(n,s)),We(n.eventQueue_,a,o)}function bo(n,e){Fr(n,"connected",e),e===!1&&qu(n)}function $u(n,e){z(e,(t,i)=>{Fr(n,t,i)})}function Fr(n,e,t){let i=new I("/.info/"+e),r=F(t);n.infoData_.updateSnapshot(i,r);let s=Dn(n.infoSyncTree_,i,r);We(n.eventQueue_,i,s)}function Gu(n){return n.nextWriteId_++}function qu(n){ka(n,"onDisconnectEvents");let e=xa(n),t=vn();Yi(n.onDisconnect_,w(),(r,s)=>{let o=Au(r,s,n.serverSyncTree_,e);Zo(t,r,o)});let i=[];Yi(t,w(),(r,s)=>{i=i.concat(Dn(n.serverSyncTree_,r,s));let o=Xu(n,r);Wr(n,o)}),n.onDisconnect_=vn(),We(n.eventQueue_,w(),i)}function Yu(n,e,t){let i;v(e._path)===".info"?i=yo(n.infoSyncTree_,e,t):i=yo(n.serverSyncTree_,e,t),Ta(n.eventQueue_,e._path,i)}function wo(n,e,t){let i;v(e._path)===".info"?i=lr(n.infoSyncTree_,e,t):i=lr(n.serverSyncTree_,e,t),Ta(n.eventQueue_,e._path,i)}function Ku(n){n.persistentConnection_&&n.persistentConnection_.interrupt(ju)}function ka(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),L(t,...e)}function Pa(n,e,t){return fa(n.serverSyncTree_,e,t)||_.EMPTY_NODE}function Br(n,e=n.transactionQueueTree_){if(e||Bn(n,e),dt(e)){let t=Na(n,e);f(t.length>0,"Sending zero length transaction queue"),t.every(r=>r.status===0)&&Qu(n,jt(e),t)}else ya(e)&&Fn(e,t=>{Br(n,t)})}function Qu(n,e,t){let i=t.map(c=>c.currentWriteId),r=Pa(n,e,i),s=r,o=r.hash();for(let c=0;c<t.length;c++){let h=t[c];f(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;let u=H(e,h.path);s=s.updateChild(u,h.currentOutputSnapshotRaw)}let a=s.val(!0),l=e;n.server_.put(l.toString(),a,c=>{ka(n,"transaction put response",{path:l.toString(),status:c});let h=[];if(c==="ok"){let u=[];for(let d=0;d<t.length;d++)t[d].status=2,h=h.concat(Xe(n.serverSyncTree_,t[d].currentWriteId)),t[d].onComplete&&u.push(()=>t[d].onComplete(null,!0,t[d].currentOutputSnapshotResolved)),t[d].unwatcher();Bn(n,Lr(n.transactionQueueTree_,e)),Br(n,n.transactionQueueTree_),We(n.eventQueue_,e,h);for(let d=0;d<u.length;d++)Bt(u[d])}else{if(c==="datastale")for(let u=0;u<t.length;u++)t[u].status===3?t[u].status=4:t[u].status=0;else{$("transaction at "+l.toString()+" failed: "+c);for(let u=0;u<t.length;u++)t[u].status=4,t[u].abortReason=c}Wr(n,e)}},o)}function Wr(n,e){let t=Aa(n,e),i=jt(t),r=Na(n,t);return Ju(n,r,i),i}function Ju(n,e,t){if(e.length===0)return;let i=[],r=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let l=e[a],c=H(t,l.path),h=!1,u;if(f(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)h=!0,u=l.abortReason,r=r.concat(Xe(n.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=Hu)h=!0,u="maxretry",r=r.concat(Xe(n.serverSyncTree_,l.currentWriteId,!0));else{let d=Pa(n,l.path,o);l.currentInputSnapshot=d;let p=e[a].update(d.val());if(p!==void 0){wa("transaction failed: Data returned ",p,l.path);let m=F(p);typeof p=="object"&&p!=null&&ie(p,".priority")||(m=m.updatePriority(d.getPriority()));let O=l.currentWriteId,oe=xa(n),ae=Nu(m,d,oe);l.currentOutputSnapshotRaw=m,l.currentOutputSnapshotResolved=ae,l.currentWriteId=Gu(n),o.splice(o.indexOf(O),1),r=r.concat(_u(n.serverSyncTree_,l.path,ae,l.currentWriteId,l.applyLocally)),r=r.concat(Xe(n.serverSyncTree_,O,!0))}else h=!0,u="nodata",r=r.concat(Xe(n.serverSyncTree_,l.currentWriteId,!0))}We(n.eventQueue_,t,r),r=[],h&&(e[a].status=2,(function(d){setTimeout(d,Math.floor(0))})(e[a].unwatcher),e[a].onComplete&&(u==="nodata"?i.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):i.push(()=>e[a].onComplete(new Error(u),!1,null))))}Bn(n,n.transactionQueueTree_);for(let a=0;a<i.length;a++)Bt(i[a]);Br(n,n.transactionQueueTree_)}function Aa(n,e){let t,i=n.transactionQueueTree_;for(t=v(e);t!==null&&dt(i)===void 0;)i=Lr(i,t),e=x(e),t=v(e);return i}function Na(n,e){let t=[];return Oa(n,e,t),t.sort((i,r)=>i.order-r.order),t}function Oa(n,e,t){let i=dt(e);if(i)for(let r=0;r<i.length;r++)t.push(i[r]);Fn(e,r=>{Oa(n,r,t)})}function Bn(n,e){let t=dt(e);if(t){let i=0;for(let r=0;r<t.length;r++)t[r].status!==2&&(t[i]=t[r],i++);t.length=i,_a(e,t.length>0?t:void 0)}Fn(e,i=>{Bn(n,i)})}function Xu(n,e){let t=jt(Aa(n,e)),i=Lr(n.transactionQueueTree_,e);return Ru(i,r=>{wi(n,r)}),wi(n,i),va(i,r=>{wi(n,r)}),t}function wi(n,e){let t=dt(e);if(t){let i=[],r=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(f(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(f(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),r=r.concat(Xe(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&i.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?_a(e,void 0):t.length=s+1,We(n.eventQueue_,jt(e),r);for(let o=0;o<i.length;o++)Bt(i[o])}}function Zu(n){let e="",t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let r=t[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function eh(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let i=t.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):$(`Invalid query segment '${t}' in query '${n}'`)}return e}var Eo=function(n,e){let t=th(n),i=t.namespace;t.domain==="firebase.com"&&fe(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&t.domain!=="localhost"&&fe("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||Dc();let r=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new un(t.host,t.secure,i,r,e,"",i!==t.subdomain),path:new I(t.pathString)}},th=function(n){let e="",t="",i="",r="",s="",o=!0,a="https",l=443;if(typeof n=="string"){let c=n.indexOf("//");c>=0&&(a=n.substring(0,c-1),n=n.substring(c+2));let h=n.indexOf("/");h===-1&&(h=n.length);let u=n.indexOf("?");u===-1&&(u=n.length),e=n.substring(0,Math.min(h,u)),h<u&&(r=Zu(n.substring(h,u)));let d=eh(n.substring(Math.min(n.length,u)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;let p=e.slice(0,c);if(p.toLowerCase()==="localhost")t="localhost";else if(p.split(".").length<=2)t=p;else{let m=e.indexOf(".");i=e.substring(0,m).toLowerCase(),t=e.substring(m+1),s=i}"ns"in d&&(s=d.ns)}return{host:e,port:l,domain:t,subdomain:i,secure:o,scheme:a,pathString:r,namespace:s}};var Pn=class{constructor(e,t,i,r){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=r}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+R(this.snapshot.exportVal())}},An=class{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var pr=class{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return f(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var mr=class n{constructor(e,t,i,r){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=r}get key(){return C(this._path)?null:Vo(this._path)}get ref(){return new me(this._repo,this._path)}get _queryIdentifier(){let e=oo(this._queryParams),t=br(e);return t==="{}"?"default":t}get _queryObject(){return oo(this._queryParams)}isEqual(e){if(e=ue(e),!(e instanceof n))return!1;let t=this._repo===e._repo,i=Er(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&i&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+pd(this._path)}};var me=class n extends mr{constructor(e,t){super(e,t,new $i,!1)}get parent(){let e=Go(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Nn=class n{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let t=new I(e),i=On(this.ref,e);return new n(this._node.getChild(t),i,N)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,r)=>e(new n(r,On(this.ref,i),N)))}hasChild(e){let t=new I(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function Ht(n,e){return n=ue(n),n._checkNotDeleted("ref"),e!==void 0?On(n._root,e):n._root}function On(n,e){return n=ue(n),v(n._path)===null?Bu("child","path",e,!1):Ea("child","path",e,!1),new me(n._repo,M(n._path,e))}var gr=class n{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){let i=t._queryParams.getIndex();return new Pn("value",this,new Nn(e.snapshotNode,new me(t._repo,t._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new An(this,e,t):null}matches(e){return e instanceof n?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},_r=class n{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new An(this,e,t):null}createEvent(e,t){f(e.childName!=null,"Child events should have a childName.");let i=On(new me(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new Pn(e.type,this,new Nn(e.snapshotNode,i,r),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof n?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function nh(n,e,t,i,r){let s;if(typeof i=="object"&&(s=void 0,r=i),typeof i=="function"&&(s=i),r&&r.onlyOnce){let l=t,c=(h,u)=>{wo(n._repo,n,a),l(h,u)};c.userCallback=t.userCallback,c.context=t.context,t=c}let o=new pr(t,s||void 0),a=e==="value"?new gr(o):new _r(e,o);return Yu(n._repo,n,a),()=>wo(n._repo,n,a)}function zt(n,e,t,i){return nh(n,"value",e,t,i)}lu(me);pu(me);var ih="FIREBASE_DATABASE_EMULATOR_HOST",yr={},rh=!1;function sh(n,e,t,i){let r=e.lastIndexOf(":"),s=e.substring(0,r),o=tn(s);n.repoInfo_=new un(e,o,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0,t),i&&(n.authTokenProvider_=i)}function oh(n,e,t,i,r){let s=i||n.options.databaseURL;s===void 0&&(n.options.projectId||fe("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),L("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=Eo(s,r),a=o.repoInfo,l,c;typeof process<"u"&&process.env&&(c=process.env[ih]),c?(l=!0,s=`http://${c}?ns=${a.namespace}`,o=Eo(s,r),a=o.repoInfo):l=!o.repoInfo.secure;let h=r&&l?new xt(xt.OWNER):new ki(n.name,n.options,e);Wu("Invalid Firebase Database URL",o),C(o.path)||fe("Database URL must point to the root of a Firebase Database (not including a child path).");let u=lh(a,n,h,new xi(n,t));return new vr(u,n)}function ah(n,e){let t=yr[e];(!t||t[n.key]!==n)&&fe(`Database ${e}(${n.repoInfo_}) has already been deleted.`),Ku(n),delete t[n.key]}function lh(n,e,t,i){let r=yr[e.name];r||(r={},yr[e.name]=r);let s=r[n.toURLString()];return s&&fe("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new fr(n,rh,t,i),r[n.toURLString()]=s,s}var vr=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(zu(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new me(this._repo,w())),this._rootInternal}_delete(){return this._rootInternal!==null&&(ah(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&fe("Cannot call "+e+" on a deleted database.")}};function Ra(n=Ct(),e){let t=Ie(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){let i=gs("database");i&&ch(t,...i)}return t}function ch(n,e,t,i={}){n=ue(n),n._checkNotDeleted("useEmulator");let r=`${e}:${t}`,s=n._repoInternal;if(n._instanceStarted){if(r===n._repoInternal.repoInfo_.host&&be(i,s.repoInfo_.emulatorOptions))return;fe("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&fe('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new xt(xt.OWNER);else if(i.mockUserToken){let a=typeof i.mockUserToken=="string"?i.mockUserToken:ys(i.mockUserToken,n.app.options.projectId);o=new xt(a)}tn(e)&&(_s(e),vs("Database",!0)),sh(s,r,i,o)}function dh(n){Oc(Us),X(new B("database",(e,{instanceIdentifier:t})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return oh(i,r,s,t)},"PUBLIC").setMultipleInstances(!0)),j(zs,Vs,n),j(zs,Vs,"esm2020")}Ir.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Ir.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};dh();var uh="firebase",hh="12.7.0";j(uh,hh,"app");var La="@firebase/installations",zr="0.6.19";var Fa=1e4,Ba=`w:${zr}`,Wa="FIS_v2",fh="https://firebaseinstallations.googleapis.com/v1",ph=3600*1e3,mh="installations",gh="Installations";var _h={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},je=new de(mh,gh,_h);function Ua(n){return n instanceof J&&n.code.includes("request-failed")}function ja({projectId:n}){return`${fh}/projects/${n}/installations`}function Ha(n){return{token:n.token,requestStatus:2,expiresIn:vh(n.expiresIn),creationTime:Date.now()}}function za(n,e){return g(this,null,function*(){let i=(yield e.json()).error;return je.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})})}function Va({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function yh(n,{refreshToken:e}){let t=Va(n);return t.append("Authorization",Ch(e)),t}function $a(n){return g(this,null,function*(){let e=yield n();return e.status>=500&&e.status<600?n():e})}function vh(n){return Number(n.replace("s","000"))}function Ch(n){return`${Wa} ${n}`}function bh(i,r){return g(this,arguments,function*({appConfig:n,heartbeatServiceProvider:e},{fid:t}){let s=ja(n),o=Va(n),a=e.getImmediate({optional:!0});if(a){let u=yield a.getHeartbeatsHeader();u&&o.append("x-firebase-client",u)}let l={fid:t,authVersion:Wa,appId:n.appId,sdkVersion:Ba},c={method:"POST",headers:o,body:JSON.stringify(l)},h=yield $a(()=>fetch(s,c));if(h.ok){let u=yield h.json();return{fid:u.fid||t,registrationStatus:2,refreshToken:u.refreshToken,authToken:Ha(u.authToken)}}else throw yield za("Create Installation",h)})}function Ga(n){return new Promise(e=>{setTimeout(e,n)})}function wh(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}var Eh=/^[cdef][\w-]{21}$/,Hr="";function Ih(){try{let n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;let t=Th(n);return Eh.test(t)?t:Hr}catch{return Hr}}function Th(n){return wh(n).substr(0,22)}function Un(n){return`${n.appName}!${n.appId}`}var qa=new Map;function Ya(n,e){let t=Un(n);Ka(t,e),Sh(t,e)}function Ka(n,e){let t=qa.get(n);if(t)for(let i of t)i(e)}function Sh(n,e){let t=xh();t&&t.postMessage({key:n,fid:e}),kh()}var Ue=null;function xh(){return!Ue&&"BroadcastChannel"in self&&(Ue=new BroadcastChannel("[Firebase] FID Change"),Ue.onmessage=n=>{Ka(n.data.key,n.data.fid)}),Ue}function kh(){qa.size===0&&Ue&&(Ue.close(),Ue=null)}var Ph="firebase-installations-database",Ah=1,He="firebase-installations-store",Ur=null;function Vr(){return Ur||(Ur=an(Ph,Ah,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(He)}}})),Ur}function Wn(n,e){return g(this,null,function*(){let t=Un(n),r=(yield Vr()).transaction(He,"readwrite"),s=r.objectStore(He),o=yield s.get(t);return yield s.put(e,t),yield r.done,(!o||o.fid!==e.fid)&&Ya(n,e.fid),e})}function Qa(n){return g(this,null,function*(){let e=Un(n),i=(yield Vr()).transaction(He,"readwrite");yield i.objectStore(He).delete(e),yield i.done})}function jn(n,e){return g(this,null,function*(){let t=Un(n),r=(yield Vr()).transaction(He,"readwrite"),s=r.objectStore(He),o=yield s.get(t),a=e(o);return a===void 0?yield s.delete(t):yield s.put(a,t),yield r.done,a&&(!o||o.fid!==a.fid)&&Ya(n,a.fid),a})}function $r(n){return g(this,null,function*(){let e,t=yield jn(n.appConfig,i=>{let r=Nh(i),s=Oh(n,r);return e=s.registrationPromise,s.installationEntry});return t.fid===Hr?{installationEntry:yield e}:{installationEntry:t,registrationPromise:e}})}function Nh(n){let e=n||{fid:Ih(),registrationStatus:0};return Ja(e)}function Oh(n,e){if(e.registrationStatus===0){if(!navigator.onLine){let r=Promise.reject(je.create("app-offline"));return{installationEntry:e,registrationPromise:r}}let t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=Rh(n,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:Mh(n)}:{installationEntry:e}}function Rh(n,e){return g(this,null,function*(){try{let t=yield bh(n,e);return Wn(n.appConfig,t)}catch(t){throw Ua(t)&&t.customData.serverCode===409?yield Qa(n.appConfig):yield Wn(n.appConfig,{fid:e.fid,registrationStatus:0}),t}})}function Mh(n){return g(this,null,function*(){let e=yield Ma(n.appConfig);for(;e.registrationStatus===1;)yield Ga(100),e=yield Ma(n.appConfig);if(e.registrationStatus===0){let{installationEntry:t,registrationPromise:i}=yield $r(n);return i||t}return e})}function Ma(n){return jn(n,e=>{if(!e)throw je.create("installation-not-found");return Ja(e)})}function Ja(n){return Dh(n)?{fid:n.fid,registrationStatus:0}:n}function Dh(n){return n.registrationStatus===1&&n.registrationTime+Fa<Date.now()}function Lh(i,r){return g(this,arguments,function*({appConfig:n,heartbeatServiceProvider:e},t){let s=Fh(n,t),o=yh(n,t),a=e.getImmediate({optional:!0});if(a){let u=yield a.getHeartbeatsHeader();u&&o.append("x-firebase-client",u)}let l={installation:{sdkVersion:Ba,appId:n.appId}},c={method:"POST",headers:o,body:JSON.stringify(l)},h=yield $a(()=>fetch(s,c));if(h.ok){let u=yield h.json();return Ha(u)}else throw yield za("Generate Auth Token",h)})}function Fh(n,{fid:e}){return`${ja(n)}/${e}/authTokens:generate`}function Gr(n,e=!1){return g(this,null,function*(){let t,i=yield jn(n.appConfig,s=>{if(!Xa(s))throw je.create("not-registered");let o=s.authToken;if(!e&&Uh(o))return s;if(o.requestStatus===1)return t=Bh(n,e),s;{if(!navigator.onLine)throw je.create("app-offline");let a=Hh(s);return t=Wh(n,a),a}});return t?yield t:i.authToken})}function Bh(n,e){return g(this,null,function*(){let t=yield Da(n.appConfig);for(;t.authToken.requestStatus===1;)yield Ga(100),t=yield Da(n.appConfig);let i=t.authToken;return i.requestStatus===0?Gr(n,e):i})}function Da(n){return jn(n,e=>{if(!Xa(e))throw je.create("not-registered");let t=e.authToken;return zh(t)?U(k({},e),{authToken:{requestStatus:0}}):e})}function Wh(n,e){return g(this,null,function*(){try{let t=yield Lh(n,e),i=U(k({},e),{authToken:t});return yield Wn(n.appConfig,i),t}catch(t){if(Ua(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))yield Qa(n.appConfig);else{let i=U(k({},e),{authToken:{requestStatus:0}});yield Wn(n.appConfig,i)}throw t}})}function Xa(n){return n!==void 0&&n.registrationStatus===2}function Uh(n){return n.requestStatus===2&&!jh(n)}function jh(n){let e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+ph}function Hh(n){let e={requestStatus:1,requestTime:Date.now()};return U(k({},n),{authToken:e})}function zh(n){return n.requestStatus===1&&n.requestTime+Fa<Date.now()}function Vh(n){return g(this,null,function*(){let e=n,{installationEntry:t,registrationPromise:i}=yield $r(e);return i?i.catch(console.error):Gr(e).catch(console.error),t.fid})}function $h(n,e=!1){return g(this,null,function*(){let t=n;return yield Gh(t),(yield Gr(t,e)).token})}function Gh(n){return g(this,null,function*(){let{registrationPromise:e}=yield $r(n);e&&(yield e)})}function qh(n){if(!n||!n.options)throw jr("App Configuration");if(!n.name)throw jr("App Name");let e=["projectId","apiKey","appId"];for(let t of e)if(!n.options[t])throw jr(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function jr(n){return je.create("missing-app-config-values",{valueName:n})}var Za="installations",Yh="installations-internal",Kh=n=>{let e=n.getProvider("app").getImmediate(),t=qh(e),i=Ie(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},Qh=n=>{let e=n.getProvider("app").getImmediate(),t=Ie(e,Za).getImmediate();return{getId:()=>Vh(t),getToken:r=>$h(t,r)}};function Jh(){X(new B(Za,Kh,"PUBLIC")),X(new B(Yh,Qh,"PRIVATE"))}Jh();j(La,zr);j(La,zr,"esm2020");var Hn="analytics",Xh="firebase_id",Zh="origin",ef=60*1e3,tf="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Zr="https://www.googletagmanager.com/gtag/js";var W=new we("@firebase/analytics");var nf={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},G=new de("analytics","Analytics",nf);function rf(n){if(!n.startsWith(Zr)){let e=G.create("invalid-gtag-resource",{gtagURL:n});return W.warn(e.message),""}return n}function ol(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function sf(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function of(n,e){let t=sf("firebase-js-sdk-policy",{createScriptURL:rf}),i=document.createElement("script"),r=`${Zr}?l=${n}&id=${e}`;i.src=t?t?.createScriptURL(r):r,i.async=!0,document.head.appendChild(i)}function af(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}function lf(n,e,t,i,r,s){return g(this,null,function*(){let o=i[r];try{if(o)yield e[o];else{let l=(yield ol(t)).find(c=>c.measurementId===r);l&&(yield e[l.appId])}}catch(a){W.error(a)}n("config",r,s)})}function cf(n,e,t,i,r){return g(this,null,function*(){try{let s=[];if(r&&r.send_to){let o=r.send_to;Array.isArray(o)||(o=[o]);let a=yield ol(t);for(let l of o){let c=a.find(u=>u.measurementId===l),h=c&&e[c.appId];if(h)s.push(h);else{s=[];break}}}s.length===0&&(s=Object.values(e)),yield Promise.all(s),n("event",i,r||{})}catch(s){W.error(s)}})}function df(n,e,t,i){function r(s,...o){return g(this,null,function*(){try{if(s==="event"){let[a,l]=o;yield cf(n,e,t,a,l)}else if(s==="config"){let[a,l]=o;yield lf(n,e,t,i,a,l)}else if(s==="consent"){let[a,l]=o;n("consent",a,l)}else if(s==="get"){let[a,l,c]=o;n("get",a,l,c)}else if(s==="set"){let[a]=o;n("set",a)}else n(s,...o)}catch(a){W.error(a)}})}return r}function uf(n,e,t,i,r){let s=function(...o){window[i].push(arguments)};return window[r]&&typeof window[r]=="function"&&(s=window[r]),window[r]=df(s,n,e,t),{gtagCore:s,wrappedGtag:window[r]}}function hf(n){let e=window.document.getElementsByTagName("script");for(let t of Object.values(e))if(t.src&&t.src.includes(Zr)&&t.src.includes(n))return t;return null}var ff=30,pf=1e3,Yr=class{constructor(e={},t=pf){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}},al=new Yr;function mf(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}function gf(n){return g(this,null,function*(){let{appId:e,apiKey:t}=n,i={method:"GET",headers:mf(t)},r=tf.replace("{app-id}",e),s=yield fetch(r,i);if(s.status!==200&&s.status!==304){let o="";try{let a=yield s.json();a.error?.message&&(o=a.error.message)}catch{}throw G.create("config-fetch-failed",{httpStatus:s.status,responseMessage:o})}return s.json()})}function _f(i){return g(this,arguments,function*(n,e=al,t){let{appId:r,apiKey:s,measurementId:o}=n.options;if(!r)throw G.create("no-app-id");if(!s){if(o)return{measurementId:o,appId:r};throw G.create("no-api-key")}let a=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},l=new Kr;return setTimeout(()=>g(null,null,function*(){l.abort()}),t!==void 0?t:ef),ll({appId:r,apiKey:s,measurementId:o},a,l,e)})}function ll(s,o,a){return g(this,arguments,function*(n,{throttleEndTimeMillis:e,backoffCount:t},i,r=al){let{appId:l,measurementId:c}=n;try{yield yf(i,e)}catch(h){if(c)return W.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${h?.message}]`),{appId:l,measurementId:c};throw h}try{let h=yield gf(n);return r.deleteThrottleMetadata(l),h}catch(h){let u=h;if(!vf(u)){if(r.deleteThrottleMetadata(l),c)return W.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${u?.message}]`),{appId:l,measurementId:c};throw h}let d=Number(u?.customData?.httpStatus)===503?ti(t,r.intervalMillis,ff):ti(t,r.intervalMillis),p={throttleEndTimeMillis:Date.now()+d,backoffCount:t+1};return r.setThrottleMetadata(l,p),W.debug(`Calling attemptFetch again in ${d} millis`),ll(n,p,i,r)}})}function yf(n,e){return new Promise((t,i)=>{let r=Math.max(e-Date.now(),0),s=setTimeout(t,r);n.addEventListener(()=>{clearTimeout(s),i(G.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function vf(n){if(!(n instanceof J)||!n.customData)return!1;let e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}var Kr=class{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}};var Qr;function Cf(n,e,t,i,r){return g(this,null,function*(){if(r&&r.global){n("event",t,i);return}else{let s=yield e,o=U(k({},i),{send_to:s});n("event",t,o)}})}function bf(n,e,t,i){return g(this,null,function*(){if(i&&i.global){let r={};for(let s of Object.keys(t))r[`user_properties.${s}`]=t[s];return n("set",r),Promise.resolve()}else{let r=yield e;n("config",r,{update:!0,user_properties:t})}})}var Jr;function wf(n){Jr=n}function Ef(n){Qr=n}function If(){return g(this,null,function*(){if(nn())try{yield rn()}catch(n){return W.warn(G.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}else return W.warn(G.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0})}function Tf(n,e,t,i,r,s,o){return g(this,null,function*(){let a=_f(n);a.then(d=>{t[d.measurementId]=d.appId,n.options.measurementId&&d.measurementId!==n.options.measurementId&&W.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${d.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(d=>W.error(d)),e.push(a);let l=If().then(d=>{if(d)return i.getId()}),[c,h]=yield Promise.all([a,l]);hf(s)||of(s,c.measurementId),Jr&&(r("consent","default",Jr),wf(void 0)),r("js",new Date);let u=o?.config??{};return u[Zh]="firebase",u.update=!0,h!=null&&(u[Xh]=h),r("config",c.measurementId,u),Qr&&(r("set",Qr),Ef(void 0)),c.measurementId})}var Xr=class{constructor(e){this.app=e}_delete(){return delete ut[this.app.options.appId],Promise.resolve()}},ut={},el=[],tl={},qr="dataLayer",Sf="gtag",nl,es,il=!1;function xf(){let n=[];if(Cs()&&n.push("This is a browser extension environment."),ws()||n.push("Cookies are not available."),n.length>0){let e=n.map((i,r)=>`(${r+1}) ${i}`).join(" "),t=G.create("invalid-analytics-context",{errorInfo:e});W.warn(t.message)}}function kf(n,e,t){xf();let i=n.options.appId;if(!i)throw G.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)W.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw G.create("no-api-key");if(ut[i]!=null)throw G.create("already-exists",{id:i});if(!il){af(qr);let{wrappedGtag:s,gtagCore:o}=uf(ut,el,tl,qr,Sf);es=s,nl=o,il=!0}return ut[i]=Tf(n,el,tl,e,nl,qr,t),new Xr(n)}function cl(n=Ct()){n=ue(n);let e=Ie(n,Hn);return e.isInitialized()?e.getImmediate():Pf(n)}function Pf(n,e={}){let t=Ie(n,Hn);if(t.isInitialized()){let r=t.getImmediate();if(be(e,t.getOptions()))return r;throw G.create("already-initialized")}return t.initialize({options:e})}function Af(n,e,t){n=ue(n),bf(es,ut[n.app.options.appId],e,t).catch(i=>W.error(i))}function Nf(n,e,t,i){n=ue(n),Cf(es,ut[n.app.options.appId],e,t,i).catch(r=>W.error(r))}var rl="@firebase/analytics",sl="0.10.19";function Of(){X(new B(Hn,(e,{options:t})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();return kf(i,r,t)},"PUBLIC")),X(new B("analytics-internal",n,"PRIVATE")),j(rl,sl),j(rl,sl,"esm2020");function n(e){try{let t=e.getProvider(Hn).getImmediate();return{logEvent:(i,r,s)=>Nf(t,i,r,s),setUserProperties:(i,r)=>Af(t,i,r)}}catch(t){throw G.create("interop-component-reg-failed",{reason:t})}}}Of();var Rf={apiKey:"AIzaSyAYVgFEonP6_I087pT0Q4USXkMB1GrpnDc",authDomain:"profile-cd57b.firebaseapp.com",projectId:"profile-cd57b",storageBucket:"profile-cd57b.firebasestorage.app",messagingSenderId:"65056567945",appId:"1:65056567945:web:1565e4167a491b0d46cc58",measurementId:"G-0PRMQQ440W",databaseURL:"https://profile-cd57b-default-rtdb.firebaseio.com/"},dl=mi(Rf),tm=cl(dl),Vt=Ra(dl);var zn=class n{projects=K([]);skills=K([]);contents=K([]);cvUrl=K("");isLoading=K(!0);projectsRef;skillsRef;contentsRef;cvUrlRef;constructor(){this.projectsRef=Ht(Vt,"portfolio/projects"),this.skillsRef=Ht(Vt,"portfolio/skills"),this.contentsRef=Ht(Vt,"portfolio/contents"),this.cvUrlRef=Ht(Vt,"portfolio/cvUrl"),this.subscribeToChanges()}subscribeToChanges(){zt(this.projectsRef,e=>{let t=e.val();this.projects.set(t||[]),this.isLoading.set(!1)},e=>{console.error("Error al cargar proyectos:",e),this.isLoading.set(!1)}),zt(this.skillsRef,e=>{let t=e.val();this.skills.set(t||[])},e=>{console.error("Error al cargar habilidades:",e)}),zt(this.contentsRef,e=>{let t=e.val();this.contents.set(t||[])},e=>{console.error("Error al cargar contenidos:",e)}),zt(this.cvUrlRef,e=>{let t=e.val();this.cvUrl.set(t||"")},e=>{console.error("Error al cargar URL del CV:",e)})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ge({token:n,factory:n.\u0275fac,providedIn:"root"})};var Vn=class n{constructor(e){this.languageService=e}skillTranslations={Angular:{es:"Angular",en:"Angular"},Python:{es:"Python",en:"Python"},FastApi:{es:"FastApi",en:"FastApi"},SQLite:{es:"SQLite",en:"SQLite"},MySQL:{es:"MySQL",en:"MySQL"},"Mongo DB":{es:"Mongo DB",en:"Mongo DB"},Adaptabilidad:{es:"Adaptabilidad",en:"Adaptability"},Liderazgo:{es:"Liderazgo",en:"Leadership"},"Trabajo en equipo":{es:"Trabajo en equipo",en:"Teamwork"},Administraci\u00F3n:{es:"Administraci\xF3n",en:"Administration"}};contentTranslations={Formaci\u00F3n:{es:"Formaci\xF3n",en:"Training"},Experiencia:{es:"Experiencia",en:"Experience"},Referencias:{es:"Referencias",en:"References"},"Ingenier\xEDa de Sistemas":{es:"Ingenier\xEDa de Sistemas",en:"Systems Engineering"},"Ingl\xE9s Intensivo":{es:"Ingl\xE9s Intensivo",en:"Intensive English"},"Angular 11":{es:"Angular 11",en:"Angular 11"},"An\xE1lisis de Desarrollo de Software":{es:"An\xE1lisis de Desarrollo de Software",en:"Software Development Analysis"},"Desarrollador Frontend Freelance":{es:"Desarrollador Frontend Freelance",en:"Frontend Developer Freelance"},"Practicante de An\xE1lisis de Desarrollo de Software":{es:"Practicante de An\xE1lisis de Desarrollo de Software",en:"Software Development Analysis Intern"},"Profesor Universitario":{es:"Profesor Universitario",en:"University Professor"},Comerciante:{es:"Comerciante",en:"Merchant"},"Supervisora de Estacionamiento":{es:"Supervisora de Estacionamiento",en:"Parking Supervisor"},"Asesora Comercial":{es:"Asesora Comercial",en:"Commercial Advisor"},Oficinista:{es:"Oficinista",en:"Office Clerk"},Aplazado:{es:"Aplazado",en:"Postponed"},Finalizado:{es:"Finalizado",en:"Completed"}};translate(e){let t=this.languageService.currentLanguage(),i=e.trim();return this.skillTranslations[i]?this.skillTranslations[i][t]:this.contentTranslations[i]?this.contentTranslations[i][t]:e}translateDate(e){return this.languageService.currentLanguage()==="en"?e.replace(/Aplazado/g,"Postponed").replace(/Finalizado/g,"Completed").replace(/->/g,"->"):e}translateContentTitle(e){let t=this.languageService.currentLanguage();return{Formaci\u00F3n:{es:"Formaci\xF3n",en:"Training"},Experiencia:{es:"Experiencia",en:"Experience"},Referencias:{es:"Referencias",en:"References"}}[e]?.[t]||e}static \u0275fac=function(t){return new(t||n)(ts(Ye))};static \u0275prov=ge({token:n,factory:n.\u0275fac,providedIn:"root"})};var Df=(n,e)=>e.titleButton,Lf=(n,e)=>e.subTitle;function Ff(n,e){if(n&1&&(q(0,"li",9)(1,"div",10)(2,"strong",11),A(3),ce()(),q(4,"div",12)(5,"span",13),A(6),ce(),q(7,"span",14),A(8),ce()()()),n&2){let t=e.$implicit;b(3),D(t.subTitle),b(3),D(t.description),b(2),D(t.date)}}function Bf(n,e){if(n&1&&(q(0,"div",6)(1,"h3",7),A(2),ce(),q(3,"ul",8),ve(4,Ff,9,3,"li",9,Lf),ce()()),n&2){let t=e.$implicit;b(2),D(t.titleButton),b(2),Ce(t.listContent)}}function Wf(n,e){if(n&1){let t=Gt();q(0,"div",1),qt("click",function(r){ze(t);let s=Q();return Ve(s.onBackdropClick(r))}),q(1,"div",2),qt("click",function(r){return ze(t),Ve(r.stopPropagation())}),q(2,"div",3)(3,"h2"),A(4),ce(),q(5,"button",4),qt("click",function(){ze(t);let r=Q();return Ve(r.closeModal())}),q(6,"span"),A(7,"\xD7"),ce()()(),q(8,"div",5),ve(9,Bf,6,1,"div",6,Df),ce()()()}if(n&2){let t=Q();b(4),D(t.title),b(5),Ce(t.contents)}}var $n=class n{isOpen=!1;title="M\xE1s sobre m\xED";contents=[];close=new ss;onBackdropClick(e){e.target===e.currentTarget&&this.closeModal()}closeModal(){this.close.emit(),document.body.style.overflow="auto"}ngOnChanges(e){e.isOpen&&(this.isOpen?document.body.style.overflow="hidden":document.body.style.overflow="auto")}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=$t({type:n,selectors:[["app-modal"]],inputs:{isOpen:"isOpen",title:"title",contents:"contents"},outputs:{close:"close"},features:[rs],decls:1,vars:1,consts:[[1,"modal-backdrop"],[1,"modal-backdrop",3,"click"],[1,"modal-container",3,"click"],[1,"modal-header"],["aria-label","Cerrar modal",1,"modal-close-btn",3,"click"],[1,"modal-content"],[1,"modal-section"],[1,"section-title"],[1,"modal-list"],[1,"modal-item"],[1,"modal-item-header"],[1,"modal-item-title"],[1,"modal-item-body"],[1,"modal-item-institution"],[1,"modal-item-date"]],template:function(t,i){t&1&&_e(0,Wf,11,1,"div",0),t&2&&ye(i.isOpen?0:-1)},dependencies:[Qt],styles:[".modal-backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#000000b3;display:flex;align-items:center;justify-content:center;z-index:1000;animation:_ngcontent-%COMP%_fadeIn .3s ease;padding:1rem;overflow-y:auto}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.modal-container[_ngcontent-%COMP%]{background:var(--bgColor);border-radius:16px;max-width:800px;width:100%;max-height:90vh;display:flex;flex-direction:column;box-shadow:var(--shadowEnd);border:2px solid var(--subtitle);animation:_ngcontent-%COMP%_slideUp .3s ease;overflow:hidden}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(50px);opacity:0}to{transform:translateY(0);opacity:1}}.modal-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1.5rem;border-bottom:2px solid var(--subtitle);background:var(--bgColorHover)}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:var(--title);margin:0}.modal-close-btn[_ngcontent-%COMP%]{background:transparent;border:2px solid var(--subtitle);border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s ease;color:var(--title);font-size:1.5rem;line-height:1}.modal-close-btn[_ngcontent-%COMP%]:hover{background:var(--bgColorActivate);border-color:var(--title);transform:rotate(90deg)}.modal-close-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block}.modal-content[_ngcontent-%COMP%]{padding:1.5rem;overflow-y:auto;flex:1;display:flex;flex-direction:column;gap:2rem}.modal-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.section-title[_ngcontent-%COMP%]{font-size:1.3rem;font-weight:600;color:var(--title);margin:0;padding-bottom:.75rem;border-bottom:2px solid var(--subtitle)}.modal-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:1rem}.modal-item[_ngcontent-%COMP%]{background:var(--bgColorHover);border-radius:12px;padding:1rem;border-left:4px solid var(--subtitle);transition:all .3s ease}.modal-item[_ngcontent-%COMP%]:hover{background:var(--bgColorActivate);transform:translate(5px);box-shadow:var(--shadowStart)}.modal-item-header[_ngcontent-%COMP%]{margin-bottom:.5rem}.modal-item-title[_ngcontent-%COMP%]{color:var(--title);font-size:1.1rem;font-weight:600;display:block}.modal-item-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.modal-item-institution[_ngcontent-%COMP%]{color:var(--subtitle);font-size:.95rem;display:block}.modal-item-date[_ngcontent-%COMP%]{color:var(--text);font-size:.85rem;font-style:italic;display:block}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:var(--bgColor);border-radius:4px}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--subtitle);border-radius:4px}.modal-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:var(--title)}@media (max-width: 768px){.modal-container[_ngcontent-%COMP%]{max-width:95%;max-height:95vh;border-radius:12px}.modal-header[_ngcontent-%COMP%]{padding:1rem}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem}.modal-close-btn[_ngcontent-%COMP%]{width:35px;height:35px;font-size:1.25rem}.modal-content[_ngcontent-%COMP%]{padding:1rem;gap:1.5rem}.section-title[_ngcontent-%COMP%]{font-size:1.1rem}.modal-item[_ngcontent-%COMP%]{padding:.75rem}.modal-item-title[_ngcontent-%COMP%]{font-size:1rem}}@media (max-width: 480px){.modal-backdrop[_ngcontent-%COMP%]{padding:.5rem}.modal-container[_ngcontent-%COMP%]{max-width:100%;max-height:100vh;border-radius:0}.modal-header[_ngcontent-%COMP%]{padding:.75rem}.modal-content[_ngcontent-%COMP%]{padding:.75rem;gap:1rem}}"]})};var Uf=(n,e)=>e.h2,hl=(n,e)=>e.name;function jf(n,e){if(n&1&&(E(0,"a",5),ns(),E(1,"svg",23),Ge(2,"path",24)(3,"polyline",25)(4,"line",26),P(),is(),E(5,"span",27),A(6,"Descargar curriculum"),P()()),n&2){let t=Q();le("href",t.cvUrl(),$e)}}function Hf(n,e){n&1&&(E(0,"div",11),A(1,"Cargando proyectos..."),P())}function zf(n,e){if(n&1){let t=Gt();E(0,"div",29),qe("click",function(){let r=ze(t).$implicit,s=Q(2);return Ve(s.openProject(r.url))}),E(1,"div",30),Ge(2,"img",31),P(),E(3,"div",32)(4,"h3"),A(5),P(),E(6,"p",33),A(7),P(),E(8,"span",34),A(9),P()()()}if(n&2){let t=e.$implicit;b(2),le("src",t.img,$e)("alt",t.name),b(3),D(t.name),b(2),D(t.tool),b(),as("active",t.state.toLowerCase()==="active"||t.state.toLowerCase()==="activo"),b(),ls(" ",t.state," ")}}function Vf(n,e){if(n&1&&ve(0,zf,10,7,"div",28,hl),n&2){let t=Q();Ce(t.projects())}}function $f(n,e){if(n&1&&(E(0,"span",36),A(1),P()),n&2){let t=e.$implicit;b(),D(t)}}function Gf(n,e){if(n&1&&ve(0,$f,2,1,"span",36,os),n&2){let t=Q().$implicit;Ce(t.items)}}function qf(n,e){if(n&1&&Ge(0,"img",38),n&2){let t=Q().$implicit;le("src",t.img,$e)("alt",t.name)}}function Yf(n,e){if(n&1&&(E(0,"div",37),_e(1,qf,1,2,"img",38),E(2,"span"),A(3),P()()),n&2){let t=e.$implicit;b(),ye(t.img?1:-1),b(2),D(t.name)}}function Kf(n,e){if(n&1&&ve(0,Yf,4,2,"div",37,hl),n&2){let t=Q().$implicit;Ce(t.itemsObject)}}function Qf(n,e){if(n&1&&(E(0,"div",19)(1,"h3"),A(2),P(),E(3,"div",35),_e(4,Gf,2,0),_e(5,Kf,2,0),P()()),n&2){let t=e.$implicit;b(2),D(t.h2),b(2),ye(t.items?4:-1),b(),ye(t.itemsObject?5:-1)}}var ul=class n{themeService=ht(Jt);languageService=ht(Ye);portfolioService=ht(zn);translationService=ht(Vn);ngOnInit(){this.themeService.currentTheme()}projects=this.portfolioService.projects;skills=this.portfolioService.skills;allContents=this.portfolioService.contents;cvUrl=this.portfolioService.cvUrl;isLoading=this.portfolioService.isLoading;t=Yt(()=>this.languageService.getTranslations());translatedSkills=Yt(()=>this.skills().map(t=>U(k({},t),{h2:this.getSkillGroupTitle(t.h2),items:t.items?.map(i=>this.translationService.translate(i)),itemsObject:t.itemsObject?.map(i=>U(k({},i),{name:this.translationService.translate(i.name)}))})));translatedContents=Yt(()=>this.allContents().map(t=>U(k({},t),{titleButton:this.translationService.translateContentTitle(t.titleButton),listContent:t.listContent?.map(i=>U(k({},i),{subTitle:this.translationService.translate(i.subTitle),description:this.translationService.translate(i.description),date:this.translationService.translateDate(i.date)}))})));getSkillGroupTitle(e){let t=this.t();return e==="Herramientas"||e==="Tooling"?t.tooling:e==="Habilidades blandas"||e==="Soft Skills"?t.softSkills:e}isModalOpen=!1;fullName="Jhojan Danilo Toro Perez";profileImage="assets/img/MyProfile.png";get currentTheme(){return this.themeService.currentTheme()}get currentWallpaper(){return this.themeService.currentWallpaper()}get currentLanguage(){return this.languageService.currentLanguage()}toggleTheme(){this.themeService.toggleTheme()}toggleLanguage(){this.languageService.toggleLanguage()}openProject(e){e&&window.open(e,"_blank")}openModal(){this.isModalOpen=!0}closeModal(){this.isModalOpen=!1}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=$t({type:n,selectors:[["app-portfolio"]],decls:35,vars:17,consts:[[1,"portfolio-container"],[1,"portfolio-header"],[1,"theme-toggle-btn",3,"click","title"],[1,"theme-icon",3,"src","alt"],[1,"name-section"],["target","_blank","title","Descargar curriculum",1,"cv-download-btn",3,"href"],[1,"full-name"],[1,"portfolio-main"],[1,"portfolio-column","projects-column"],[1,"column-header"],[1,"projects-list"],[1,"loading-message"],[1,"portfolio-column","center-column"],[1,"about-me-btn",3,"click"],[1,"btn-icon"],[1,"profile-image-container"],["alt","Jhojan Danilo Toro Perez","loading","lazy",1,"profile-image",3,"src"],[1,"portfolio-column","skills-column"],[1,"skills-content"],[1,"skill-group"],[3,"close","isOpen","title","contents"],[1,"language-toggle-btn",3,"click","title"],[1,"language-code"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"],["points","7 10 12 15 17 10"],["x1","12","y1","15","x2","12","y2","3"],[1,"cv-tooltip"],[1,"project-card"],[1,"project-card",3,"click"],[1,"project-image"],["loading","lazy",3,"src","alt"],[1,"project-info"],[1,"project-tool"],[1,"project-state"],[1,"skills-list"],[1,"skill-chip"],[1,"skill-item-object"],[1,"skill-icon",3,"src","alt"]],template:function(t,i){t&1&&(E(0,"div",0)(1,"header",1)(2,"button",2),qe("click",function(){return i.toggleTheme()}),Ge(3,"img",3),P(),E(4,"div",4),_e(5,jf,7,1,"a",5),E(6,"h1",6),A(7),P()()(),E(8,"main",7)(9,"section",8)(10,"div",9)(11,"h2"),A(12),P()(),E(13,"div",10),_e(14,Hf,2,0,"div",11)(15,Vf,2,0),P()(),E(16,"section",12)(17,"button",13),qe("click",function(){return i.openModal()}),E(18,"h2"),A(19),P(),E(20,"span",14),A(21,"\u2192"),P()(),E(22,"div",15),Ge(23,"img",16),P()(),E(24,"section",17)(25,"div",9)(26,"h2"),A(27),P()(),E(28,"div",18),ve(29,Qf,6,3,"div",19,Uf),P()()(),E(31,"app-modal",20),qe("close",function(){return i.closeModal()}),P(),E(32,"button",21),qe("click",function(){return i.toggleLanguage()}),E(33,"span",22),A(34),P()()()),t&2&&(b(2),le("title",i.t().changeTheme),qn("aria-label",i.t().changeThemeToLight),b(),le("src",i.currentTheme==="dark"?"assets/img/Cambio_tema/sun.png":"assets/img/Cambio_tema/moon.png",$e)("alt",i.currentTheme==="dark"?i.t().changeThemeToLight:i.t().changeThemeToDark),b(2),ye(i.cvUrl()?5:-1),b(2),D(i.fullName),b(5),D(i.t().projects),b(2),ye(i.isLoading()?14:15),b(5),D(i.t().aboutMe),b(4),le("src",i.profileImage,$e),b(4),D(i.t().hardAndSoftSkills),b(2),Ce(i.translatedSkills()),b(2),le("isOpen",i.isModalOpen)("title",i.t().modalTitle)("contents",i.translatedContents()),b(),le("title",i.currentLanguage==="es"?"EN":"ES"),qn("aria-label",i.currentLanguage==="es"?"Change to English":"Cambiar a Espa\xF1ol"),b(2),D(i.currentLanguage==="es"?"EN":"ES"))},dependencies:[Qt,$n],styles:[".portfolio-container[_ngcontent-%COMP%]{height:100vh;padding:1rem;display:flex;flex-direction:column;gap:1rem;width:100%;max-width:100%;margin:0;overflow:hidden}.portfolio-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;position:relative;padding:1rem 0;width:100%;gap:1rem}.theme-toggle-btn[_ngcontent-%COMP%]{position:absolute;left:0;width:40px;height:40px;border-radius:50%;border:2px solid var(--buttonBorder);background:var(--buttonBg);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s ease;box-shadow:var(--shadowStart)}.theme-toggle-btn[_ngcontent-%COMP%]:hover{background:var(--buttonBgHover);border-color:var(--title);transform:scale(1.1);box-shadow:var(--shadowMid)}.theme-toggle-btn[_ngcontent-%COMP%]:active{transform:scale(.95)}.theme-icon[_ngcontent-%COMP%]{width:20px;height:20px;object-fit:contain}.name-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-left:auto}.full-name[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:700;color:var(--title);text-align:right;margin:0;text-shadow:var(--shadowStart);letter-spacing:2px;font-family:Courier New,Consolas,Monaco,Lucida Console,monospace;text-transform:uppercase}.cv-download-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:45px;height:45px;border-radius:50%;border:2px solid var(--buttonBorder);background:var(--buttonBg);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);color:var(--title);cursor:pointer;transition:all .3s ease;box-shadow:var(--shadowStart);text-decoration:none;position:relative}.cv-download-btn[_ngcontent-%COMP%]:hover{background:var(--buttonBgHover);border-color:var(--title);transform:scale(1.1) translateY(-2px);box-shadow:var(--shadowMid)}.cv-download-btn[_ngcontent-%COMP%]:active{transform:scale(.95)}.cv-download-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;stroke:currentColor}.cv-tooltip[_ngcontent-%COMP%]{position:absolute;bottom:-40px;left:50%;transform:translate(-50%);padding:.5rem .75rem;background:var(--buttonBg);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid var(--buttonBorder);border-radius:6px;color:var(--title);font-size:.85rem;white-space:nowrap;opacity:0;pointer-events:none;transition:opacity .3s ease,transform .3s ease;box-shadow:var(--shadowMid);z-index:1000}.cv-download-btn[_ngcontent-%COMP%]:hover   .cv-tooltip[_ngcontent-%COMP%]{opacity:1;transform:translate(-50%) translateY(-4px)}.portfolio-main[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:stretch;gap:1rem;flex:1;min-height:0;overflow:hidden;width:100%}.portfolio-column[_ngcontent-%COMP%]{background:transparent;border-radius:0;padding:1rem;box-shadow:none;border:none;display:flex;flex-direction:column;gap:1rem;transition:all .3s ease;max-height:100%;min-height:0;overflow:hidden;justify-content:space-between;flex:1;min-width:0}.portfolio-column[_ngcontent-%COMP%]:hover{box-shadow:none;transform:none}.column-header[_ngcontent-%COMP%]{border-bottom:2px solid var(--subtitle);padding-bottom:.5rem;margin-bottom:.75rem}.column-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:600;color:var(--title);margin:0;text-align:center}.projects-column[_ngcontent-%COMP%]{min-height:auto}.loading-message[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:var(--text);font-size:1rem;opacity:.7}.projects-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.6rem;flex:1;min-height:0;overflow-y:auto;justify-content:flex-start}.project-card[_ngcontent-%COMP%]{background:var(--cardBg);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:8px;padding:.6rem;cursor:pointer;transition:all .3s ease;border:1px solid var(--buttonBorder);width:90%;max-width:90%;margin:0 auto}.project-card[_ngcontent-%COMP%]:hover{background:var(--cardBgHover);border-color:var(--title);transform:translate(5px);box-shadow:var(--shadowStart)}.project-image[_ngcontent-%COMP%]{width:100%;height:90px;border-radius:6px;overflow:hidden;margin-bottom:.4rem}.project-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.project-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.95rem;font-weight:600;color:var(--title);margin:0 0 .2rem;line-height:1.3}.project-tool[_ngcontent-%COMP%]{font-size:.85rem;color:var(--subtitle);margin:0 0 .4rem;line-height:1.2}.project-state[_ngcontent-%COMP%]{display:inline-block;padding:.2rem .6rem;border-radius:10px;font-size:.75rem;background:var(--chipBg);-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);color:var(--text);border:1px solid var(--buttonBorder);font-weight:500}.project-state.active[_ngcontent-%COMP%]{background:#4caf50;color:#fff;border-color:#4caf50;box-shadow:0 2px 4px #4caf504d}.center-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;justify-content:space-between}.about-me-btn[_ngcontent-%COMP%]{background:var(--buttonBg);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:8px;padding:1rem;border:2px solid var(--buttonBorder);cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:space-between;width:100%;text-align:left;box-shadow:var(--shadowStart)}.about-me-btn[_ngcontent-%COMP%]:hover{background:var(--buttonBgHover);transform:translateY(-2px);box-shadow:var(--shadowMid);border-color:var(--title)}.about-me-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}.about-me-btn[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:var(--title);margin:0;flex:1}.btn-icon[_ngcontent-%COMP%]{font-size:1.5rem;color:var(--title);transition:transform .3s ease}.about-me-btn[_ngcontent-%COMP%]:hover   .btn-icon[_ngcontent-%COMP%]{transform:translate(5px)}.profile-image-container[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;min-height:0;max-height:100%;background:transparent;border-radius:0;padding:0;border:none;overflow:hidden}.profile-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;width:100%;height:100%;object-fit:contain;border-radius:0;box-shadow:none;transition:none}.profile-image[_ngcontent-%COMP%]:hover{transform:none}.skills-column[_ngcontent-%COMP%]{min-height:auto}.skills-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;flex:1;min-height:0;overflow-y:auto;justify-content:space-between}.skill-group[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:var(--title);margin:0 0 .75rem;text-align:center;border-bottom:1px solid var(--subtitle);padding-bottom:.5rem}.skills-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;justify-content:center}.skill-chip[_ngcontent-%COMP%]{display:inline-block;padding:.4rem .8rem;background:var(--chipBg);-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);color:var(--text);border-radius:16px;font-size:.85rem;border:1px solid var(--buttonBorder);transition:all .3s ease;font-weight:500}.skill-chip[_ngcontent-%COMP%]:hover{background:var(--chipBgHover);border-color:var(--title);transform:translateY(-2px);box-shadow:var(--shadowStart)}.skill-item-object[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.4rem .8rem;background:var(--chipBg);-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);color:var(--text);border-radius:16px;font-size:.85rem;border:1px solid var(--buttonBorder);transition:all .3s ease;font-weight:500}.skill-item-object[_ngcontent-%COMP%]:hover{background:var(--chipBgHover);border-color:var(--title);transform:translateY(-2px);box-shadow:var(--shadowStart)}.skill-item-object[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--text)}.skill-icon[_ngcontent-%COMP%]{width:20px;height:20px;object-fit:contain;flex-shrink:0}@media (max-width: 1024px){.portfolio-container[_ngcontent-%COMP%]{height:100vh;overflow-y:auto;padding:1rem}.portfolio-main[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;min-height:auto;align-items:stretch}.portfolio-column[_ngcontent-%COMP%]{min-height:auto;max-height:none;justify-content:flex-start;flex:1 1 auto}.full-name[_ngcontent-%COMP%]{font-size:1.5rem}.theme-toggle-btn[_ngcontent-%COMP%]{width:45px;height:45px}.projects-list[_ngcontent-%COMP%], .skills-content[_ngcontent-%COMP%]{overflow-y:visible;max-height:none}}@media (max-width: 768px){.portfolio-container[_ngcontent-%COMP%]{padding:.75rem;gap:1rem;height:100vh;overflow-y:auto}.portfolio-header[_ngcontent-%COMP%]{padding:.75rem 0;flex-shrink:0}.portfolio-main[_ngcontent-%COMP%]{min-height:auto}.full-name[_ngcontent-%COMP%]{font-size:1.25rem;padding-left:50px}.theme-toggle-btn[_ngcontent-%COMP%]{width:40px;height:40px;left:.5rem}.theme-icon[_ngcontent-%COMP%]{width:20px;height:20px}.portfolio-column[_ngcontent-%COMP%]{padding:.75rem;border-radius:12px;max-height:none;justify-content:flex-start}.column-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.1rem}.project-image[_ngcontent-%COMP%]{height:100px}.profile-image-container[_ngcontent-%COMP%]{min-height:200px;max-height:300px}.projects-list[_ngcontent-%COMP%], .skills-content[_ngcontent-%COMP%]{overflow-y:visible;max-height:none}}@media (max-width: 480px){.portfolio-container[_ngcontent-%COMP%]{padding:.5rem;gap:.75rem}.portfolio-header[_ngcontent-%COMP%]{padding:.5rem 0}.full-name[_ngcontent-%COMP%]{font-size:1rem;padding-left:45px}.theme-toggle-btn[_ngcontent-%COMP%]{width:35px;height:35px;left:.25rem}.theme-icon[_ngcontent-%COMP%]{width:18px;height:18px}.portfolio-column[_ngcontent-%COMP%]{padding:.75rem;gap:.75rem}.column-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1rem}.about-me-btn[_ngcontent-%COMP%]{padding:.75rem}.about-me-btn[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1rem}.project-image[_ngcontent-%COMP%]{height:80px}.profile-image-container[_ngcontent-%COMP%]{min-height:150px;max-height:250px;padding:.5rem}.skills-list[_ngcontent-%COMP%]{gap:.5rem}.skill-chip[_ngcontent-%COMP%]{font-size:.8rem;padding:.4rem .8rem}}.language-toggle-btn[_ngcontent-%COMP%]{position:fixed;bottom:1.5rem;right:1.5rem;width:50px;height:50px;border-radius:50%;border:2px solid var(--buttonBorder);background:var(--buttonBg);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s ease;box-shadow:var(--shadowMid);z-index:100}.language-toggle-btn[_ngcontent-%COMP%]:hover{background:var(--buttonBgHover);border-color:var(--title);transform:scale(1.1);box-shadow:var(--shadowEnd)}.language-toggle-btn[_ngcontent-%COMP%]:active{transform:scale(.95)}.language-code[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:var(--title);font-family:Courier New,Consolas,Monaco,Lucida Console,monospace;letter-spacing:1px}.projects-list[_ngcontent-%COMP%]::-webkit-scrollbar, .skills-content[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.projects-list[_ngcontent-%COMP%]::-webkit-scrollbar-track, .skills-content[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:var(--bgColor);border-radius:3px}.projects-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .skills-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--subtitle);border-radius:3px}.projects-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .skills-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:var(--title)}@media (max-width: 768px){.language-toggle-btn[_ngcontent-%COMP%]{width:45px;height:45px;bottom:1rem;right:1rem}.language-code[_ngcontent-%COMP%]{font-size:.9rem}}@media (max-width: 480px){.language-toggle-btn[_ngcontent-%COMP%]{width:40px;height:40px;bottom:.75rem;right:.75rem}.language-code[_ngcontent-%COMP%]{font-size:.85rem}}"]})};export{ul as PortfolioComponent};
